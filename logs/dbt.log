2021-03-30 12:20:27.114430 (MainThread): Running with dbt=0.19.0
2021-03-30 12:20:27.802165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 12:20:27.803016 (MainThread): Tracking: tracking
2021-03-30 12:20:27.803299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d37b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079baee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d50310>]}
2021-03-30 12:20:27.823564 (MainThread): Partial parsing not enabled
2021-03-30 12:20:27.824681 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:20:27.827059 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:20:27.856320 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:20:27.858553 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:20:27.860427 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:20:27.864624 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:20:27.875654 (MainThread): Parsing macros/core.sql
2021-03-30 12:20:27.880239 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:20:27.889486 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:20:27.891971 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:20:27.909490 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:20:27.940950 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:20:27.965235 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:20:27.967382 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:20:27.973948 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:20:27.988822 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:20:27.995552 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:20:28.001643 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:20:28.007078 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:20:28.008285 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:20:28.009502 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:20:28.011280 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:20:28.019894 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:20:28.021961 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:20:28.023767 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:20:28.065158 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:20:28.068449 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:20:28.070720 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:20:28.072781 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:20:28.080802 (MainThread): Partial parsing not enabled
2021-03-30 12:20:28.116978 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:20:28.135210 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:20:28.285035 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc5bd187-8f76-48ca-8108-ac6ea252c8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a672eb0>]}
2021-03-30 12:20:28.315660 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:20:28.316557 (MainThread): 
2021-03-30 12:20:28.316938 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:20:28.322108 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dw_dw_stg".
2021-03-30 12:20:28.338034 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dw_dw_stg".
2021-03-30 12:20:28.338194 (ThreadPoolExecutor-0_0): On list_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dw_dw_stg"} */

    show terse objects in dev_dw.dw_stg
2021-03-30 12:20:28.338296 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:20:29.895955 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4064-328d-ff84-0000-9c95001301d6
2021-03-30 12:20:29.896187 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:20:29.896402 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 12:20:29.896536 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:20:29.896749 (ThreadPoolExecutor-0_0): On list_dev_dw_dw_stg: Close
2021-03-30 12:20:30.339036 (MainThread): 14:20:30 | Concurrency: 1 threads (target='dev')
2021-03-30 12:20:30.339289 (MainThread): 14:20:30 | 
2021-03-30 12:20:30.340490 (Thread-1): Began running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:20:30.340876 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:20:30.341043 (Thread-1): Compiling model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:20:30.358120 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_first_dbt_model"
2021-03-30 12:20:30.360164 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.360664 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.361280 (Thread-1): Finished running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:20:30.362115 (Thread-1): Began running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:20:30.362692 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:20:30.362908 (Thread-1): Compiling model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:20:30.371042 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_second_dbt_model"
2021-03-30 12:20:30.371512 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.371792 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.372239 (Thread-1): Finished running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:20:30.373040 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:20:30.373161 (MainThread): Connection 'model.ff_datawarehouse.my_second_dbt_model' was properly closed.
2021-03-30 12:20:30.402073 (MainThread): 14:20:30 | Done.
2021-03-30 12:20:30.402283 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a750af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a410970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6670a0>]}
2021-03-30 12:20:30.402479 (MainThread): Flushing usage events
2021-03-30 12:39:44.775216 (MainThread): Running with dbt=0.19.0
2021-03-30 12:39:45.581618 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 12:39:45.582881 (MainThread): Tracking: tracking
2021-03-30 12:39:45.583152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11369a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111313f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a9340>]}
2021-03-30 12:39:45.603685 (MainThread): Partial parsing not enabled
2021-03-30 12:39:45.604702 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:39:45.606411 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:39:45.608704 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:39:45.639429 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:39:45.641557 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:39:45.643369 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:39:45.647429 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:39:45.658133 (MainThread): Parsing macros/core.sql
2021-03-30 12:39:45.662336 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:39:45.671536 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:39:45.674001 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:39:45.691697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:39:45.723288 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:39:45.743048 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:39:45.744960 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:39:45.751153 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:39:45.764498 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:39:45.771104 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:39:45.777564 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:39:45.782483 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:39:45.783582 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:39:45.784775 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:39:45.786521 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:39:45.795102 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:39:45.797120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:39:45.798915 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:39:45.839096 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:39:45.841078 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:39:45.842751 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:39:45.844636 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:39:45.852099 (MainThread): Partial parsing not enabled
2021-03-30 12:39:45.886772 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:39:45.905283 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:39:46.026068 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4988466-5a08-4252-b6eb-1604c2bba350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb7a30>]}
2021-03-30 12:39:46.048359 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:39:46.049052 (MainThread): 
2021-03-30 12:39:46.049613 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:39:46.051931 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg".
2021-03-30 12:39:46.063551 (ThreadPoolExecutor-0_0): Using snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg".
2021-03-30 12:39:46.063638 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg"} */

    show terse objects in {'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw.dw_stg
2021-03-30 12:39:46.063712 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:39:47.264507 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4077-32e6-ce8c-0000-9c950012e1de
2021-03-30 12:39:47.264726 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 22 unexpected '{'.
2021-03-30 12:39:47.264933 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 12:39:47.265063 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:39:47.265274 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg: Close
2021-03-30 12:39:47.409614 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:39:47.409792 (MainThread): Connection 'list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg' was properly closed.
2021-03-30 12:39:47.409994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e305b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fad6d0>]}
2021-03-30 12:39:47.410255 (MainThread): Flushing usage events
2021-03-30 12:39:48.029354 (MainThread): Encountered an error:
2021-03-30 12:39:48.029588 (MainThread): Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 22 unexpected '{'.
2021-03-30 12:39:48.042489 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 22 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 370, in before_run
    self.populate_adapter_cache(adapter)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 363, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 386, in set_relations_cache
    self._relations_cache_for_schemas(manifest)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 363, in _relations_cache_for_schemas
    for relation in future.result():
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 130, in list_relations_without_caching
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 22 unexpected '{'.

2021-03-30 12:41:10.738515 (MainThread): Running with dbt=0.19.0
2021-03-30 12:41:11.427142 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 12:41:11.428412 (MainThread): Tracking: tracking
2021-03-30 12:41:11.428884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a860430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a871130>]}
2021-03-30 12:41:11.452070 (MainThread): Partial parsing not enabled
2021-03-30 12:41:11.452746 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:41:11.454408 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:41:11.456480 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:41:11.486681 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:41:11.489129 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:41:11.490979 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:41:11.495304 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:41:11.506036 (MainThread): Parsing macros/core.sql
2021-03-30 12:41:11.510273 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:41:11.519336 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:41:11.521784 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:41:11.539345 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:41:11.571133 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:41:11.591829 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:41:11.594044 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:41:11.600314 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:41:11.614126 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:41:11.620855 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:41:11.627018 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:41:11.631855 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:41:11.632928 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:41:11.634143 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:41:11.635890 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:41:11.644373 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:41:11.646400 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:41:11.648131 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:41:11.692185 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:41:11.694844 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:41:11.696552 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:41:11.698371 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:41:11.705593 (MainThread): Partial parsing not enabled
2021-03-30 12:41:11.740856 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:41:11.762027 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:41:11.889091 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6028d4ac-4dac-4cce-98fa-ee4b67f93cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab77a90>]}
2021-03-30 12:41:11.912980 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:41:11.913912 (MainThread): 
2021-03-30 12:41:11.914350 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:41:11.917500 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list__dev_dw_dw_stg".
2021-03-30 12:41:11.928774 (ThreadPoolExecutor-0_0): Using snowflake connection "list__dev_dw_dw_stg".
2021-03-30 12:41:11.928879 (ThreadPoolExecutor-0_0): On list__dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list__dev_dw_dw_stg"} */

    show terse objects in _dev_dw.dw_stg
2021-03-30 12:41:11.928962 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:41:13.775303 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4079-329e-9eb7-0000-9c950012e1e2
2021-03-30 12:41:13.775520 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:41:13.775722 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 12:41:13.775848 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:41:13.776051 (ThreadPoolExecutor-0_0): On list__dev_dw_dw_stg: Close
2021-03-30 12:41:14.444381 (MainThread): 14:41:14 | Concurrency: 1 threads (target='dev')
2021-03-30 12:41:14.444605 (MainThread): 14:41:14 | 
2021-03-30 12:41:14.445881 (Thread-1): Began running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:41:14.446280 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:41:14.446453 (Thread-1): Compiling model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:41:14.463128 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_first_dbt_model"
2021-03-30 12:41:14.464477 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.464908 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.465452 (Thread-1): Finished running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:41:14.466068 (Thread-1): Began running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:41:14.466554 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:41:14.466706 (Thread-1): Compiling model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:41:14.475182 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_second_dbt_model"
2021-03-30 12:41:14.475721 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.476002 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.476465 (Thread-1): Finished running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:41:14.477264 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:41:14.477376 (MainThread): Connection 'model.ff_datawarehouse.my_second_dbt_model' was properly closed.
2021-03-30 12:41:14.509047 (MainThread): 14:41:14 | Done.
2021-03-30 12:41:14.509254 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a849a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87a8b0>]}
2021-03-30 12:41:14.509457 (MainThread): Flushing usage events
2021-03-30 12:42:01.554720 (MainThread): Running with dbt=0.19.0
2021-03-30 12:42:01.989764 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 12:42:01.990533 (MainThread): Tracking: tracking
2021-03-30 12:42:01.990803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec80040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162f460>]}
2021-03-30 12:42:02.009939 (MainThread): Partial parsing not enabled
2021-03-30 12:42:02.010581 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:42:02.012273 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:42:02.014365 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:42:02.045186 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:42:02.047477 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:42:02.049185 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:42:02.053224 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:42:02.063140 (MainThread): Parsing macros/core.sql
2021-03-30 12:42:02.067041 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:42:02.075775 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:42:02.077744 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:42:02.095263 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:42:02.128274 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:42:02.153763 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:42:02.156308 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:42:02.163305 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:42:02.177146 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:42:02.184596 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:42:02.190769 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:42:02.195958 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:42:02.197449 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:42:02.198675 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:42:02.200481 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:42:02.209247 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:42:02.211643 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:42:02.213545 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:42:02.254815 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:42:02.256803 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:42:02.258448 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:42:02.260317 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:42:02.267579 (MainThread): Partial parsing not enabled
2021-03-30 12:42:02.303785 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:42:02.320711 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:42:02.438893 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd298189c-e8be-46b5-89a9-e4300b0db488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111936820>]}
2021-03-30 12:42:02.460739 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:42:02.461413 (MainThread): 
2021-03-30 12:42:02.461917 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:42:02.464053 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list__dev_dw".
2021-03-30 12:42:02.475374 (ThreadPoolExecutor-0_0): Using snowflake connection "list__dev_dw".
2021-03-30 12:42:02.475454 (ThreadPoolExecutor-0_0): On list__dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list__dev_dw"} */

    show terse schemas in database _dev_dw
    limit 10000
2021-03-30 12:42:02.475524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:42:04.408262 (ThreadPoolExecutor-0_0): Snowflake query id: 019b407a-3236-db29-0000-9c950013200e
2021-03-30 12:42:04.408479 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:42:04.408694 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 12:42:04.408827 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:42:04.409044 (ThreadPoolExecutor-0_0): On list__dev_dw: Close
2021-03-30 12:42:04.567634 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:42:04.567810 (MainThread): Connection 'list__dev_dw' was properly closed.
2021-03-30 12:42:04.568006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111686d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11167e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11184f460>]}
2021-03-30 12:42:04.568246 (MainThread): Flushing usage events
2021-03-30 12:42:05.086469 (MainThread): Encountered an error:
2021-03-30 12:42:05.086720 (MainThread): Runtime Error
  Database error while listing schemas in database "_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 12:42:05.099838 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 12:42:56.000609 (MainThread): Running with dbt=0.19.0
2021-03-30 12:42:56.419396 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 12:42:56.420191 (MainThread): Tracking: tracking
2021-03-30 12:42:56.420526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081219a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081353a0>]}
2021-03-30 12:42:56.439608 (MainThread): Partial parsing not enabled
2021-03-30 12:42:56.440261 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:42:56.441746 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:42:56.443686 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:42:56.471575 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:42:56.473501 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:42:56.474977 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:42:56.478732 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:42:56.488415 (MainThread): Parsing macros/core.sql
2021-03-30 12:42:56.492071 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:42:56.500438 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:42:56.502086 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:42:56.519037 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:42:56.550014 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:42:56.569640 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:42:56.571332 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:42:56.577055 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:42:56.590140 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:42:56.596474 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:42:56.602288 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:42:56.606879 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:42:56.607748 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:42:56.608719 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:42:56.610210 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:42:56.618428 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:42:56.620234 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:42:56.621779 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:42:56.662517 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:42:56.664235 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:42:56.665628 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:42:56.667228 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:42:56.674312 (MainThread): Partial parsing not enabled
2021-03-30 12:42:56.708563 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:42:56.724638 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:42:56.841885 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d022d2-833f-4f87-833a-5d2e4b00611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a76580>]}
2021-03-30 12:42:56.867761 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:42:56.868402 (MainThread): 
2021-03-30 12:42:56.868694 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:42:56.870929 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dw".
2021-03-30 12:42:56.882470 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dw".
2021-03-30 12:42:56.882555 (ThreadPoolExecutor-0_0): On list_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dw"} */

    show terse schemas in database dev_dw
    limit 10000
2021-03-30 12:42:56.882628 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:42:57.949809 (ThreadPoolExecutor-0_0): Snowflake query id: 019b407a-322e-6332-0000-9c95001301e2
2021-03-30 12:42:57.950732 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:42:57.951190 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 12:42:57.951423 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:42:57.951703 (ThreadPoolExecutor-0_0): On list_dev_dw: Close
2021-03-30 12:42:58.095900 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:42:58.096081 (MainThread): Connection 'list_dev_dw' was properly closed.
2021-03-30 12:42:58.096282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a76be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6c4f0>]}
2021-03-30 12:42:58.096524 (MainThread): Flushing usage events
2021-03-30 12:42:58.692758 (MainThread): Encountered an error:
2021-03-30 12:42:58.692999 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 12:42:58.701935 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:40:19.461203 (MainThread): Running with dbt=0.19.0
2021-03-30 13:40:20.296684 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:40:20.298378 (MainThread): Tracking: tracking
2021-03-30 13:40:20.298786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ae430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105428f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077be1c0>]}
2021-03-30 13:40:20.322191 (MainThread): Partial parsing not enabled
2021-03-30 13:40:20.323209 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:40:20.325547 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:40:20.327641 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:40:20.358266 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:40:20.360424 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:40:20.362145 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:40:20.366076 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:40:20.378050 (MainThread): Parsing macros/core.sql
2021-03-30 13:40:20.383011 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:40:20.392743 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:40:20.395244 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:40:20.412250 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:40:20.443363 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:40:20.462686 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:40:20.464728 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:40:20.470547 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:40:20.483822 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:40:20.490211 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:40:20.496568 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:40:20.501373 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:40:20.502393 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:40:20.503548 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:40:20.505253 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:40:20.514071 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:40:20.516045 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:40:20.517807 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:40:20.562221 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:40:20.564428 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:40:20.566375 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:40:20.568806 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:40:20.576953 (MainThread): Partial parsing not enabled
2021-03-30 13:40:20.612224 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:40:20.630112 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:40:20.750063 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a258a9-c474-4467-a5c4-3af25593a3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f6100>]}
2021-03-30 13:40:20.773369 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:40:20.773993 (MainThread): 
2021-03-30 13:40:20.774353 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:40:20.776695 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw".
2021-03-30 13:40:20.788777 (ThreadPoolExecutor-0_0): Using snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw".
2021-03-30 13:40:20.788868 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw"} */

    show terse schemas in database {'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw
    limit 10000
2021-03-30 13:40:20.788943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:40:22.173978 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b4-32f0-5079-0000-9c95001260b2
2021-03-30 13:40:22.174194 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:40:22.174403 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:40:22.174530 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:40:22.174735 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw: Close
2021-03-30 13:40:22.372458 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:40:22.372635 (MainThread): Connection 'list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw' was properly closed.
2021-03-30 13:40:22.372840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e820>]}
2021-03-30 13:40:22.373080 (MainThread): Flushing usage events
2021-03-30 13:40:22.920878 (MainThread): Encountered an error:
2021-03-30 13:40:22.921109 (MainThread): Runtime Error
  Database error while listing schemas in database "{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:40:22.933504 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.

2021-03-30 13:40:54.613368 (MainThread): Running with dbt=0.19.0
2021-03-30 13:40:55.060720 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 13:40:55.061336 (MainThread): Tracking: tracking
2021-03-30 13:40:55.061654 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e7a430>]}
2021-03-30 13:40:55.080839 (MainThread): Partial parsing not enabled
2021-03-30 13:40:55.081474 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:40:55.082974 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:40:55.084865 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:40:55.112135 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:40:55.114105 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:40:55.115462 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:40:55.119120 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:40:55.128603 (MainThread): Parsing macros/core.sql
2021-03-30 13:40:55.132138 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:40:55.140611 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:40:55.142213 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:40:55.159430 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:40:55.189779 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:40:55.209432 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:40:55.211128 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:40:55.217284 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:40:55.230361 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:40:55.236852 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:40:55.242633 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:40:55.247340 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:40:55.248206 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:40:55.249178 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:40:55.250663 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:40:55.258886 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:40:55.260684 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:40:55.262216 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:40:55.304670 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:40:55.306394 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:40:55.307806 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:40:55.309457 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:40:55.316490 (MainThread): Partial parsing not enabled
2021-03-30 13:40:55.351117 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:40:55.367839 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:40:55.483141 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd533c74-39cb-4e57-a851-e0e881ec2ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113180580>]}
2021-03-30 13:40:55.507281 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:40:55.508009 (MainThread): 
2021-03-30 13:40:55.508495 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:40:55.510696 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_target_dev_dw_dw_stg".
2021-03-30 13:40:55.521735 (ThreadPoolExecutor-0_0): Using snowflake connection "list_target_dev_dw_dw_stg".
2021-03-30 13:40:55.521824 (ThreadPoolExecutor-0_0): On list_target_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_target_dev_dw_dw_stg"} */

    show terse objects in target_dev_dw.dw_stg
2021-03-30 13:40:55.521900 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:40:56.501343 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b4-325f-6c77-0000-9c950013020e
2021-03-30 13:40:56.501572 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:40:56.501790 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 13:40:56.501932 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:40:56.502149 (ThreadPoolExecutor-0_0): On list_target_dev_dw_dw_stg: Close
2021-03-30 13:40:56.666273 (MainThread): 15:40:56 | Concurrency: 1 threads (target='dev')
2021-03-30 13:40:56.666497 (MainThread): 15:40:56 | 
2021-03-30 13:40:56.667679 (Thread-1): Began running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 13:40:56.668071 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:40:56.668234 (Thread-1): Compiling model.ff_datawarehouse.my_first_dbt_model
2021-03-30 13:40:56.685270 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_first_dbt_model"
2021-03-30 13:40:56.685737 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.686034 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.686477 (Thread-1): Finished running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 13:40:56.686934 (Thread-1): Began running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 13:40:56.687225 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:40:56.687347 (Thread-1): Compiling model.ff_datawarehouse.my_second_dbt_model
2021-03-30 13:40:56.695128 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_second_dbt_model"
2021-03-30 13:40:56.695574 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.695843 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.696261 (Thread-1): Finished running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 13:40:56.697141 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:40:56.697258 (MainThread): Connection 'model.ff_datawarehouse.my_second_dbt_model' was properly closed.
2021-03-30 13:40:56.725357 (MainThread): 15:40:56 | Done.
2021-03-30 13:40:56.725560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131764f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ffdd30>]}
2021-03-30 13:40:56.725747 (MainThread): Flushing usage events
2021-03-30 13:42:08.353205 (MainThread): Running with dbt=0.19.0
2021-03-30 13:42:09.036434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:42:09.037693 (MainThread): Tracking: tracking
2021-03-30 13:42:09.037988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f52beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b42e0>]}
2021-03-30 13:42:09.057529 (MainThread): Partial parsing not enabled
2021-03-30 13:42:09.058215 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:42:09.059812 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:42:09.061964 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:42:09.089851 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:42:09.091960 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:42:09.093777 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:42:09.097888 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:42:09.107997 (MainThread): Parsing macros/core.sql
2021-03-30 13:42:09.112325 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:42:09.121334 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:42:09.123729 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:42:09.140671 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:42:09.172704 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:42:09.193437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:42:09.195423 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:42:09.201393 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:42:09.214815 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:42:09.222039 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:42:09.228117 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:42:09.232966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:42:09.234037 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:42:09.235244 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:42:09.237136 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:42:09.245586 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:42:09.247896 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:42:09.249689 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:42:09.294251 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:42:09.296225 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:42:09.297974 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:42:09.299794 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:42:09.307100 (MainThread): Partial parsing not enabled
2021-03-30 13:42:09.342454 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:42:09.360251 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:42:09.484239 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f260be-3ba0-44cb-8c6e-aa4e581195d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8100>]}
2021-03-30 13:42:09.507055 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:42:09.507947 (MainThread): 
2021-03-30 13:42:09.508371 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:42:09.511344 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_target_dev_dw".
2021-03-30 13:42:09.524429 (ThreadPoolExecutor-0_0): Using snowflake connection "list_target_dev_dw".
2021-03-30 13:42:09.524595 (ThreadPoolExecutor-0_0): On list_target_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_target_dev_dw"} */

    show terse schemas in database target_dev_dw
    limit 10000
2021-03-30 13:42:09.524744 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:42:10.631523 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b6-32a4-ab42-0000-9c950012f1e2
2021-03-30 13:42:10.631746 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:42:10.631954 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:42:10.632086 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:42:10.632295 (ThreadPoolExecutor-0_0): On list_target_dev_dw: Close
2021-03-30 13:42:10.781149 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:42:10.781332 (MainThread): Connection 'list_target_dev_dw' was properly closed.
2021-03-30 13:42:10.781536 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120715e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ed4f0>]}
2021-03-30 13:42:10.781777 (MainThread): Flushing usage events
2021-03-30 13:42:11.332754 (MainThread): Encountered an error:
2021-03-30 13:42:11.332989 (MainThread): Runtime Error
  Database error while listing schemas in database "target_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 13:42:11.345523 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "target_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:42:44.837986 (MainThread): Running with dbt=0.19.0
2021-03-30 13:42:45.434760 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:42:45.435890 (MainThread): Tracking: tracking
2021-03-30 13:42:45.436169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c564430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1eaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57f1c0>]}
2021-03-30 13:42:45.456326 (MainThread): Partial parsing not enabled
2021-03-30 13:42:45.457287 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:42:45.459066 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:42:45.461177 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:42:45.489592 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:42:45.491697 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:42:45.493288 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:42:45.497431 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:42:45.508863 (MainThread): Parsing macros/core.sql
2021-03-30 13:42:45.512824 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:42:45.521908 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:42:45.523913 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:42:45.541772 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:42:45.574239 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:42:45.597993 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:42:45.599965 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:42:45.606210 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:42:45.624397 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:42:45.635035 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:42:45.642039 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:42:45.647095 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:42:45.648213 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:42:45.649480 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:42:45.651198 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:42:45.659883 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:42:45.662810 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:42:45.664594 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:42:45.706570 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:42:45.709776 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:42:45.712554 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:42:45.715211 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:42:45.724456 (MainThread): Partial parsing not enabled
2021-03-30 13:42:45.760060 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:42:45.778477 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:42:45.902641 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c8921b0-fc5e-4356-832c-03dfae31fe92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb6100>]}
2021-03-30 13:42:45.927420 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:42:45.928101 (MainThread): 
2021-03-30 13:42:45.928678 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:42:45.930872 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_{target}_dev_dw".
2021-03-30 13:42:45.942557 (ThreadPoolExecutor-0_0): Using snowflake connection "list_{target}_dev_dw".
2021-03-30 13:42:45.942649 (ThreadPoolExecutor-0_0): On list_{target}_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_{target}_dev_dw"} */

    show terse schemas in database {target}_dev_dw
    limit 10000
2021-03-30 13:42:45.942724 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:42:47.297042 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b6-326b-6885-0000-9c950012e21a
2021-03-30 13:42:47.297279 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:42:47.297495 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:42:47.297631 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:42:47.297853 (ThreadPoolExecutor-0_0): On list_{target}_dev_dw: Close
2021-03-30 13:42:47.711856 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:42:47.712043 (MainThread): Connection 'list_{target}_dev_dw' was properly closed.
2021-03-30 13:42:47.712256 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc05e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd4dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdce340>]}
2021-03-30 13:42:47.712519 (MainThread): Flushing usage events
2021-03-30 13:42:48.308666 (MainThread): Encountered an error:
2021-03-30 13:42:48.308906 (MainThread): Runtime Error
  Database error while listing schemas in database "{target}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:42:48.318468 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "{target}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.

2021-03-30 13:45:05.781310 (MainThread): Running with dbt=0.19.0
2021-03-30 13:45:06.200683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:45:06.201307 (MainThread): Tracking: tracking
2021-03-30 13:45:06.201596 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107855e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106189040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786f220>]}
2021-03-30 13:45:06.219740 (MainThread): Partial parsing not enabled
2021-03-30 13:45:06.220385 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:45:06.222150 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:45:06.224224 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:45:06.251019 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:45:06.252936 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:45:06.254257 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:45:06.257842 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:45:06.267635 (MainThread): Parsing macros/core.sql
2021-03-30 13:45:06.271197 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:45:06.279449 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:45:06.281097 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:45:06.297721 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:45:06.328097 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:45:06.348015 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:45:06.349711 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:45:06.355423 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:45:06.368393 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:45:06.374960 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:45:06.380863 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:45:06.385456 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:45:06.386499 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:45:06.387475 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:45:06.388974 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:45:06.400005 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:45:06.402033 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:45:06.403681 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:45:06.444845 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:45:06.446649 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:45:06.448104 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:45:06.449723 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:45:06.456894 (MainThread): Partial parsing not enabled
2021-03-30 13:45:06.491900 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:45:06.508855 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:45:06.626220 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d5abaa5-f9f9-4d35-be95-c2a08d0ee452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b76550>]}
2021-03-30 13:45:06.647504 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:45:06.648213 (MainThread): 
2021-03-30 13:45:06.648720 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:45:06.650863 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dev_dw".
2021-03-30 13:45:06.662741 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dev_dw".
2021-03-30 13:45:06.662861 (ThreadPoolExecutor-0_0): On list_dev_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dev_dw"} */

    show terse schemas in database dev_dev_dw
    limit 10000
2021-03-30 13:45:06.662943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:45:08.783350 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b9-32dd-5e38-0000-9c950012f1e6
2021-03-30 13:45:08.784262 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:45:08.784724 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:45:08.784955 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:45:08.785239 (ThreadPoolExecutor-0_0): On list_dev_dev_dw: Close
2021-03-30 13:45:09.435753 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:45:09.435938 (MainThread): Connection 'list_dev_dev_dw' was properly closed.
2021-03-30 13:45:09.436142 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b767f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6b4f0>]}
2021-03-30 13:45:09.436375 (MainThread): Flushing usage events
2021-03-30 13:45:10.048568 (MainThread): Encountered an error:
2021-03-30 13:45:10.048809 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 13:45:10.058619 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:45:50.701825 (MainThread): Running with dbt=0.19.0
2021-03-30 13:45:51.150941 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:45:51.152098 (MainThread): Tracking: tracking
2021-03-30 13:45:51.152357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e338970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e34c370>]}
2021-03-30 13:45:51.171767 (MainThread): Partial parsing not enabled
2021-03-30 13:45:51.172400 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:45:51.173874 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:45:51.175718 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:45:51.202219 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:45:51.204072 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:45:51.205396 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:45:51.208954 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:45:51.219756 (MainThread): Parsing macros/core.sql
2021-03-30 13:45:51.224312 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:45:51.232771 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:45:51.234417 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:45:51.250639 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:45:51.281573 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:45:51.301497 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:45:51.303247 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:45:51.309112 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:45:51.322436 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:45:51.328900 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:45:51.334880 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:45:51.339614 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:45:51.340509 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:45:51.341518 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:45:51.343060 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:45:51.351514 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:45:51.353375 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:45:51.354957 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:45:51.394457 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:45:51.396146 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:45:51.398023 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:45:51.399595 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:45:51.406509 (MainThread): Partial parsing not enabled
2021-03-30 13:45:51.440126 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:45:51.456613 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:45:51.567859 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67188ab0-5e19-4f29-9704-7c86119f9f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec77b50>]}
2021-03-30 13:45:51.589192 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:45:51.589996 (MainThread): 
2021-03-30 13:45:51.590548 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:45:51.592761 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dw".
2021-03-30 13:45:51.604403 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dw".
2021-03-30 13:45:51.604491 (ThreadPoolExecutor-0_0): On list_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dw"} */

    show terse schemas in database dev_dw
    limit 10000
2021-03-30 13:45:51.604569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:45:52.812914 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b9-3291-c0cb-0000-9c950012f1ea
2021-03-30 13:45:52.813147 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:45:52.813365 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:45:52.813518 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:45:52.813739 (ThreadPoolExecutor-0_0): On list_dev_dw: Close
2021-03-30 13:45:53.005916 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:45:53.006086 (MainThread): Connection 'list_dev_dw' was properly closed.
2021-03-30 13:45:53.006272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec77dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec6d4f0>]}
2021-03-30 13:45:53.006504 (MainThread): Flushing usage events
2021-03-30 13:45:53.528819 (MainThread): Encountered an error:
2021-03-30 13:45:53.529051 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 13:45:53.538460 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:55:56.278373 (MainThread): Running with dbt=0.19.0
2021-03-30 13:55:56.972635 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:55:56.974063 (MainThread): Tracking: tracking
2021-03-30 13:55:56.974458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11493dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11495e640>]}
2021-03-30 13:55:56.997427 (MainThread): Partial parsing not enabled
2021-03-30 13:55:56.998438 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:55:57.000150 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:55:57.002305 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:55:57.030044 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:55:57.032196 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:55:57.033781 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:55:57.037726 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:55:57.047709 (MainThread): Parsing macros/core.sql
2021-03-30 13:55:57.051723 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:55:57.060785 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:55:57.063211 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:55:57.080622 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:55:57.111703 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:55:57.131744 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:55:57.133697 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:55:57.139766 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:55:57.153470 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:55:57.160041 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:55:57.166256 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:55:57.171070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:55:57.172175 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:55:57.173343 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:55:57.175007 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:55:57.186489 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:55:57.188769 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:55:57.190656 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:55:57.231565 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:55:57.233556 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:55:57.235248 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:55:57.237104 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:55:57.244546 (MainThread): Partial parsing not enabled
2021-03-30 13:55:57.279076 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:55:57.300620 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:55:57.422956 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c94100a-29f5-4bda-b00d-8154a9047b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11527b5b0>]}
2021-03-30 13:55:57.444866 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:55:57.445458 (MainThread): 
2021-03-30 13:55:57.445984 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:55:57.448128 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JM_develop_dev_dw".
2021-03-30 13:55:57.459401 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JM_develop_dev_dw".
2021-03-30 13:55:57.459490 (ThreadPoolExecutor-0_0): On list_JM_develop_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_JM_develop_dev_dw"} */

    show terse schemas in database JM_develop_dev_dw
    limit 10000
2021-03-30 13:55:57.459563 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:55:58.829695 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.37 seconds
2021-03-30 13:55:58.834699 (ThreadPoolExecutor-0_0): On list_JM_develop_dev_dw: Close
2021-03-30 13:55:59.295795 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:55:59.296134 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:55:59.296335 (ThreadPoolExecutor-0_0): Creating schema "JM_develop_dev_dw.dw_stg"
2021-03-30 13:55:59.302532 (ThreadPoolExecutor-0_0): Using snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:55:59.302677 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: BEGIN
2021-03-30 13:55:59.302788 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-03-30 13:56:00.624287 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.32 seconds
2021-03-30 13:56:00.624458 (ThreadPoolExecutor-0_0): Using snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:56:00.624552 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "create_JM_develop_dev_dw_dw_stg"} */
create schema if not exists JM_develop_dev_dw.dw_stg
2021-03-30 13:56:00.917671 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40c4-32c5-765e-0000-9c9500123652
2021-03-30 13:56:00.917887 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-03-30 13:56:00.918094 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-03-30 13:56:00.918240 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:56:00.918393 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: ROLLBACK
2021-03-30 13:56:01.234443 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: Close
2021-03-30 13:56:01.840207 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:56:01.840394 (MainThread): Connection 'create_JM_develop_dev_dw_dw_stg' was properly closed.
2021-03-30 13:56:01.840602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150f67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11527b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150fa0d0>]}
2021-03-30 13:56:01.840849 (MainThread): Flushing usage events
2021-03-30 13:56:02.469809 (MainThread): Encountered an error:
2021-03-30 13:56:02.470051 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-03-30 13:56:02.482657 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 538, in create_schemas
    create_future.result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 500, in create_schema
    adapter.create_schema(relation)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-03-30 14:29:29.662522 (MainThread): Running with dbt=0.19.0
2021-03-30 14:29:30.425087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 14:29:30.426301 (MainThread): Tracking: tracking
2021-03-30 14:29:30.426625 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11452a580>]}
2021-03-30 14:29:30.450200 (MainThread): Partial parsing not enabled
2021-03-30 14:29:30.451495 (MainThread): Parsing macros/catalog.sql
2021-03-30 14:29:30.454255 (MainThread): Parsing macros/adapters.sql
2021-03-30 14:29:30.486531 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 14:29:30.488947 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 14:29:30.490806 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 14:29:30.495432 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 14:29:30.508232 (MainThread): Parsing macros/core.sql
2021-03-30 14:29:30.513524 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 14:29:30.524469 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 14:29:30.527282 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 14:29:30.548559 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 14:29:30.585490 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 14:29:30.612780 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 14:29:30.616827 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 14:29:30.625391 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 14:29:30.641339 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 14:29:30.649239 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 14:29:30.656675 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 14:29:30.662588 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 14:29:30.663886 (MainThread): Parsing macros/etc/query.sql
2021-03-30 14:29:30.665303 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 14:29:30.667248 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 14:29:30.677232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 14:29:30.679447 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 14:29:30.681239 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 14:29:30.730445 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 14:29:30.734532 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 14:29:30.737628 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 14:29:30.740640 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 14:29:30.750113 (MainThread): Partial parsing not enabled
2021-03-30 14:29:30.787078 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 14:29:30.806354 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 14:29:30.929569 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d224e7f-c588-49b1-9b7e-d1f8c88223c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163b4e80>]}
2021-03-30 14:29:30.953577 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 14:29:30.954280 (MainThread): 
2021-03-30 14:29:30.954721 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 14:29:30.957016 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JM_develop_DEV_DW".
2021-03-30 14:29:30.968563 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JM_develop_DEV_DW".
2021-03-30 14:29:30.968653 (ThreadPoolExecutor-0_0): On list_JM_develop_DEV_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_JM_develop_DEV_DW"} */

    show terse schemas in database JM_develop_DEV_DW
    limit 10000
2021-03-30 14:29:30.968729 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 14:29:32.692136 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40e5-328f-bd2e-0000-9c9500130222
2021-03-30 14:29:32.692287 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 14:29:32.692430 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 14:29:32.692519 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 14:29:32.692663 (ThreadPoolExecutor-0_0): On list_JM_develop_DEV_DW: Close
2021-03-30 14:29:33.186705 (MainThread): Connection 'master' was properly closed.
2021-03-30 14:29:33.186889 (MainThread): Connection 'list_JM_develop_DEV_DW' was properly closed.
2021-03-30 14:29:33.187095 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163b4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114589910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116238d00>]}
2021-03-30 14:29:33.187341 (MainThread): Flushing usage events
2021-03-30 14:29:33.814937 (MainThread): Encountered an error:
2021-03-30 14:29:33.815170 (MainThread): Runtime Error
  Database error while listing schemas in database "JM_develop_DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 14:29:33.828431 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "JM_develop_DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:22:33.422415 (MainThread): Running with dbt=0.19.0
2021-03-31 08:22:34.216433 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:22:34.217958 (MainThread): Tracking: tracking
2021-03-31 08:22:34.218259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f61cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5329d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63a5b0>]}
2021-03-31 08:22:34.237912 (MainThread): Partial parsing not enabled
2021-03-31 08:22:34.238874 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:22:34.240536 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:22:34.242589 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:22:34.271171 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:22:34.273255 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:22:34.274987 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:22:34.278900 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:22:34.290178 (MainThread): Parsing macros/core.sql
2021-03-31 08:22:34.294603 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:22:34.303645 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:22:34.306376 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:22:34.324211 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:22:34.355727 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:22:34.375905 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:22:34.377775 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:22:34.384069 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:22:34.397636 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:22:34.404427 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:22:34.410554 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:22:34.416514 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:22:34.417595 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:22:34.418835 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:22:34.420621 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:22:34.429132 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:22:34.431209 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:22:34.432937 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:22:34.472860 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:22:34.475266 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:22:34.476919 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:22:34.478619 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:22:34.486627 (MainThread): Partial parsing not enabled
2021-03-31 08:22:34.520809 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:22:34.541581 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-31 08:22:34.660250 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c847608d-c5ea-4844-90c8-e495307f793f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93c5b0>]}
2021-03-31 08:22:34.683529 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 08:22:34.684304 (MainThread): 
2021-03-31 08:22:34.684698 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 08:22:34.686944 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:22:34.698680 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:22:34.698771 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_JM__DEV_DW"} */

    show terse schemas in database dev_JM__DEV_DW
    limit 10000
2021-03-31 08:22:34.698849 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 08:22:36.241390 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4516-3200-7cca-0000-9c950013a00a
2021-03-31 08:22:36.241621 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-31 08:22:36.241837 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 08:22:36.241971 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 08:22:36.242184 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: Close
2021-03-31 08:22:36.382392 (MainThread): Connection 'master' was properly closed.
2021-03-31 08:22:36.382573 (MainThread): Connection 'list_dev_JM__DEV_DW' was properly closed.
2021-03-31 08:22:36.382775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f931e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f931fa0>]}
2021-03-31 08:22:36.383018 (MainThread): Flushing usage events
2021-03-31 08:22:36.998743 (MainThread): Encountered an error:
2021-03-31 08:22:36.998975 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-31 08:22:37.011747 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:54:12.127089 (MainThread): Running with dbt=0.19.0
2021-03-31 08:54:12.957328 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:54:12.959293 (MainThread): Tracking: tracking
2021-03-31 08:54:12.959644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6daf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7a550>]}
2021-03-31 08:54:12.980792 (MainThread): Partial parsing not enabled
2021-03-31 08:54:12.982030 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:54:12.983755 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:54:12.985813 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:54:13.013193 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:54:13.015333 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:54:13.017023 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:54:13.021080 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:54:13.031823 (MainThread): Parsing macros/core.sql
2021-03-31 08:54:13.036381 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:54:13.045402 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:54:13.047829 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:54:13.064796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:54:13.095479 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:54:13.115967 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:54:13.117873 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:54:13.123897 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:54:13.137113 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:54:13.143978 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:54:13.150838 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:54:13.156843 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:54:13.158479 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:54:13.159940 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:54:13.162230 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:54:13.172184 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:54:13.174211 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:54:13.176004 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:54:13.216244 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:54:13.218181 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:54:13.219789 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:54:13.221623 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:54:13.228787 (MainThread): Partial parsing not enabled
2021-03-31 08:54:13.264120 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:54:13.282141 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-31 08:54:13.400070 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d28cb11-5fe6-49c6-9ef7-f661958a4128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bd5e0>]}
2021-03-31 08:54:13.422002 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 08:54:13.422657 (MainThread): 
2021-03-31 08:54:13.423158 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 08:54:13.425324 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:54:13.436573 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:54:13.436661 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_JM__DEV_DW"} */

    show terse schemas in database dev_JM__DEV_DW
    limit 10000
2021-03-31 08:54:13.436736 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 08:54:14.526552 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4536-3200-7cd1-0000-9c950013c00a
2021-03-31 08:54:14.526782 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-31 08:54:14.526995 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 08:54:14.527133 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 08:54:14.527352 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: Close
2021-03-31 08:54:14.691763 (MainThread): Connection 'master' was properly closed.
2021-03-31 08:54:14.691944 (MainThread): Connection 'list_dev_JM__DEV_DW' was properly closed.
2021-03-31 08:54:14.692150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111237760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b36a0>]}
2021-03-31 08:54:14.692398 (MainThread): Flushing usage events
2021-03-31 08:54:15.350419 (MainThread): Encountered an error:
2021-03-31 08:54:15.350654 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-31 08:54:15.366303 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:54:37.245595 (MainThread): Running with dbt=0.19.0
2021-03-31 08:54:37.643646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:54:37.644322 (MainThread): Tracking: tracking
2021-03-31 08:54:37.644609 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cef940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10396eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d033a0>]}
2021-03-31 08:54:37.664324 (MainThread): Partial parsing not enabled
2021-03-31 08:54:37.664998 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:54:37.666604 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:54:37.668529 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:54:37.698953 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:54:37.701574 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:54:37.703135 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:54:37.707376 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:54:37.722119 (MainThread): Parsing macros/core.sql
2021-03-31 08:54:37.726754 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:54:37.741646 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:54:37.743897 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:54:37.766930 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:54:37.807596 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:54:37.833389 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:54:37.835677 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:54:37.842528 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:54:37.856359 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:54:37.863300 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:54:37.869680 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:54:37.875178 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:54:37.876279 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:54:37.877516 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:54:37.879458 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:54:37.888159 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:54:37.890267 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:54:37.892109 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:54:37.933994 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:54:37.936245 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:54:37.938079 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:54:37.939927 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:54:37.947299 (MainThread): Partial parsing not enabled
2021-03-31 08:54:37.981839 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:54:37.999699 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-31 08:54:38.116826 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f6fe6b-4cfd-4e87-829d-933880d38cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066385e0>]}
2021-03-31 08:54:38.138573 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 08:54:38.139354 (MainThread): 
2021-03-31 08:54:38.139705 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 08:54:38.142140 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_DW".
2021-03-31 08:54:38.154258 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_DW".
2021-03-31 08:54:38.154374 (ThreadPoolExecutor-0_0): On list_dev_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_DW"} */

    show terse schemas in database dev_DW
    limit 10000
2021-03-31 08:54:38.154456 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 08:54:39.228990 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4536-3200-7cae-0000-9c950013e006
2021-03-31 08:54:39.229216 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-31 08:54:39.229428 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 08:54:39.229565 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 08:54:39.229781 (ThreadPoolExecutor-0_0): On list_dev_DW: Close
2021-03-31 08:54:39.375513 (MainThread): Connection 'master' was properly closed.
2021-03-31 08:54:39.375695 (MainThread): Connection 'list_dev_DW' was properly closed.
2021-03-31 08:54:39.375898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d52d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d424f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b0d00>]}
2021-03-31 08:54:39.376141 (MainThread): Flushing usage events
2021-03-31 08:54:39.921842 (MainThread): Encountered an error:
2021-03-31 08:54:39.922074 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-31 08:54:39.932335 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:55:45.898174 (MainThread): Running with dbt=0.19.0
2021-03-31 08:55:46.333763 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:55:46.334332 (MainThread): Tracking: tracking
2021-03-31 08:55:46.334592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114112c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114140280>]}
2021-03-31 08:55:46.353777 (MainThread): Partial parsing not enabled
2021-03-31 08:55:46.354425 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:55:46.356044 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:55:46.357952 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:55:46.385965 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:55:46.387890 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:55:46.389277 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:55:46.392996 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:55:46.402708 (MainThread): Parsing macros/core.sql
2021-03-31 08:55:46.406351 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:55:46.414648 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:55:46.416301 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:55:46.433300 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:55:46.464010 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:55:46.483471 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:55:46.485171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:55:46.490873 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:55:46.503841 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:55:46.510148 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:55:46.515946 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:55:46.520515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:55:46.521430 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:55:46.522406 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:55:46.523903 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:55:46.532516 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:55:46.534327 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:55:46.535873 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:55:46.576074 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:55:46.577891 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:55:46.579314 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:55:46.580905 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:55:46.588027 (MainThread): Partial parsing not enabled
2021-03-31 08:55:46.622256 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:55:46.633365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11417dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148f03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148fe040>]}
2021-03-31 08:55:46.633541 (MainThread): Flushing usage events
2021-03-31 08:55:47.363471 (MainThread): Connection 'model.ff_datawarehouse.my_first_dbt_model' was properly closed.
2021-03-31 08:55:47.363706 (MainThread): Encountered an error:
2021-03-31 08:55:47.363896 (MainThread): Compilation Error in macro generate_database_name (macros/get_custom_database.sql)
  'get_user' is undefined
2021-03-31 08:55:47.369528 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'get_user' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 373, in render_update
    self.update_parsed_node(node, config)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 329, in update_parsed_node
    self.update_parsed_node_name(parsed_node, config_dict)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 305, in update_parsed_node_name
    self._update_node_database(parsed_node, config_dict)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 132, in __call__
    new_value = self.updater(override, parsed_node)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro generate_database_name (macros/get_custom_database.sql)
  'get_user' is undefined

2021-04-16 14:39:47.988885 (MainThread): Running with dbt=0.19.1
2021-04-16 14:39:48.363703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-16 14:39:48.371449 (MainThread): Tracking: tracking
2021-04-16 14:39:48.371674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdedb334e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded670e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded67102b0>]}
2021-04-16 14:39:48.372049 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-16 14:39:48.377947 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-16 14:39:48.378113 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-16 14:39:48.387229 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-16 14:39:48.392270 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-16 14:39:48.395485 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-16 14:39:48.398566 (Thread-1): Parsing macros/adapters.sql
2021-04-16 14:39:48.427185 (Thread-1): Parsing macros/catalog.sql
2021-04-16 14:39:48.429279 (Thread-1): Parsing macros/materializations/table.sql
2021-04-16 14:39:48.433162 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-16 14:39:48.435221 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-16 14:39:48.444378 (Thread-1): Parsing macros/materializations/view.sql
2021-04-16 14:39:48.446672 (Thread-1): Parsing macros/core.sql
2021-04-16 14:39:48.450573 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-16 14:39:48.459498 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-16 14:39:48.473693 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-16 14:39:48.475609 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-16 14:39:48.494593 (Thread-2): handling status request
2021-04-16 14:39:48.494984 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded6653250>]}
2021-04-16 14:39:48.495167 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-16 14:39:48.495881 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.37.128
2021-04-16 14:39:48.529345 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-16 14:39:48.534917 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-16 14:39:48.541377 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-16 14:39:48.562665 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-16 14:39:48.569683 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-16 14:39:48.571786 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-16 14:39:48.578055 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-16 14:39:48.579902 (Thread-1): Parsing macros/etc/query.sql
2021-04-16 14:39:48.581134 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-16 14:39:48.590332 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-16 14:39:48.591492 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-16 14:39:48.593364 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-16 14:39:48.595627 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-16 14:39:48.597371 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-16 14:39:48.600321 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-16 14:39:48.602485 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-16 14:39:48.604497 (Thread-1): Parsing macros/adapters/common.sql
2021-04-16 14:39:48.687566 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-16 14:40:47.051064 (Thread-3): handling status request
2021-04-16 14:40:47.051380 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4544910>]}
2021-04-16 14:40:47.052227 (Thread-3): sending response (<Response 9340 bytes [200 OK]>) to 10.0.2.151
2021-04-16 14:40:47.132789 (Thread-4): handling ps request
2021-04-16 14:40:47.133068 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4572a60>]}
2021-04-16 14:40:47.133549 (Thread-4): sending response (<Response 105 bytes [200 OK]>) to 10.0.44.212
2021-04-16 14:41:26.802513 (Thread-5): handling status request
2021-04-16 14:41:26.804467 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded45726d0>]}
2021-04-16 14:41:26.805238 (Thread-5): sending response (<Response 9340 bytes [200 OK]>) to 10.0.37.128
2021-04-16 14:41:27.235817 (Thread-6): handling compile_sql request
2021-04-16 14:41:27.236101 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4569ac0>]}
2021-04-16 14:41:27.236543 (Thread-6): sending response (<Response 605 bytes [200 OK]>) to 10.0.26.37
2021-04-16 14:47:58.139624 (Thread-7): handling ps request
2021-04-16 14:47:58.139968 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded457cac0>]}
2021-04-16 14:47:58.140477 (Thread-7): sending response (<Response 105 bytes [200 OK]>) to 10.0.37.187
2021-04-16 14:47:58.141621 (Thread-8): handling status request
2021-04-16 14:47:58.141832 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded452af10>]}
2021-04-16 14:47:58.142541 (Thread-8): sending response (<Response 9340 bytes [200 OK]>) to 10.0.9.82
2021-04-16 14:49:17.813017 (MainThread): Connection 'model.folkefinans_dw.dwd_loan_account' was properly closed.
2021-04-16 14:49:17.834186 (Thread-9): Parsing macros/get_custom_database.sql
2021-04-16 14:49:17.838363 (Thread-9): Parsing macros/generate_schema_name.sql
2021-04-16 14:49:17.841771 (Thread-9): Parsing macros/parse_credit_rules.sql
2021-04-16 14:49:17.844817 (Thread-9): Parsing macros/adapters.sql
2021-04-16 14:49:17.873387 (Thread-9): Parsing macros/catalog.sql
2021-04-16 14:49:17.875551 (Thread-9): Parsing macros/materializations/table.sql
2021-04-16 14:49:17.879592 (Thread-9): Parsing macros/materializations/merge.sql
2021-04-16 14:49:17.881705 (Thread-9): Parsing macros/materializations/incremental.sql
2021-04-16 14:49:17.891043 (Thread-9): Parsing macros/materializations/view.sql
2021-04-16 14:49:17.893413 (Thread-9): Parsing macros/core.sql
2021-04-16 14:49:17.897644 (Thread-9): Parsing macros/materializations/helpers.sql
2021-04-16 14:49:17.907231 (Thread-9): Parsing macros/materializations/common/merge.sql
2021-04-16 14:49:17.924848 (Thread-9): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-16 14:49:17.928300 (Thread-9): Parsing macros/materializations/snapshot/strategies.sql
2021-04-16 14:49:17.948945 (Thread-9): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-16 14:49:17.984484 (Thread-9): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-16 14:49:17.993624 (Thread-9): Parsing macros/materializations/view/view.sql
2021-04-16 14:49:18.004226 (Thread-9): Parsing macros/materializations/seed/seed.sql
2021-04-16 14:49:18.043069 (Thread-9): Parsing macros/materializations/table/table.sql
2021-04-16 14:49:18.055369 (Thread-9): Parsing macros/materializations/incremental/helpers.sql
2021-04-16 14:49:18.059041 (Thread-9): Parsing macros/materializations/incremental/incremental.sql
2021-04-16 14:49:18.067514 (Thread-9): Parsing macros/etc/is_incremental.sql
2021-04-16 14:49:18.070700 (Thread-9): Parsing macros/etc/query.sql
2021-04-16 14:49:18.072872 (Thread-9): Parsing macros/etc/datetime.sql
2021-04-16 14:49:18.089525 (Thread-9): Parsing macros/etc/get_custom_alias.sql
2021-04-16 14:49:18.095083 (Thread-9): Parsing macros/etc/get_custom_database.sql
2021-04-16 14:49:18.097655 (Thread-9): Parsing macros/etc/get_custom_schema.sql
2021-04-16 14:49:18.099750 (Thread-9): Parsing macros/schema_tests/not_null.sql
2021-04-16 14:49:18.101450 (Thread-9): Parsing macros/schema_tests/accepted_values.sql
2021-04-16 14:49:18.104570 (Thread-9): Parsing macros/schema_tests/relationships.sql
2021-04-16 14:49:18.106774 (Thread-9): Parsing macros/schema_tests/unique.sql
2021-04-16 14:49:18.108663 (Thread-9): Parsing macros/adapters/common.sql
2021-04-16 14:49:18.194120 (Thread-9): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-16 14:49:18.208990 (Thread-9): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-16 14:49:18.216461 (Thread-9): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-16 14:49:18.235838 (Thread-10): handling status request
2021-04-16 14:49:18.236127 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded43e8880>]}
2021-04-16 14:49:18.236818 (Thread-10): sending response (<Response 185 bytes [200 OK]>) to 10.0.9.82
2021-04-16 14:49:18.423293 (Thread-9): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded420a6d0>]}
2021-04-16 14:49:19.628629 (Thread-11): handling status request
2021-04-16 14:49:19.628913 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded43f8d00>]}
2021-04-16 14:49:19.629704 (Thread-11): sending response (<Response 10258 bytes [200 OK]>) to 10.0.17.76
2021-04-16 14:49:39.035619 (Thread-12): handling status request
2021-04-16 14:49:39.035957 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded670e310>]}
2021-04-16 14:49:39.036796 (Thread-12): sending response (<Response 10258 bytes [200 OK]>) to 10.0.27.72

2021-03-30 12:20:27.114430 (MainThread): Running with dbt=0.19.0
2021-03-30 12:20:27.802165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 12:20:27.803016 (MainThread): Tracking: tracking
2021-03-30 12:20:27.803299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d37b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079baee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d50310>]}
2021-03-30 12:20:27.823564 (MainThread): Partial parsing not enabled
2021-03-30 12:20:27.824681 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:20:27.827059 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:20:27.856320 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:20:27.858553 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:20:27.860427 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:20:27.864624 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:20:27.875654 (MainThread): Parsing macros/core.sql
2021-03-30 12:20:27.880239 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:20:27.889486 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:20:27.891971 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:20:27.909490 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:20:27.940950 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:20:27.965235 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:20:27.967382 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:20:27.973948 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:20:27.988822 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:20:27.995552 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:20:28.001643 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:20:28.007078 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:20:28.008285 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:20:28.009502 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:20:28.011280 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:20:28.019894 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:20:28.021961 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:20:28.023767 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:20:28.065158 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:20:28.068449 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:20:28.070720 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:20:28.072781 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:20:28.080802 (MainThread): Partial parsing not enabled
2021-03-30 12:20:28.116978 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:20:28.135210 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:20:28.285035 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc5bd187-8f76-48ca-8108-ac6ea252c8be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a672eb0>]}
2021-03-30 12:20:28.315660 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:20:28.316557 (MainThread): 
2021-03-30 12:20:28.316938 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:20:28.322108 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dw_dw_stg".
2021-03-30 12:20:28.338034 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dw_dw_stg".
2021-03-30 12:20:28.338194 (ThreadPoolExecutor-0_0): On list_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dw_dw_stg"} */

    show terse objects in dev_dw.dw_stg
2021-03-30 12:20:28.338296 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:20:29.895955 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4064-328d-ff84-0000-9c95001301d6
2021-03-30 12:20:29.896187 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:20:29.896402 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 12:20:29.896536 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:20:29.896749 (ThreadPoolExecutor-0_0): On list_dev_dw_dw_stg: Close
2021-03-30 12:20:30.339036 (MainThread): 14:20:30 | Concurrency: 1 threads (target='dev')
2021-03-30 12:20:30.339289 (MainThread): 14:20:30 | 
2021-03-30 12:20:30.340490 (Thread-1): Began running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:20:30.340876 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:20:30.341043 (Thread-1): Compiling model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:20:30.358120 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_first_dbt_model"
2021-03-30 12:20:30.360164 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.360664 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.361280 (Thread-1): Finished running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:20:30.362115 (Thread-1): Began running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:20:30.362692 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:20:30.362908 (Thread-1): Compiling model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:20:30.371042 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_second_dbt_model"
2021-03-30 12:20:30.371512 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.371792 (Thread-1): finished collecting timing info
2021-03-30 12:20:30.372239 (Thread-1): Finished running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:20:30.373040 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:20:30.373161 (MainThread): Connection 'model.ff_datawarehouse.my_second_dbt_model' was properly closed.
2021-03-30 12:20:30.402073 (MainThread): 14:20:30 | Done.
2021-03-30 12:20:30.402283 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a750af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a410970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6670a0>]}
2021-03-30 12:20:30.402479 (MainThread): Flushing usage events
2021-03-30 12:39:44.775216 (MainThread): Running with dbt=0.19.0
2021-03-30 12:39:45.581618 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 12:39:45.582881 (MainThread): Tracking: tracking
2021-03-30 12:39:45.583152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11369a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111313f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a9340>]}
2021-03-30 12:39:45.603685 (MainThread): Partial parsing not enabled
2021-03-30 12:39:45.604702 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:39:45.606411 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:39:45.608704 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:39:45.639429 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:39:45.641557 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:39:45.643369 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:39:45.647429 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:39:45.658133 (MainThread): Parsing macros/core.sql
2021-03-30 12:39:45.662336 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:39:45.671536 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:39:45.674001 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:39:45.691697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:39:45.723288 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:39:45.743048 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:39:45.744960 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:39:45.751153 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:39:45.764498 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:39:45.771104 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:39:45.777564 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:39:45.782483 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:39:45.783582 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:39:45.784775 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:39:45.786521 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:39:45.795102 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:39:45.797120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:39:45.798915 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:39:45.839096 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:39:45.841078 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:39:45.842751 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:39:45.844636 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:39:45.852099 (MainThread): Partial parsing not enabled
2021-03-30 12:39:45.886772 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:39:45.905283 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:39:46.026068 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4988466-5a08-4252-b6eb-1604c2bba350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb7a30>]}
2021-03-30 12:39:46.048359 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:39:46.049052 (MainThread): 
2021-03-30 12:39:46.049613 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:39:46.051931 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg".
2021-03-30 12:39:46.063551 (ThreadPoolExecutor-0_0): Using snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg".
2021-03-30 12:39:46.063638 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg"} */

    show terse objects in {'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw.dw_stg
2021-03-30 12:39:46.063712 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:39:47.264507 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4077-32e6-ce8c-0000-9c950012e1de
2021-03-30 12:39:47.264726 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 22 unexpected '{'.
2021-03-30 12:39:47.264933 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 12:39:47.265063 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:39:47.265274 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg: Close
2021-03-30 12:39:47.409614 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:39:47.409792 (MainThread): Connection 'list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw_dw_stg' was properly closed.
2021-03-30 12:39:47.409994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e305b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fad6d0>]}
2021-03-30 12:39:47.410255 (MainThread): Flushing usage events
2021-03-30 12:39:48.029354 (MainThread): Encountered an error:
2021-03-30 12:39:48.029588 (MainThread): Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 22 unexpected '{'.
2021-03-30 12:39:48.042489 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 22 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 370, in before_run
    self.populate_adapter_cache(adapter)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 363, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 386, in set_relations_cache
    self._relations_cache_for_schemas(manifest)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 363, in _relations_cache_for_schemas
    for relation in future.result():
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 130, in list_relations_without_caching
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 22 unexpected '{'.

2021-03-30 12:41:10.738515 (MainThread): Running with dbt=0.19.0
2021-03-30 12:41:11.427142 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 12:41:11.428412 (MainThread): Tracking: tracking
2021-03-30 12:41:11.428884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a860430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a871130>]}
2021-03-30 12:41:11.452070 (MainThread): Partial parsing not enabled
2021-03-30 12:41:11.452746 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:41:11.454408 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:41:11.456480 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:41:11.486681 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:41:11.489129 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:41:11.490979 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:41:11.495304 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:41:11.506036 (MainThread): Parsing macros/core.sql
2021-03-30 12:41:11.510273 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:41:11.519336 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:41:11.521784 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:41:11.539345 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:41:11.571133 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:41:11.591829 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:41:11.594044 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:41:11.600314 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:41:11.614126 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:41:11.620855 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:41:11.627018 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:41:11.631855 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:41:11.632928 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:41:11.634143 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:41:11.635890 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:41:11.644373 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:41:11.646400 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:41:11.648131 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:41:11.692185 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:41:11.694844 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:41:11.696552 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:41:11.698371 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:41:11.705593 (MainThread): Partial parsing not enabled
2021-03-30 12:41:11.740856 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:41:11.762027 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:41:11.889091 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6028d4ac-4dac-4cce-98fa-ee4b67f93cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab77a90>]}
2021-03-30 12:41:11.912980 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:41:11.913912 (MainThread): 
2021-03-30 12:41:11.914350 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:41:11.917500 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list__dev_dw_dw_stg".
2021-03-30 12:41:11.928774 (ThreadPoolExecutor-0_0): Using snowflake connection "list__dev_dw_dw_stg".
2021-03-30 12:41:11.928879 (ThreadPoolExecutor-0_0): On list__dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list__dev_dw_dw_stg"} */

    show terse objects in _dev_dw.dw_stg
2021-03-30 12:41:11.928962 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:41:13.775303 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4079-329e-9eb7-0000-9c950012e1e2
2021-03-30 12:41:13.775520 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:41:13.775722 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 12:41:13.775848 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:41:13.776051 (ThreadPoolExecutor-0_0): On list__dev_dw_dw_stg: Close
2021-03-30 12:41:14.444381 (MainThread): 14:41:14 | Concurrency: 1 threads (target='dev')
2021-03-30 12:41:14.444605 (MainThread): 14:41:14 | 
2021-03-30 12:41:14.445881 (Thread-1): Began running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:41:14.446280 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:41:14.446453 (Thread-1): Compiling model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:41:14.463128 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_first_dbt_model"
2021-03-30 12:41:14.464477 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.464908 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.465452 (Thread-1): Finished running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 12:41:14.466068 (Thread-1): Began running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:41:14.466554 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:41:14.466706 (Thread-1): Compiling model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:41:14.475182 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_second_dbt_model"
2021-03-30 12:41:14.475721 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.476002 (Thread-1): finished collecting timing info
2021-03-30 12:41:14.476465 (Thread-1): Finished running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 12:41:14.477264 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:41:14.477376 (MainThread): Connection 'model.ff_datawarehouse.my_second_dbt_model' was properly closed.
2021-03-30 12:41:14.509047 (MainThread): 14:41:14 | Done.
2021-03-30 12:41:14.509254 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a849a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87a8b0>]}
2021-03-30 12:41:14.509457 (MainThread): Flushing usage events
2021-03-30 12:42:01.554720 (MainThread): Running with dbt=0.19.0
2021-03-30 12:42:01.989764 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 12:42:01.990533 (MainThread): Tracking: tracking
2021-03-30 12:42:01.990803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec80040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162f460>]}
2021-03-30 12:42:02.009939 (MainThread): Partial parsing not enabled
2021-03-30 12:42:02.010581 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:42:02.012273 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:42:02.014365 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:42:02.045186 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:42:02.047477 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:42:02.049185 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:42:02.053224 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:42:02.063140 (MainThread): Parsing macros/core.sql
2021-03-30 12:42:02.067041 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:42:02.075775 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:42:02.077744 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:42:02.095263 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:42:02.128274 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:42:02.153763 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:42:02.156308 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:42:02.163305 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:42:02.177146 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:42:02.184596 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:42:02.190769 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:42:02.195958 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:42:02.197449 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:42:02.198675 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:42:02.200481 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:42:02.209247 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:42:02.211643 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:42:02.213545 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:42:02.254815 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:42:02.256803 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:42:02.258448 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:42:02.260317 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:42:02.267579 (MainThread): Partial parsing not enabled
2021-03-30 12:42:02.303785 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:42:02.320711 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:42:02.438893 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd298189c-e8be-46b5-89a9-e4300b0db488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111936820>]}
2021-03-30 12:42:02.460739 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:42:02.461413 (MainThread): 
2021-03-30 12:42:02.461917 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:42:02.464053 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list__dev_dw".
2021-03-30 12:42:02.475374 (ThreadPoolExecutor-0_0): Using snowflake connection "list__dev_dw".
2021-03-30 12:42:02.475454 (ThreadPoolExecutor-0_0): On list__dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list__dev_dw"} */

    show terse schemas in database _dev_dw
    limit 10000
2021-03-30 12:42:02.475524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:42:04.408262 (ThreadPoolExecutor-0_0): Snowflake query id: 019b407a-3236-db29-0000-9c950013200e
2021-03-30 12:42:04.408479 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:42:04.408694 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 12:42:04.408827 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:42:04.409044 (ThreadPoolExecutor-0_0): On list__dev_dw: Close
2021-03-30 12:42:04.567634 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:42:04.567810 (MainThread): Connection 'list__dev_dw' was properly closed.
2021-03-30 12:42:04.568006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111686d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11167e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11184f460>]}
2021-03-30 12:42:04.568246 (MainThread): Flushing usage events
2021-03-30 12:42:05.086469 (MainThread): Encountered an error:
2021-03-30 12:42:05.086720 (MainThread): Runtime Error
  Database error while listing schemas in database "_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 12:42:05.099838 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 12:42:56.000609 (MainThread): Running with dbt=0.19.0
2021-03-30 12:42:56.419396 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 12:42:56.420191 (MainThread): Tracking: tracking
2021-03-30 12:42:56.420526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081219a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081353a0>]}
2021-03-30 12:42:56.439608 (MainThread): Partial parsing not enabled
2021-03-30 12:42:56.440261 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 12:42:56.441746 (MainThread): Parsing macros/catalog.sql
2021-03-30 12:42:56.443686 (MainThread): Parsing macros/adapters.sql
2021-03-30 12:42:56.471575 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 12:42:56.473501 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 12:42:56.474977 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 12:42:56.478732 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 12:42:56.488415 (MainThread): Parsing macros/core.sql
2021-03-30 12:42:56.492071 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 12:42:56.500438 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 12:42:56.502086 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 12:42:56.519037 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 12:42:56.550014 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 12:42:56.569640 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 12:42:56.571332 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 12:42:56.577055 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 12:42:56.590140 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 12:42:56.596474 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 12:42:56.602288 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 12:42:56.606879 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 12:42:56.607748 (MainThread): Parsing macros/etc/query.sql
2021-03-30 12:42:56.608719 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 12:42:56.610210 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 12:42:56.618428 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 12:42:56.620234 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 12:42:56.621779 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 12:42:56.662517 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 12:42:56.664235 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 12:42:56.665628 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 12:42:56.667228 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 12:42:56.674312 (MainThread): Partial parsing not enabled
2021-03-30 12:42:56.708563 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 12:42:56.724638 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 12:42:56.841885 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d022d2-833f-4f87-833a-5d2e4b00611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a76580>]}
2021-03-30 12:42:56.867761 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 12:42:56.868402 (MainThread): 
2021-03-30 12:42:56.868694 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 12:42:56.870929 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dw".
2021-03-30 12:42:56.882470 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dw".
2021-03-30 12:42:56.882555 (ThreadPoolExecutor-0_0): On list_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dw"} */

    show terse schemas in database dev_dw
    limit 10000
2021-03-30 12:42:56.882628 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 12:42:57.949809 (ThreadPoolExecutor-0_0): Snowflake query id: 019b407a-322e-6332-0000-9c95001301e2
2021-03-30 12:42:57.950732 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 12:42:57.951190 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 12:42:57.951423 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 12:42:57.951703 (ThreadPoolExecutor-0_0): On list_dev_dw: Close
2021-03-30 12:42:58.095900 (MainThread): Connection 'master' was properly closed.
2021-03-30 12:42:58.096081 (MainThread): Connection 'list_dev_dw' was properly closed.
2021-03-30 12:42:58.096282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a76be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6c4f0>]}
2021-03-30 12:42:58.096524 (MainThread): Flushing usage events
2021-03-30 12:42:58.692758 (MainThread): Encountered an error:
2021-03-30 12:42:58.692999 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 12:42:58.701935 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:40:19.461203 (MainThread): Running with dbt=0.19.0
2021-03-30 13:40:20.296684 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:40:20.298378 (MainThread): Tracking: tracking
2021-03-30 13:40:20.298786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ae430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105428f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077be1c0>]}
2021-03-30 13:40:20.322191 (MainThread): Partial parsing not enabled
2021-03-30 13:40:20.323209 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:40:20.325547 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:40:20.327641 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:40:20.358266 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:40:20.360424 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:40:20.362145 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:40:20.366076 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:40:20.378050 (MainThread): Parsing macros/core.sql
2021-03-30 13:40:20.383011 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:40:20.392743 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:40:20.395244 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:40:20.412250 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:40:20.443363 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:40:20.462686 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:40:20.464728 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:40:20.470547 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:40:20.483822 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:40:20.490211 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:40:20.496568 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:40:20.501373 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:40:20.502393 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:40:20.503548 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:40:20.505253 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:40:20.514071 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:40:20.516045 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:40:20.517807 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:40:20.562221 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:40:20.564428 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:40:20.566375 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:40:20.568806 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:40:20.576953 (MainThread): Partial parsing not enabled
2021-03-30 13:40:20.612224 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:40:20.630112 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:40:20.750063 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a258a9-c474-4467-a5c4-3af25593a3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f6100>]}
2021-03-30 13:40:20.773369 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:40:20.773993 (MainThread): 
2021-03-30 13:40:20.774353 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:40:20.776695 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw".
2021-03-30 13:40:20.788777 (ThreadPoolExecutor-0_0): Using snowflake connection "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw".
2021-03-30 13:40:20.788868 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw"} */

    show terse schemas in database {'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw
    limit 10000
2021-03-30 13:40:20.788943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:40:22.173978 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b4-32f0-5079-0000-9c95001260b2
2021-03-30 13:40:22.174194 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:40:22.174403 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:40:22.174530 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:40:22.174735 (ThreadPoolExecutor-0_0): On list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw: Close
2021-03-30 13:40:22.372458 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:40:22.372635 (MainThread): Connection 'list_{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw' was properly closed.
2021-03-30 13:40:22.372840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e820>]}
2021-03-30 13:40:22.373080 (MainThread): Flushing usage events
2021-03-30 13:40:22.920878 (MainThread): Encountered an error:
2021-03-30 13:40:22.921109 (MainThread): Runtime Error
  Database error while listing schemas in database "{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:40:22.933504 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "{'account': 'if91078.eu-west-1', 'user': 'dev_dw_dbt', 'database': 'dev_dw', 'schema': 'dw_stg', 'warehouse': 'development_wh', 'role': 'dev_dw_transformer', 'client_session_keep_alive': False, 'type': 'snowflake', 'threads': 1, 'name': 'dev', 'target_name': 'dev', 'profile_name': 'ff-snowflake-db', 'config': {'send_anonymous_usage_stats': True}}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.

2021-03-30 13:40:54.613368 (MainThread): Running with dbt=0.19.0
2021-03-30 13:40:55.060720 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-03-30 13:40:55.061336 (MainThread): Tracking: tracking
2021-03-30 13:40:55.061654 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e609d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e7a430>]}
2021-03-30 13:40:55.080839 (MainThread): Partial parsing not enabled
2021-03-30 13:40:55.081474 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:40:55.082974 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:40:55.084865 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:40:55.112135 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:40:55.114105 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:40:55.115462 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:40:55.119120 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:40:55.128603 (MainThread): Parsing macros/core.sql
2021-03-30 13:40:55.132138 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:40:55.140611 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:40:55.142213 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:40:55.159430 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:40:55.189779 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:40:55.209432 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:40:55.211128 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:40:55.217284 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:40:55.230361 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:40:55.236852 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:40:55.242633 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:40:55.247340 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:40:55.248206 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:40:55.249178 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:40:55.250663 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:40:55.258886 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:40:55.260684 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:40:55.262216 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:40:55.304670 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:40:55.306394 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:40:55.307806 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:40:55.309457 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:40:55.316490 (MainThread): Partial parsing not enabled
2021-03-30 13:40:55.351117 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:40:55.367839 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:40:55.483141 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd533c74-39cb-4e57-a851-e0e881ec2ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113180580>]}
2021-03-30 13:40:55.507281 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:40:55.508009 (MainThread): 
2021-03-30 13:40:55.508495 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:40:55.510696 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_target_dev_dw_dw_stg".
2021-03-30 13:40:55.521735 (ThreadPoolExecutor-0_0): Using snowflake connection "list_target_dev_dw_dw_stg".
2021-03-30 13:40:55.521824 (ThreadPoolExecutor-0_0): On list_target_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_target_dev_dw_dw_stg"} */

    show terse objects in target_dev_dw.dw_stg
2021-03-30 13:40:55.521900 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:40:56.501343 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b4-325f-6c77-0000-9c950013020e
2021-03-30 13:40:56.501572 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:40:56.501790 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-30 13:40:56.501932 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:40:56.502149 (ThreadPoolExecutor-0_0): On list_target_dev_dw_dw_stg: Close
2021-03-30 13:40:56.666273 (MainThread): 15:40:56 | Concurrency: 1 threads (target='dev')
2021-03-30 13:40:56.666497 (MainThread): 15:40:56 | 
2021-03-30 13:40:56.667679 (Thread-1): Began running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 13:40:56.668071 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:40:56.668234 (Thread-1): Compiling model.ff_datawarehouse.my_first_dbt_model
2021-03-30 13:40:56.685270 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_first_dbt_model"
2021-03-30 13:40:56.685737 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.686034 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.686477 (Thread-1): Finished running node model.ff_datawarehouse.my_first_dbt_model
2021-03-30 13:40:56.686934 (Thread-1): Began running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 13:40:56.687225 (Thread-1): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:40:56.687347 (Thread-1): Compiling model.ff_datawarehouse.my_second_dbt_model
2021-03-30 13:40:56.695128 (Thread-1): Writing injected SQL for node "model.ff_datawarehouse.my_second_dbt_model"
2021-03-30 13:40:56.695574 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.695843 (Thread-1): finished collecting timing info
2021-03-30 13:40:56.696261 (Thread-1): Finished running node model.ff_datawarehouse.my_second_dbt_model
2021-03-30 13:40:56.697141 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:40:56.697258 (MainThread): Connection 'model.ff_datawarehouse.my_second_dbt_model' was properly closed.
2021-03-30 13:40:56.725357 (MainThread): 15:40:56 | Done.
2021-03-30 13:40:56.725560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131764f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ffdd30>]}
2021-03-30 13:40:56.725747 (MainThread): Flushing usage events
2021-03-30 13:42:08.353205 (MainThread): Running with dbt=0.19.0
2021-03-30 13:42:09.036434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:42:09.037693 (MainThread): Tracking: tracking
2021-03-30 13:42:09.037988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f52beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b42e0>]}
2021-03-30 13:42:09.057529 (MainThread): Partial parsing not enabled
2021-03-30 13:42:09.058215 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:42:09.059812 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:42:09.061964 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:42:09.089851 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:42:09.091960 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:42:09.093777 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:42:09.097888 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:42:09.107997 (MainThread): Parsing macros/core.sql
2021-03-30 13:42:09.112325 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:42:09.121334 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:42:09.123729 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:42:09.140671 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:42:09.172704 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:42:09.193437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:42:09.195423 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:42:09.201393 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:42:09.214815 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:42:09.222039 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:42:09.228117 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:42:09.232966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:42:09.234037 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:42:09.235244 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:42:09.237136 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:42:09.245586 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:42:09.247896 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:42:09.249689 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:42:09.294251 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:42:09.296225 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:42:09.297974 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:42:09.299794 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:42:09.307100 (MainThread): Partial parsing not enabled
2021-03-30 13:42:09.342454 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:42:09.360251 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:42:09.484239 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f260be-3ba0-44cb-8c6e-aa4e581195d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8100>]}
2021-03-30 13:42:09.507055 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:42:09.507947 (MainThread): 
2021-03-30 13:42:09.508371 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:42:09.511344 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_target_dev_dw".
2021-03-30 13:42:09.524429 (ThreadPoolExecutor-0_0): Using snowflake connection "list_target_dev_dw".
2021-03-30 13:42:09.524595 (ThreadPoolExecutor-0_0): On list_target_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_target_dev_dw"} */

    show terse schemas in database target_dev_dw
    limit 10000
2021-03-30 13:42:09.524744 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:42:10.631523 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b6-32a4-ab42-0000-9c950012f1e2
2021-03-30 13:42:10.631746 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:42:10.631954 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:42:10.632086 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:42:10.632295 (ThreadPoolExecutor-0_0): On list_target_dev_dw: Close
2021-03-30 13:42:10.781149 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:42:10.781332 (MainThread): Connection 'list_target_dev_dw' was properly closed.
2021-03-30 13:42:10.781536 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120715e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ed4f0>]}
2021-03-30 13:42:10.781777 (MainThread): Flushing usage events
2021-03-30 13:42:11.332754 (MainThread): Encountered an error:
2021-03-30 13:42:11.332989 (MainThread): Runtime Error
  Database error while listing schemas in database "target_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 13:42:11.345523 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "target_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:42:44.837986 (MainThread): Running with dbt=0.19.0
2021-03-30 13:42:45.434760 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:42:45.435890 (MainThread): Tracking: tracking
2021-03-30 13:42:45.436169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c564430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1eaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57f1c0>]}
2021-03-30 13:42:45.456326 (MainThread): Partial parsing not enabled
2021-03-30 13:42:45.457287 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:42:45.459066 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:42:45.461177 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:42:45.489592 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:42:45.491697 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:42:45.493288 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:42:45.497431 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:42:45.508863 (MainThread): Parsing macros/core.sql
2021-03-30 13:42:45.512824 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:42:45.521908 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:42:45.523913 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:42:45.541772 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:42:45.574239 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:42:45.597993 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:42:45.599965 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:42:45.606210 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:42:45.624397 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:42:45.635035 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:42:45.642039 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:42:45.647095 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:42:45.648213 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:42:45.649480 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:42:45.651198 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:42:45.659883 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:42:45.662810 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:42:45.664594 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:42:45.706570 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:42:45.709776 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:42:45.712554 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:42:45.715211 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:42:45.724456 (MainThread): Partial parsing not enabled
2021-03-30 13:42:45.760060 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:42:45.778477 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:42:45.902641 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c8921b0-fc5e-4356-832c-03dfae31fe92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb6100>]}
2021-03-30 13:42:45.927420 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:42:45.928101 (MainThread): 
2021-03-30 13:42:45.928678 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:42:45.930872 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_{target}_dev_dw".
2021-03-30 13:42:45.942557 (ThreadPoolExecutor-0_0): Using snowflake connection "list_{target}_dev_dw".
2021-03-30 13:42:45.942649 (ThreadPoolExecutor-0_0): On list_{target}_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_{target}_dev_dw"} */

    show terse schemas in database {target}_dev_dw
    limit 10000
2021-03-30 13:42:45.942724 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:42:47.297042 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b6-326b-6885-0000-9c950012e21a
2021-03-30 13:42:47.297279 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:42:47.297495 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:42:47.297631 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:42:47.297853 (ThreadPoolExecutor-0_0): On list_{target}_dev_dw: Close
2021-03-30 13:42:47.711856 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:42:47.712043 (MainThread): Connection 'list_{target}_dev_dw' was properly closed.
2021-03-30 13:42:47.712256 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc05e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd4dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdce340>]}
2021-03-30 13:42:47.712519 (MainThread): Flushing usage events
2021-03-30 13:42:48.308666 (MainThread): Encountered an error:
2021-03-30 13:42:48.308906 (MainThread): Runtime Error
  Database error while listing schemas in database "{target}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.
2021-03-30 13:42:48.318468 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 31 unexpected '{'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "{target}_dev_dw"
  Database Error
    001003 (42000): SQL compilation error:
    syntax error line 1 at position 31 unexpected '{'.

2021-03-30 13:45:05.781310 (MainThread): Running with dbt=0.19.0
2021-03-30 13:45:06.200683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:45:06.201307 (MainThread): Tracking: tracking
2021-03-30 13:45:06.201596 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107855e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106189040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786f220>]}
2021-03-30 13:45:06.219740 (MainThread): Partial parsing not enabled
2021-03-30 13:45:06.220385 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:45:06.222150 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:45:06.224224 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:45:06.251019 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:45:06.252936 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:45:06.254257 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:45:06.257842 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:45:06.267635 (MainThread): Parsing macros/core.sql
2021-03-30 13:45:06.271197 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:45:06.279449 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:45:06.281097 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:45:06.297721 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:45:06.328097 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:45:06.348015 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:45:06.349711 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:45:06.355423 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:45:06.368393 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:45:06.374960 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:45:06.380863 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:45:06.385456 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:45:06.386499 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:45:06.387475 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:45:06.388974 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:45:06.400005 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:45:06.402033 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:45:06.403681 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:45:06.444845 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:45:06.446649 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:45:06.448104 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:45:06.449723 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:45:06.456894 (MainThread): Partial parsing not enabled
2021-03-30 13:45:06.491900 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:45:06.508855 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:45:06.626220 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d5abaa5-f9f9-4d35-be95-c2a08d0ee452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b76550>]}
2021-03-30 13:45:06.647504 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:45:06.648213 (MainThread): 
2021-03-30 13:45:06.648720 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:45:06.650863 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dev_dw".
2021-03-30 13:45:06.662741 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dev_dw".
2021-03-30 13:45:06.662861 (ThreadPoolExecutor-0_0): On list_dev_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dev_dw"} */

    show terse schemas in database dev_dev_dw
    limit 10000
2021-03-30 13:45:06.662943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:45:08.783350 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b9-32dd-5e38-0000-9c950012f1e6
2021-03-30 13:45:08.784262 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:45:08.784724 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:45:08.784955 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:45:08.785239 (ThreadPoolExecutor-0_0): On list_dev_dev_dw: Close
2021-03-30 13:45:09.435753 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:45:09.435938 (MainThread): Connection 'list_dev_dev_dw' was properly closed.
2021-03-30 13:45:09.436142 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b767f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6b4f0>]}
2021-03-30 13:45:09.436375 (MainThread): Flushing usage events
2021-03-30 13:45:10.048568 (MainThread): Encountered an error:
2021-03-30 13:45:10.048809 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 13:45:10.058619 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:45:50.701825 (MainThread): Running with dbt=0.19.0
2021-03-30 13:45:51.150941 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:45:51.152098 (MainThread): Tracking: tracking
2021-03-30 13:45:51.152357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e338970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb6f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e34c370>]}
2021-03-30 13:45:51.171767 (MainThread): Partial parsing not enabled
2021-03-30 13:45:51.172400 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:45:51.173874 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:45:51.175718 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:45:51.202219 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:45:51.204072 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:45:51.205396 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:45:51.208954 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:45:51.219756 (MainThread): Parsing macros/core.sql
2021-03-30 13:45:51.224312 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:45:51.232771 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:45:51.234417 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:45:51.250639 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:45:51.281573 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:45:51.301497 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:45:51.303247 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:45:51.309112 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:45:51.322436 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:45:51.328900 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:45:51.334880 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:45:51.339614 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:45:51.340509 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:45:51.341518 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:45:51.343060 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:45:51.351514 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:45:51.353375 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:45:51.354957 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:45:51.394457 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:45:51.396146 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:45:51.398023 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:45:51.399595 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:45:51.406509 (MainThread): Partial parsing not enabled
2021-03-30 13:45:51.440126 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:45:51.456613 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:45:51.567859 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67188ab0-5e19-4f29-9704-7c86119f9f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec77b50>]}
2021-03-30 13:45:51.589192 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:45:51.589996 (MainThread): 
2021-03-30 13:45:51.590548 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:45:51.592761 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_dw".
2021-03-30 13:45:51.604403 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_dw".
2021-03-30 13:45:51.604491 (ThreadPoolExecutor-0_0): On list_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_dw"} */

    show terse schemas in database dev_dw
    limit 10000
2021-03-30 13:45:51.604569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:45:52.812914 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40b9-3291-c0cb-0000-9c950012f1ea
2021-03-30 13:45:52.813147 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 13:45:52.813365 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 13:45:52.813518 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:45:52.813739 (ThreadPoolExecutor-0_0): On list_dev_dw: Close
2021-03-30 13:45:53.005916 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:45:53.006086 (MainThread): Connection 'list_dev_dw' was properly closed.
2021-03-30 13:45:53.006272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec77dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec6d4f0>]}
2021-03-30 13:45:53.006504 (MainThread): Flushing usage events
2021-03-30 13:45:53.528819 (MainThread): Encountered an error:
2021-03-30 13:45:53.529051 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 13:45:53.538460 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-30 13:55:56.278373 (MainThread): Running with dbt=0.19.0
2021-03-30 13:55:56.972635 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 13:55:56.974063 (MainThread): Tracking: tracking
2021-03-30 13:55:56.974458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11493dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11495e640>]}
2021-03-30 13:55:56.997427 (MainThread): Partial parsing not enabled
2021-03-30 13:55:56.998438 (MainThread): Parsing macros/get_custom_database.sql
2021-03-30 13:55:57.000150 (MainThread): Parsing macros/catalog.sql
2021-03-30 13:55:57.002305 (MainThread): Parsing macros/adapters.sql
2021-03-30 13:55:57.030044 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 13:55:57.032196 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 13:55:57.033781 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 13:55:57.037726 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 13:55:57.047709 (MainThread): Parsing macros/core.sql
2021-03-30 13:55:57.051723 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 13:55:57.060785 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 13:55:57.063211 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 13:55:57.080622 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 13:55:57.111703 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 13:55:57.131744 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 13:55:57.133697 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 13:55:57.139766 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 13:55:57.153470 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 13:55:57.160041 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 13:55:57.166256 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 13:55:57.171070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 13:55:57.172175 (MainThread): Parsing macros/etc/query.sql
2021-03-30 13:55:57.173343 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 13:55:57.175007 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 13:55:57.186489 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 13:55:57.188769 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 13:55:57.190656 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 13:55:57.231565 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 13:55:57.233556 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 13:55:57.235248 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 13:55:57.237104 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 13:55:57.244546 (MainThread): Partial parsing not enabled
2021-03-30 13:55:57.279076 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 13:55:57.300620 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 13:55:57.422956 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c94100a-29f5-4bda-b00d-8154a9047b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11527b5b0>]}
2021-03-30 13:55:57.444866 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 13:55:57.445458 (MainThread): 
2021-03-30 13:55:57.445984 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 13:55:57.448128 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JM_develop_dev_dw".
2021-03-30 13:55:57.459401 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JM_develop_dev_dw".
2021-03-30 13:55:57.459490 (ThreadPoolExecutor-0_0): On list_JM_develop_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_JM_develop_dev_dw"} */

    show terse schemas in database JM_develop_dev_dw
    limit 10000
2021-03-30 13:55:57.459563 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 13:55:58.829695 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.37 seconds
2021-03-30 13:55:58.834699 (ThreadPoolExecutor-0_0): On list_JM_develop_dev_dw: Close
2021-03-30 13:55:59.295795 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:55:59.296134 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:55:59.296335 (ThreadPoolExecutor-0_0): Creating schema "JM_develop_dev_dw.dw_stg"
2021-03-30 13:55:59.302532 (ThreadPoolExecutor-0_0): Using snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:55:59.302677 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: BEGIN
2021-03-30 13:55:59.302788 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-03-30 13:56:00.624287 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.32 seconds
2021-03-30 13:56:00.624458 (ThreadPoolExecutor-0_0): Using snowflake connection "create_JM_develop_dev_dw_dw_stg".
2021-03-30 13:56:00.624552 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "create_JM_develop_dev_dw_dw_stg"} */
create schema if not exists JM_develop_dev_dw.dw_stg
2021-03-30 13:56:00.917671 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40c4-32c5-765e-0000-9c9500123652
2021-03-30 13:56:00.917887 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-03-30 13:56:00.918094 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-03-30 13:56:00.918240 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 13:56:00.918393 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: ROLLBACK
2021-03-30 13:56:01.234443 (ThreadPoolExecutor-0_0): On create_JM_develop_dev_dw_dw_stg: Close
2021-03-30 13:56:01.840207 (MainThread): Connection 'master' was properly closed.
2021-03-30 13:56:01.840394 (MainThread): Connection 'create_JM_develop_dev_dw_dw_stg' was properly closed.
2021-03-30 13:56:01.840602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150f67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11527b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150fa0d0>]}
2021-03-30 13:56:01.840849 (MainThread): Flushing usage events
2021-03-30 13:56:02.469809 (MainThread): Encountered an error:
2021-03-30 13:56:02.470051 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-03-30 13:56:02.482657 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 538, in create_schemas
    create_future.result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 500, in create_schema
    adapter.create_schema(relation)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DW_STG' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-03-30 14:29:29.662522 (MainThread): Running with dbt=0.19.0
2021-03-30 14:29:30.425087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-30 14:29:30.426301 (MainThread): Tracking: tracking
2021-03-30 14:29:30.426625 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135cce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11452a580>]}
2021-03-30 14:29:30.450200 (MainThread): Partial parsing not enabled
2021-03-30 14:29:30.451495 (MainThread): Parsing macros/catalog.sql
2021-03-30 14:29:30.454255 (MainThread): Parsing macros/adapters.sql
2021-03-30 14:29:30.486531 (MainThread): Parsing macros/materializations/merge.sql
2021-03-30 14:29:30.488947 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 14:29:30.490806 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 14:29:30.495432 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 14:29:30.508232 (MainThread): Parsing macros/core.sql
2021-03-30 14:29:30.513524 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 14:29:30.524469 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 14:29:30.527282 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 14:29:30.548559 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 14:29:30.585490 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 14:29:30.612780 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 14:29:30.616827 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 14:29:30.625391 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 14:29:30.641339 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 14:29:30.649239 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 14:29:30.656675 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 14:29:30.662588 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 14:29:30.663886 (MainThread): Parsing macros/etc/query.sql
2021-03-30 14:29:30.665303 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 14:29:30.667248 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 14:29:30.677232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 14:29:30.679447 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 14:29:30.681239 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 14:29:30.730445 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 14:29:30.734532 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 14:29:30.737628 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 14:29:30.740640 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 14:29:30.750113 (MainThread): Partial parsing not enabled
2021-03-30 14:29:30.787078 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-30 14:29:30.806354 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-30 14:29:30.929569 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d224e7f-c588-49b1-9b7e-d1f8c88223c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163b4e80>]}
2021-03-30 14:29:30.953577 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-30 14:29:30.954280 (MainThread): 
2021-03-30 14:29:30.954721 (MainThread): Acquiring new snowflake connection "master".
2021-03-30 14:29:30.957016 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_JM_develop_DEV_DW".
2021-03-30 14:29:30.968563 (ThreadPoolExecutor-0_0): Using snowflake connection "list_JM_develop_DEV_DW".
2021-03-30 14:29:30.968653 (ThreadPoolExecutor-0_0): On list_JM_develop_DEV_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_JM_develop_DEV_DW"} */

    show terse schemas in database JM_develop_DEV_DW
    limit 10000
2021-03-30 14:29:30.968729 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 14:29:32.692136 (ThreadPoolExecutor-0_0): Snowflake query id: 019b40e5-328f-bd2e-0000-9c9500130222
2021-03-30 14:29:32.692287 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-30 14:29:32.692430 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-30 14:29:32.692519 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-30 14:29:32.692663 (ThreadPoolExecutor-0_0): On list_JM_develop_DEV_DW: Close
2021-03-30 14:29:33.186705 (MainThread): Connection 'master' was properly closed.
2021-03-30 14:29:33.186889 (MainThread): Connection 'list_JM_develop_DEV_DW' was properly closed.
2021-03-30 14:29:33.187095 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163b4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114589910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116238d00>]}
2021-03-30 14:29:33.187341 (MainThread): Flushing usage events
2021-03-30 14:29:33.814937 (MainThread): Encountered an error:
2021-03-30 14:29:33.815170 (MainThread): Runtime Error
  Database error while listing schemas in database "JM_develop_DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-30 14:29:33.828431 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "JM_develop_DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:22:33.422415 (MainThread): Running with dbt=0.19.0
2021-03-31 08:22:34.216433 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:22:34.217958 (MainThread): Tracking: tracking
2021-03-31 08:22:34.218259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f61cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5329d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63a5b0>]}
2021-03-31 08:22:34.237912 (MainThread): Partial parsing not enabled
2021-03-31 08:22:34.238874 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:22:34.240536 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:22:34.242589 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:22:34.271171 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:22:34.273255 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:22:34.274987 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:22:34.278900 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:22:34.290178 (MainThread): Parsing macros/core.sql
2021-03-31 08:22:34.294603 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:22:34.303645 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:22:34.306376 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:22:34.324211 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:22:34.355727 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:22:34.375905 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:22:34.377775 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:22:34.384069 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:22:34.397636 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:22:34.404427 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:22:34.410554 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:22:34.416514 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:22:34.417595 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:22:34.418835 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:22:34.420621 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:22:34.429132 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:22:34.431209 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:22:34.432937 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:22:34.472860 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:22:34.475266 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:22:34.476919 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:22:34.478619 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:22:34.486627 (MainThread): Partial parsing not enabled
2021-03-31 08:22:34.520809 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:22:34.541581 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-31 08:22:34.660250 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c847608d-c5ea-4844-90c8-e495307f793f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93c5b0>]}
2021-03-31 08:22:34.683529 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 08:22:34.684304 (MainThread): 
2021-03-31 08:22:34.684698 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 08:22:34.686944 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:22:34.698680 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:22:34.698771 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_JM__DEV_DW"} */

    show terse schemas in database dev_JM__DEV_DW
    limit 10000
2021-03-31 08:22:34.698849 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 08:22:36.241390 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4516-3200-7cca-0000-9c950013a00a
2021-03-31 08:22:36.241621 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-31 08:22:36.241837 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 08:22:36.241971 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 08:22:36.242184 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: Close
2021-03-31 08:22:36.382392 (MainThread): Connection 'master' was properly closed.
2021-03-31 08:22:36.382573 (MainThread): Connection 'list_dev_JM__DEV_DW' was properly closed.
2021-03-31 08:22:36.382775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f931e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f931fa0>]}
2021-03-31 08:22:36.383018 (MainThread): Flushing usage events
2021-03-31 08:22:36.998743 (MainThread): Encountered an error:
2021-03-31 08:22:36.998975 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-31 08:22:37.011747 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:54:12.127089 (MainThread): Running with dbt=0.19.0
2021-03-31 08:54:12.957328 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:54:12.959293 (MainThread): Tracking: tracking
2021-03-31 08:54:12.959644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6daf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7a550>]}
2021-03-31 08:54:12.980792 (MainThread): Partial parsing not enabled
2021-03-31 08:54:12.982030 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:54:12.983755 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:54:12.985813 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:54:13.013193 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:54:13.015333 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:54:13.017023 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:54:13.021080 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:54:13.031823 (MainThread): Parsing macros/core.sql
2021-03-31 08:54:13.036381 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:54:13.045402 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:54:13.047829 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:54:13.064796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:54:13.095479 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:54:13.115967 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:54:13.117873 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:54:13.123897 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:54:13.137113 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:54:13.143978 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:54:13.150838 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:54:13.156843 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:54:13.158479 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:54:13.159940 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:54:13.162230 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:54:13.172184 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:54:13.174211 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:54:13.176004 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:54:13.216244 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:54:13.218181 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:54:13.219789 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:54:13.221623 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:54:13.228787 (MainThread): Partial parsing not enabled
2021-03-31 08:54:13.264120 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:54:13.282141 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-31 08:54:13.400070 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d28cb11-5fe6-49c6-9ef7-f661958a4128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bd5e0>]}
2021-03-31 08:54:13.422002 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 08:54:13.422657 (MainThread): 
2021-03-31 08:54:13.423158 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 08:54:13.425324 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:54:13.436573 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_JM__DEV_DW".
2021-03-31 08:54:13.436661 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_JM__DEV_DW"} */

    show terse schemas in database dev_JM__DEV_DW
    limit 10000
2021-03-31 08:54:13.436736 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 08:54:14.526552 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4536-3200-7cd1-0000-9c950013c00a
2021-03-31 08:54:14.526782 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-31 08:54:14.526995 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 08:54:14.527133 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 08:54:14.527352 (ThreadPoolExecutor-0_0): On list_dev_JM__DEV_DW: Close
2021-03-31 08:54:14.691763 (MainThread): Connection 'master' was properly closed.
2021-03-31 08:54:14.691944 (MainThread): Connection 'list_dev_JM__DEV_DW' was properly closed.
2021-03-31 08:54:14.692150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111237760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b36a0>]}
2021-03-31 08:54:14.692398 (MainThread): Flushing usage events
2021-03-31 08:54:15.350419 (MainThread): Encountered an error:
2021-03-31 08:54:15.350654 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-31 08:54:15.366303 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_JM__DEV_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:54:37.245595 (MainThread): Running with dbt=0.19.0
2021-03-31 08:54:37.643646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:54:37.644322 (MainThread): Tracking: tracking
2021-03-31 08:54:37.644609 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cef940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10396eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d033a0>]}
2021-03-31 08:54:37.664324 (MainThread): Partial parsing not enabled
2021-03-31 08:54:37.664998 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:54:37.666604 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:54:37.668529 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:54:37.698953 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:54:37.701574 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:54:37.703135 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:54:37.707376 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:54:37.722119 (MainThread): Parsing macros/core.sql
2021-03-31 08:54:37.726754 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:54:37.741646 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:54:37.743897 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:54:37.766930 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:54:37.807596 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:54:37.833389 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:54:37.835677 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:54:37.842528 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:54:37.856359 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:54:37.863300 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:54:37.869680 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:54:37.875178 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:54:37.876279 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:54:37.877516 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:54:37.879458 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:54:37.888159 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:54:37.890267 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:54:37.892109 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:54:37.933994 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:54:37.936245 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:54:37.938079 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:54:37.939927 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:54:37.947299 (MainThread): Partial parsing not enabled
2021-03-31 08:54:37.981839 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:54:37.999699 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_second_dbt_model".
2021-03-31 08:54:38.116826 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f6fe6b-4cfd-4e87-829d-933880d38cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066385e0>]}
2021-03-31 08:54:38.138573 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 144 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-03-31 08:54:38.139354 (MainThread): 
2021-03-31 08:54:38.139705 (MainThread): Acquiring new snowflake connection "master".
2021-03-31 08:54:38.142140 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dev_DW".
2021-03-31 08:54:38.154258 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dev_DW".
2021-03-31 08:54:38.154374 (ThreadPoolExecutor-0_0): On list_dev_DW: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "ff-snowflake-db", "target_name": "dev", "connection_name": "list_dev_DW"} */

    show terse schemas in database dev_DW
    limit 10000
2021-03-31 08:54:38.154456 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 08:54:39.228990 (ThreadPoolExecutor-0_0): Snowflake query id: 019b4536-3200-7cae-0000-9c950013e006
2021-03-31 08:54:39.229216 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-03-31 08:54:39.229428 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-31 08:54:39.229565 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 08:54:39.229781 (ThreadPoolExecutor-0_0): On list_dev_DW: Close
2021-03-31 08:54:39.375513 (MainThread): Connection 'master' was properly closed.
2021-03-31 08:54:39.375695 (MainThread): Connection 'list_dev_DW' was properly closed.
2021-03-31 08:54:39.375898 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d52d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d424f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b0d00>]}
2021-03-31 08:54:39.376141 (MainThread): Flushing usage events
2021-03-31 08:54:39.921842 (MainThread): Encountered an error:
2021-03-31 08:54:39.922074 (MainThread): Runtime Error
  Database error while listing schemas in database "dev_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-03-31 08:54:39.932335 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dev_DW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-03-31 08:55:45.898174 (MainThread): Running with dbt=0.19.0
2021-03-31 08:55:46.333763 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/jmartins/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-31 08:55:46.334332 (MainThread): Tracking: tracking
2021-03-31 08:55:46.334592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114112c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbc070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114140280>]}
2021-03-31 08:55:46.353777 (MainThread): Partial parsing not enabled
2021-03-31 08:55:46.354425 (MainThread): Parsing macros/get_custom_database.sql
2021-03-31 08:55:46.356044 (MainThread): Parsing macros/catalog.sql
2021-03-31 08:55:46.357952 (MainThread): Parsing macros/adapters.sql
2021-03-31 08:55:46.385965 (MainThread): Parsing macros/materializations/merge.sql
2021-03-31 08:55:46.387890 (MainThread): Parsing macros/materializations/view.sql
2021-03-31 08:55:46.389277 (MainThread): Parsing macros/materializations/table.sql
2021-03-31 08:55:46.392996 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-31 08:55:46.402708 (MainThread): Parsing macros/core.sql
2021-03-31 08:55:46.406351 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 08:55:46.414648 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 08:55:46.416301 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 08:55:46.433300 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 08:55:46.464010 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 08:55:46.483471 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 08:55:46.485171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 08:55:46.490873 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 08:55:46.503841 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 08:55:46.510148 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 08:55:46.515946 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 08:55:46.520515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 08:55:46.521430 (MainThread): Parsing macros/etc/query.sql
2021-03-31 08:55:46.522406 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 08:55:46.523903 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 08:55:46.532516 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 08:55:46.534327 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 08:55:46.535873 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 08:55:46.576074 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 08:55:46.577891 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 08:55:46.579314 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 08:55:46.580905 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 08:55:46.588027 (MainThread): Partial parsing not enabled
2021-03-31 08:55:46.622256 (MainThread): Acquiring new snowflake connection "model.ff_datawarehouse.my_first_dbt_model".
2021-03-31 08:55:46.633365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11417dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148f03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148fe040>]}
2021-03-31 08:55:46.633541 (MainThread): Flushing usage events
2021-03-31 08:55:47.363471 (MainThread): Connection 'model.ff_datawarehouse.my_first_dbt_model' was properly closed.
2021-03-31 08:55:47.363706 (MainThread): Encountered an error:
2021-03-31 08:55:47.363896 (MainThread): Compilation Error in macro generate_database_name (macros/get_custom_database.sql)
  'get_user' is undefined
2021-03-31 08:55:47.369528 (MainThread): Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 30, in macro
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'get_user' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 373, in render_update
    self.update_parsed_node(node, config)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 329, in update_parsed_node
    self.update_parsed_node_name(parsed_node, config_dict)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 305, in update_parsed_node_name
    self._update_node_database(parsed_node, config_dict)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/parser/base.py", line 132, in __call__
    new_value = self.updater(override, parsed_node)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/Users/jmartins/.pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/Users/jmartins/.pyenv/versions/3.8.7/envs/dbt/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro generate_database_name (macros/get_custom_database.sql)
  'get_user' is undefined

2021-04-16 14:39:47.988885 (MainThread): Running with dbt=0.19.1
2021-04-16 14:39:48.363703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-16 14:39:48.371449 (MainThread): Tracking: tracking
2021-04-16 14:39:48.371674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdedb334e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded670e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded67102b0>]}
2021-04-16 14:39:48.372049 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-16 14:39:48.377947 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-16 14:39:48.378113 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-16 14:39:48.387229 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-16 14:39:48.392270 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-16 14:39:48.395485 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-16 14:39:48.398566 (Thread-1): Parsing macros/adapters.sql
2021-04-16 14:39:48.427185 (Thread-1): Parsing macros/catalog.sql
2021-04-16 14:39:48.429279 (Thread-1): Parsing macros/materializations/table.sql
2021-04-16 14:39:48.433162 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-16 14:39:48.435221 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-16 14:39:48.444378 (Thread-1): Parsing macros/materializations/view.sql
2021-04-16 14:39:48.446672 (Thread-1): Parsing macros/core.sql
2021-04-16 14:39:48.450573 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-16 14:39:48.459498 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-16 14:39:48.473693 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-16 14:39:48.475609 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-16 14:39:48.494593 (Thread-2): handling status request
2021-04-16 14:39:48.494984 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded6653250>]}
2021-04-16 14:39:48.495167 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-16 14:39:48.495881 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.37.128
2021-04-16 14:39:48.529345 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-16 14:39:48.534917 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-16 14:39:48.541377 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-16 14:39:48.562665 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-16 14:39:48.569683 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-16 14:39:48.571786 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-16 14:39:48.578055 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-16 14:39:48.579902 (Thread-1): Parsing macros/etc/query.sql
2021-04-16 14:39:48.581134 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-16 14:39:48.590332 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-16 14:39:48.591492 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-16 14:39:48.593364 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-16 14:39:48.595627 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-16 14:39:48.597371 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-16 14:39:48.600321 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-16 14:39:48.602485 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-16 14:39:48.604497 (Thread-1): Parsing macros/adapters/common.sql
2021-04-16 14:39:48.687566 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-16 14:40:47.051064 (Thread-3): handling status request
2021-04-16 14:40:47.051380 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4544910>]}
2021-04-16 14:40:47.052227 (Thread-3): sending response (<Response 9340 bytes [200 OK]>) to 10.0.2.151
2021-04-16 14:40:47.132789 (Thread-4): handling ps request
2021-04-16 14:40:47.133068 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4572a60>]}
2021-04-16 14:40:47.133549 (Thread-4): sending response (<Response 105 bytes [200 OK]>) to 10.0.44.212
2021-04-16 14:41:26.802513 (Thread-5): handling status request
2021-04-16 14:41:26.804467 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded45726d0>]}
2021-04-16 14:41:26.805238 (Thread-5): sending response (<Response 9340 bytes [200 OK]>) to 10.0.37.128
2021-04-16 14:41:27.235817 (Thread-6): handling compile_sql request
2021-04-16 14:41:27.236101 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4569ac0>]}
2021-04-16 14:41:27.236543 (Thread-6): sending response (<Response 605 bytes [200 OK]>) to 10.0.26.37
2021-04-16 14:47:58.139624 (Thread-7): handling ps request
2021-04-16 14:47:58.139968 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded457cac0>]}
2021-04-16 14:47:58.140477 (Thread-7): sending response (<Response 105 bytes [200 OK]>) to 10.0.37.187
2021-04-16 14:47:58.141621 (Thread-8): handling status request
2021-04-16 14:47:58.141832 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded452af10>]}
2021-04-16 14:47:58.142541 (Thread-8): sending response (<Response 9340 bytes [200 OK]>) to 10.0.9.82
2021-04-16 14:49:17.813017 (MainThread): Connection 'model.folkefinans_dw.dwd_loan_account' was properly closed.
2021-04-16 14:49:17.834186 (Thread-9): Parsing macros/get_custom_database.sql
2021-04-16 14:49:17.838363 (Thread-9): Parsing macros/generate_schema_name.sql
2021-04-16 14:49:17.841771 (Thread-9): Parsing macros/parse_credit_rules.sql
2021-04-16 14:49:17.844817 (Thread-9): Parsing macros/adapters.sql
2021-04-16 14:49:17.873387 (Thread-9): Parsing macros/catalog.sql
2021-04-16 14:49:17.875551 (Thread-9): Parsing macros/materializations/table.sql
2021-04-16 14:49:17.879592 (Thread-9): Parsing macros/materializations/merge.sql
2021-04-16 14:49:17.881705 (Thread-9): Parsing macros/materializations/incremental.sql
2021-04-16 14:49:17.891043 (Thread-9): Parsing macros/materializations/view.sql
2021-04-16 14:49:17.893413 (Thread-9): Parsing macros/core.sql
2021-04-16 14:49:17.897644 (Thread-9): Parsing macros/materializations/helpers.sql
2021-04-16 14:49:17.907231 (Thread-9): Parsing macros/materializations/common/merge.sql
2021-04-16 14:49:17.924848 (Thread-9): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-16 14:49:17.928300 (Thread-9): Parsing macros/materializations/snapshot/strategies.sql
2021-04-16 14:49:17.948945 (Thread-9): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-16 14:49:17.984484 (Thread-9): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-16 14:49:17.993624 (Thread-9): Parsing macros/materializations/view/view.sql
2021-04-16 14:49:18.004226 (Thread-9): Parsing macros/materializations/seed/seed.sql
2021-04-16 14:49:18.043069 (Thread-9): Parsing macros/materializations/table/table.sql
2021-04-16 14:49:18.055369 (Thread-9): Parsing macros/materializations/incremental/helpers.sql
2021-04-16 14:49:18.059041 (Thread-9): Parsing macros/materializations/incremental/incremental.sql
2021-04-16 14:49:18.067514 (Thread-9): Parsing macros/etc/is_incremental.sql
2021-04-16 14:49:18.070700 (Thread-9): Parsing macros/etc/query.sql
2021-04-16 14:49:18.072872 (Thread-9): Parsing macros/etc/datetime.sql
2021-04-16 14:49:18.089525 (Thread-9): Parsing macros/etc/get_custom_alias.sql
2021-04-16 14:49:18.095083 (Thread-9): Parsing macros/etc/get_custom_database.sql
2021-04-16 14:49:18.097655 (Thread-9): Parsing macros/etc/get_custom_schema.sql
2021-04-16 14:49:18.099750 (Thread-9): Parsing macros/schema_tests/not_null.sql
2021-04-16 14:49:18.101450 (Thread-9): Parsing macros/schema_tests/accepted_values.sql
2021-04-16 14:49:18.104570 (Thread-9): Parsing macros/schema_tests/relationships.sql
2021-04-16 14:49:18.106774 (Thread-9): Parsing macros/schema_tests/unique.sql
2021-04-16 14:49:18.108663 (Thread-9): Parsing macros/adapters/common.sql
2021-04-16 14:49:18.194120 (Thread-9): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-16 14:49:18.208990 (Thread-9): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-16 14:49:18.216461 (Thread-9): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-16 14:49:18.235838 (Thread-10): handling status request
2021-04-16 14:49:18.236127 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded43e8880>]}
2021-04-16 14:49:18.236818 (Thread-10): sending response (<Response 185 bytes [200 OK]>) to 10.0.9.82
2021-04-16 14:49:18.423293 (Thread-9): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded420a6d0>]}
2021-04-16 14:49:19.628629 (Thread-11): handling status request
2021-04-16 14:49:19.628913 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded43f8d00>]}
2021-04-16 14:49:19.629704 (Thread-11): sending response (<Response 10258 bytes [200 OK]>) to 10.0.17.76
2021-04-16 14:49:39.035619 (Thread-12): handling status request
2021-04-16 14:49:39.035957 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded670e310>]}
2021-04-16 14:49:39.036796 (Thread-12): sending response (<Response 10258 bytes [200 OK]>) to 10.0.27.72
2021-04-16 14:49:42.648982 (MainThread): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-16 14:49:42.669195 (Thread-13): Parsing macros/get_custom_database.sql
2021-04-16 14:49:42.673736 (Thread-13): Parsing macros/generate_schema_name.sql
2021-04-16 14:49:42.677837 (Thread-13): Parsing macros/parse_credit_rules.sql
2021-04-16 14:49:42.680901 (Thread-13): Parsing macros/adapters.sql
2021-04-16 14:49:42.722464 (Thread-13): Parsing macros/catalog.sql
2021-04-16 14:49:42.724662 (Thread-13): Parsing macros/materializations/table.sql
2021-04-16 14:49:42.728658 (Thread-13): Parsing macros/materializations/merge.sql
2021-04-16 14:49:42.730751 (Thread-13): Parsing macros/materializations/incremental.sql
2021-04-16 14:49:42.739923 (Thread-13): Parsing macros/materializations/view.sql
2021-04-16 14:49:42.742293 (Thread-13): Parsing macros/core.sql
2021-04-16 14:49:42.746348 (Thread-13): Parsing macros/materializations/helpers.sql
2021-04-16 14:49:42.757564 (Thread-13): Parsing macros/materializations/common/merge.sql
2021-04-16 14:49:42.781242 (Thread-13): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-16 14:49:42.783920 (Thread-13): Parsing macros/materializations/snapshot/strategies.sql
2021-04-16 14:49:42.811454 (Thread-13): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-16 14:49:42.855208 (Thread-13): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-16 14:49:42.860242 (Thread-13): Parsing macros/materializations/view/view.sql
2021-04-16 14:49:42.866447 (Thread-13): Parsing macros/materializations/seed/seed.sql
2021-04-16 14:49:42.886698 (Thread-13): Parsing macros/materializations/table/table.sql
2021-04-16 14:49:42.893214 (Thread-13): Parsing macros/materializations/incremental/helpers.sql
2021-04-16 14:49:42.895144 (Thread-13): Parsing macros/materializations/incremental/incremental.sql
2021-04-16 14:49:42.900978 (Thread-13): Parsing macros/etc/is_incremental.sql
2021-04-16 14:49:42.906712 (Thread-13): Parsing macros/etc/query.sql
2021-04-16 14:49:42.907777 (Thread-13): Parsing macros/etc/datetime.sql
2021-04-16 14:49:42.916423 (Thread-13): Parsing macros/etc/get_custom_alias.sql
2021-04-16 14:49:42.917378 (Thread-13): Parsing macros/etc/get_custom_database.sql
2021-04-16 14:49:42.918988 (Thread-13): Parsing macros/etc/get_custom_schema.sql
2021-04-16 14:49:42.920913 (Thread-13): Parsing macros/schema_tests/not_null.sql
2021-04-16 14:49:42.922398 (Thread-13): Parsing macros/schema_tests/accepted_values.sql
2021-04-16 14:49:42.925086 (Thread-13): Parsing macros/schema_tests/relationships.sql
2021-04-16 14:49:42.926911 (Thread-13): Parsing macros/schema_tests/unique.sql
2021-04-16 14:49:42.928606 (Thread-13): Parsing macros/adapters/common.sql
2021-04-16 14:49:43.005477 (Thread-13): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-16 14:49:43.014296 (Thread-13): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-16 14:49:43.022873 (Thread-13): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-16 14:49:43.113722 (Thread-14): handling status request
2021-04-16 14:49:43.130496 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded410b6a0>]}
2021-04-16 14:49:43.131161 (Thread-14): sending response (<Response 185 bytes [200 OK]>) to 10.0.40.253
2021-04-16 14:49:43.333770 (Thread-13): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded40fe3d0>]}
2021-04-16 14:49:44.542328 (Thread-15): handling status request
2021-04-16 14:49:44.542614 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4117ca0>]}
2021-04-16 14:49:44.543421 (Thread-15): sending response (<Response 10294 bytes [200 OK]>) to 10.0.9.82
2021-04-16 14:50:09.820659 (Thread-16): handling status request
2021-04-16 14:50:09.820963 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4117bb0>]}
2021-04-16 14:50:09.821766 (Thread-16): sending response (<Response 10294 bytes [200 OK]>) to 10.0.27.72
2021-04-16 14:50:10.794876 (Thread-17): handling compile_sql request
2021-04-16 14:50:10.795232 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded41174c0>]}
2021-04-16 14:50:10.797506 (Thread-17): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-16 14:50:12.394542 (Thread-18): handling status request
2021-04-16 14:50:12.395167 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4137af0>]}
2021-04-16 14:50:12.396715 (Thread-18): sending response (<Response 10294 bytes [200 OK]>) to 10.0.37.128
2021-04-16 14:50:12.843895 (Thread-19): handling run_sql request
2021-04-16 14:50:12.845047 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded410bfa0>]}
2021-04-16 14:50:12.845581 (Thread-17): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.253
2021-04-16 14:50:12.858590 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-16 14:50:12.889690 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98753b37-3f24-40ca-83bc-d06b4f8f73bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed856a55e0>]}
2021-04-16 14:50:12.889980 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-16 14:50:12.890475 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-16 14:50:12.890584 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-16 14:50:12.898232 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-16 14:50:12.898328 (Thread-1): On rpc.folkefinans_dw.request: select distinct
rule.value:credit_rule_name_l::string
from
default_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-16 14:50:12.898386 (Thread-1): Opening a new connection, currently in state init
2021-04-16 14:50:13.413224 (Thread-20): handling poll request
2021-04-16 14:50:13.413605 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4137580>]}
2021-04-16 14:50:13.414684 (Thread-20): sending response (<Response 3110 bytes [200 OK]>) to 10.0.9.82
2021-04-16 14:50:14.051968 (Thread-1): Snowflake query id: 019ba09a-3200-85fb-0000-9c95001cb006
2021-04-16 14:50:14.052170 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database 'DEFAULT_RAW' does not exist or not authorized.
2021-04-16 14:50:14.053583 (Thread-1): finished collecting timing info
2021-04-16 14:50:14.053794 (Thread-1): On rpc.folkefinans_dw.request: Close
2021-04-16 14:50:14.169159 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Database 'DEFAULT_RAW' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database 'DEFAULT_RAW' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 14, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Database 'DEFAULT_RAW' does not exist or not authorized.
2021-04-16 14:50:14.171716 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Database 'DEFAULT_RAW' does not exist or not authorized.", 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Database 'DEFAULT_RAW' does not exist or not authorized.", 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2021-04-16 14:50:14.840665 (Thread-19): sending response (<Response 138 bytes [200 OK]>) to 10.0.17.76
2021-04-16 14:50:14.854828 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-16 14:50:14.867625 (Thread-21): handling poll request
2021-04-16 14:50:14.867910 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4137100>]}
2021-04-16 14:50:14.868693 (Thread-21): sending response (<Response 26797 bytes [200 OK]>) to 10.0.8.139
2021-04-16 14:50:14.881300 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4d1a46a-5798-4b0e-87eb-f1b1da246c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f90bf01f0>]}
2021-04-16 14:50:14.881602 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-16 14:50:14.882081 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-16 14:50:14.882196 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-16 14:50:14.889562 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-16 14:50:14.889662 (Thread-1): On rpc.folkefinans_dw.request: select distinct
rule.value:credit_rule_name_l::string
from
default_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-16 14:50:14.889721 (Thread-1): Opening a new connection, currently in state init
2021-04-16 14:50:15.350550 (Thread-22): handling poll request
2021-04-16 14:50:15.350878 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4123dc0>]}
2021-04-16 14:50:15.351652 (Thread-22): sending response (<Response 3106 bytes [200 OK]>) to 10.0.37.187
2021-04-16 14:50:15.795844 (Thread-1): Snowflake query id: 019ba09a-3200-85fb-0000-9c95001cb00a
2021-04-16 14:50:15.796049 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database 'DEFAULT_RAW' does not exist or not authorized.
2021-04-16 14:50:15.797410 (Thread-1): finished collecting timing info
2021-04-16 14:50:15.797616 (Thread-1): On rpc.folkefinans_dw.request: Close
2021-04-16 14:50:15.910257 (Thread-1): Got an exception: Database Error
  002003 (02000): SQL compilation error:
  Database 'DEFAULT_RAW' does not exist or not authorized.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database 'DEFAULT_RAW' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 14, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Database 'DEFAULT_RAW' does not exist or not authorized.
2021-04-16 14:50:15.913758 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Database 'DEFAULT_RAW' does not exist or not authorized.", 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002003 (02000): SQL compilation error:\n  Database 'DEFAULT_RAW' does not exist or not authorized.", 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2021-04-16 14:50:16.838017 (Thread-23): handling poll request
2021-04-16 14:50:16.838426 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4123a90>]}
2021-04-16 14:50:16.839294 (Thread-23): sending response (<Response 26793 bytes [200 OK]>) to 10.0.24.7
2021-04-16 14:51:49.764055 (Thread-24): handling status request
2021-04-16 14:51:49.764402 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded4123df0>]}
2021-04-16 14:51:49.765278 (Thread-24): sending response (<Response 10294 bytes [200 OK]>) to 10.0.8.139
2021-04-16 14:51:49.800244 (Thread-25): handling ps request
2021-04-16 14:51:49.800638 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '0b14ad9a-cde6-4676-b8f4-6515baf3a676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded41375b0>]}
2021-04-16 14:51:49.801259 (Thread-25): sending response (<Response 1142 bytes [200 OK]>) to 10.0.37.7
2021-04-19 06:44:45.539276 (MainThread): Running with dbt=0.19.1
2021-04-19 06:44:45.873079 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 06:44:45.880216 (MainThread): Tracking: tracking
2021-04-19 06:44:45.880422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d24bb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b5988910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b6a49940>]}
2021-04-19 06:44:45.880761 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 06:44:45.880999 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 06:44:45.881828 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 06:44:45.898203 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 06:44:45.904286 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 06:44:45.912009 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 06:44:45.916008 (Thread-1): Parsing macros/adapters.sql
2021-04-19 06:44:45.947403 (Thread-1): Parsing macros/catalog.sql
2021-04-19 06:44:45.949305 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 06:44:45.953017 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 06:44:45.954926 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 06:44:45.964411 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 06:44:45.966560 (Thread-1): Parsing macros/core.sql
2021-04-19 06:44:45.970310 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 06:44:45.978828 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 06:44:45.992380 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 06:44:45.994094 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 06:44:46.010953 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 06:44:46.041062 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 06:44:46.045769 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 06:44:46.051904 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 06:44:46.071825 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 06:44:46.078215 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 06:44:46.079971 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 06:44:46.085693 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 06:44:46.087252 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 06:44:46.088290 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 06:44:46.096721 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 06:44:46.097642 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 06:44:46.099224 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 06:44:46.101143 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 06:44:46.102622 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 06:44:46.105280 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 06:44:46.107108 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 06:44:46.108861 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 06:44:46.188414 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 06:44:46.204603 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 06:44:46.213061 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 06:44:46.423835 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '488b9eeb-4259-4e89-9a3b-f146e6ed7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b469fcd0>]}
2021-04-19 06:44:46.620961 (Thread-2): handling status request
2021-04-19 06:44:46.621289 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '488b9eeb-4259-4e89-9a3b-f146e6ed7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b46a63d0>]}
2021-04-19 06:44:46.622220 (Thread-2): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.56
2021-04-19 06:44:48.018700 (Thread-3): handling status request
2021-04-19 06:44:48.019016 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '488b9eeb-4259-4e89-9a3b-f146e6ed7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b59887c0>]}
2021-04-19 06:44:48.019854 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.56
2021-04-19 06:50:56.654567 (Thread-4): handling status request
2021-04-19 06:50:56.654843 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '488b9eeb-4259-4e89-9a3b-f146e6ed7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b485bfd0>]}
2021-04-19 06:50:56.655634 (Thread-4): sending response (<Response 10258 bytes [200 OK]>) to 10.0.35.53
2021-04-19 06:50:56.656603 (Thread-5): handling ps request
2021-04-19 06:50:56.656927 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '488b9eeb-4259-4e89-9a3b-f146e6ed7658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b59ed5b0>]}
2021-04-19 06:50:56.657309 (Thread-5): sending response (<Response 105 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:12:12.961293 (MainThread): Running with dbt=0.19.1
2021-04-19 07:12:13.296823 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:12:13.305702 (MainThread): Tracking: tracking
2021-04-19 07:12:13.306002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4011cb3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4006c6bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4005b8c6d0>]}
2021-04-19 07:12:13.306441 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 07:12:13.311867 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:12:13.312126 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:12:13.317932 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:12:13.323039 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:12:13.326024 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:12:13.328915 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:12:13.356495 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:12:13.358415 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:12:13.362098 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:12:13.364036 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:12:13.372740 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:12:13.374900 (Thread-1): Parsing macros/core.sql
2021-04-19 07:12:13.378618 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:12:13.387208 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:12:13.401070 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:12:13.402772 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:12:13.421017 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:12:13.457689 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:12:13.465528 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:12:13.475534 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:12:13.496221 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:12:13.502552 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:12:13.504336 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:12:13.510097 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:12:13.511665 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:12:13.512692 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:12:13.521154 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:12:13.522080 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:12:13.523712 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:12:13.525599 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:12:13.527075 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:12:13.529678 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:12:13.531506 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:12:13.533199 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:12:13.570848 (Thread-2): handling status request
2021-04-19 07:12:13.583090 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4004b56490>]}
2021-04-19 07:12:13.583768 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.20.12
2021-04-19 07:12:13.613155 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:12:13.627204 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:12:13.633415 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:12:13.833179 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40040b0d90>]}
2021-04-19 07:12:15.085354 (Thread-3): handling status request
2021-04-19 07:12:15.085641 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400420b880>]}
2021-04-19 07:12:15.086423 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:13:49.219956 (Thread-4): handling status request
2021-04-19 07:13:49.220230 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40042019a0>]}
2021-04-19 07:13:49.221097 (Thread-4): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:13:49.277336 (Thread-5): handling ps request
2021-04-19 07:13:49.277564 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4004212fa0>]}
2021-04-19 07:13:49.278032 (Thread-5): sending response (<Response 105 bytes [200 OK]>) to 10.0.27.247
2021-04-19 07:13:53.952729 (Thread-6): handling status request
2021-04-19 07:13:53.953016 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40041db250>]}
2021-04-19 07:13:53.953774 (Thread-6): sending response (<Response 10258 bytes [200 OK]>) to 10.0.20.12
2021-04-19 07:13:54.387986 (Thread-7): handling compile_sql request
2021-04-19 07:13:54.388283 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40041db850>]}
2021-04-19 07:13:54.390461 (Thread-7): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:13:56.241325 (Thread-7): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:13:56.253026 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:13:56.275444 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64ffc89c-bb9c-44eb-9318-ff78df70c032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c889305b0>]}
2021-04-19 07:13:56.275667 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:13:56.276036 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:13:56.276140 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-19 07:13:56.283515 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:13:56.283613 (Thread-1): On rpc.folkefinans_dw.request: select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:13:56.283727 (Thread-1): Opening a new connection, currently in state init
2021-04-19 07:13:56.621947 (Thread-8): handling poll request
2021-04-19 07:13:56.622256 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40041c8610>]}
2021-04-19 07:13:56.623195 (Thread-8): sending response (<Response 3104 bytes [200 OK]>) to 10.0.25.165
2021-04-19 07:13:57.122229 (Thread-1): Got an error when attempting to open a snowflake connection: '250001 (08001): Failed to connect to DB: if91078.eu-west-1.snowflakecomputing.com:443. Incorrect username or password was specified.'
2021-04-19 07:13:57.122455 (Thread-1): Error running SQL: select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:13:57.122505 (Thread-1): Rolling back transaction.
2021-04-19 07:13:57.123831 (Thread-1): finished collecting timing info
2021-04-19 07:13:57.124013 (Thread-1): On rpc.folkefinans_dw.request: No close available on handle
2021-04-19 07:13:57.124100 (Thread-1): Got an exception: Database Error
  250001 (08001): Failed to connect to DB: if91078.eu-west-1.snowflakecomputing.com:443. Incorrect username or password was specified.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 203, in open
    handle = snowflake.connector.connect(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/__init__.py", line 52, in Connect
    return SnowflakeConnection(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/connection.py", line 219, in __init__
    self.connect(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/connection.py", line 415, in connect
    self.__open_connection()
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/connection.py", line 612, in __open_connection
    self._authenticate(auth_instance)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/connection.py", line 841, in _authenticate
    self.__authenticate(self.__preprocess_auth_instance(auth_instance))
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/connection.py", line 859, in __authenticate
    self._session_parameters = auth.authenticate(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/auth.py", line 317, in authenticate
    Error.errorhandler_wrapper(
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 128, in errorhandler_wrapper
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.DatabaseError: 250001 (08001): Failed to connect to DB: if91078.eu-west-1.snowflakecomputing.com:443. Incorrect username or password was specified.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 14, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/usr/local/lib/python3.8/dist-packages/dbt/contracts/connection.py", line 81, in handle
    self._handle.resolve(self)
  File "/usr/local/lib/python3.8/dist-packages/dbt/contracts/connection.py", line 107, in resolve
    return self.opener(connection)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 231, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  250001 (08001): Failed to connect to DB: if91078.eu-west-1.snowflakecomputing.com:443. Incorrect username or password was specified.
2021-04-19 07:13:57.126495 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'FailedToConnectException', 'message': 'Database Error in rpc request (from remote system)\n  250001 (08001): Failed to connect to DB: if91078.eu-west-1.snowflakecomputing.com:443. Incorrect username or password was specified.', 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'FailedToConnectException', 'message': 'Database Error in rpc request (from remote system)\n  250001 (08001): Failed to connect to DB: if91078.eu-west-1.snowflakecomputing.com:443. Incorrect username or password was specified.', 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2021-04-19 07:13:58.107970 (Thread-9): handling poll request
2021-04-19 07:13:58.108237 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40041c8820>]}
2021-04-19 07:13:58.108946 (Thread-9): sending response (<Response 28490 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:15:24.100199 (Thread-10): handling status request
2021-04-19 07:15:24.100965 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40041ed100>]}
2021-04-19 07:15:24.101812 (Thread-10): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:15:24.179877 (Thread-11): handling ps request
2021-04-19 07:15:24.180150 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '23e2a57b-48f0-4cbb-8f2e-5d69911d35d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4004212730>]}
2021-04-19 07:15:24.180736 (Thread-11): sending response (<Response 627 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:15:31.510665 (MainThread): Running with dbt=0.19.1
2021-04-19 07:15:31.830572 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:15:31.837043 (MainThread): Tracking: tracking
2021-04-19 07:15:31.837243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bce1ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b7ed34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b7ed1c70>]}
2021-04-19 07:15:31.837557 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 07:15:31.837780 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:15:31.838655 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:15:31.848908 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:15:31.852747 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:15:31.855441 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:15:31.858172 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:15:31.888949 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:15:31.891828 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:15:31.897369 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:15:31.900364 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:15:31.913789 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:15:31.916865 (Thread-1): Parsing macros/core.sql
2021-04-19 07:15:31.922317 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:15:31.934695 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:15:31.951441 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:15:31.953122 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:15:31.970645 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:15:32.001779 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:15:32.006394 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:15:32.012337 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:15:32.031621 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:15:32.037722 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:15:32.039505 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:15:32.045824 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:15:32.047424 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:15:32.048466 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:15:32.056628 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:15:32.057531 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:15:32.059149 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:15:32.060991 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:15:32.062414 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:15:32.064946 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:15:32.066694 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:15:32.068391 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:15:32.142010 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:15:32.155751 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:15:32.161489 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:15:32.341537 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5b1fb20>]}
2021-04-19 07:15:33.141081 (Thread-2): handling status request
2021-04-19 07:15:33.141383 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5cf3970>]}
2021-04-19 07:15:33.142291 (Thread-2): sending response (<Response 10258 bytes [200 OK]>) to 10.0.27.247
2021-04-19 07:15:34.595028 (Thread-3): handling status request
2021-04-19 07:15:34.595333 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5cdaf10>]}
2021-04-19 07:15:34.596086 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:15:35.266367 (Thread-4): handling compile_sql request
2021-04-19 07:15:35.266646 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5c94e50>]}
2021-04-19 07:15:35.268863 (Thread-4): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:15:37.116158 (Thread-4): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:15:37.127636 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:15:37.150814 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f0d0a86-ebde-4a7d-b1cb-a30843e3c9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c1a731550>]}
2021-04-19 07:15:37.151032 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:15:37.151416 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:15:37.151515 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-19 07:15:37.157992 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:15:37.158061 (Thread-1): On rpc.folkefinans_dw.request: select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:15:37.158118 (Thread-1): Opening a new connection, currently in state init
2021-04-19 07:15:37.604293 (Thread-5): handling poll request
2021-04-19 07:15:37.604584 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5ca6820>]}
2021-04-19 07:15:37.605444 (Thread-5): sending response (<Response 3098 bytes [200 OK]>) to 10.0.25.165
2021-04-19 07:15:38.623933 (Thread-1): Snowflake query id: 019bafb3-3200-85dc-0000-9c95001cd02a
2021-04-19 07:15:38.624120 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-04-19 07:15:38.625390 (Thread-1): finished collecting timing info
2021-04-19 07:15:38.625594 (Thread-1): On rpc.folkefinans_dw.request: Close
2021-04-19 07:15:38.735369 (Thread-1): Got an exception: Database Error
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 45, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 14, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-04-19 07:15:38.737732 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.\n  ", 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.\n  ", 'raw_sql': "{% set credit_rules = get_credit_rules() %}\n\nwith\nsrc as (\n  select\n    json:id::string as loan_account_id,\n    json:loanName::string as loan_name,\n    json:loanAmount::string as loan_amount,\n    json:paymentMethod::string as payment_method,\n    json:accountHolderKey::string as account_holder_key,\n    json:accountHolderType::string as account_holder_type,\n    json:accountState::string as account_state,\n    json:accountSubState::string as account_sub_state,\n    json:creationDate::timestamp as created_ts,\n    json:approvedDate::timestamp as approved_ts,\n    json:closedDate::timestamp as closed_ts,\n    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,\n    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,\n    json:_application_information_l.application_type_l::string as application_type,\n    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,\n    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,\n    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,\n    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,\n    json:_application_information_l.ip_address_l::string as ap_ip_address,\n    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,\n    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,\n    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,\n    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,\n    json:_application_information_l.wealth_l::string as ap_wealth,\n    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,\n    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,\n    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,\n    json:_credit_rules_l as json_credit_rules,\n    last_modified_at::timestamp as last_modified_ts\n  from\n    {{ source('raw','loan_accounts') }}\n),\n\ncredit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    rule.value:credit_rule_name_l::string as credit_rule,\n    rule.value:credit_rule_decision_l::string as credit_rule_decision,\n    rule.value:_index::int as index,\n    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index\n  from\n    src,\n    lateral flatten(input => json_credit_rules) rule\n),\n\n{#- The order of the fields on the pivot table definition and on the   -#}\n{#- following credit rules CTEs matters. Fields must be referenced     -#}\n{#- in the same order throughout these CTEs.                           -#}\n{#- When making changes, keep the field ordering consistent.           -#}\n{#- Many instances of the same rule can exist due to the current       -#}\n{#- implementation logic. Hence, we are here filtering rules in order  -#}\n{#- to get only the latest result for each rule name.                  -#}\n\nfiltered_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    credit_rule,\n    credit_rule_decision\n  from\n    credit_rules\n  where\n    index = max_index\n),\n\npivot_credit_rules as (\n  select\n    loan_account_id,\n    last_modified_ts,\n    {% for rule_name in credit_rules -%}\n    nvl(cr_{{ camel_to_snake(rule_name) }}, 'N/A') as cr_{{ camel_to_snake(rule_name) }}\n    {%- if not loop.last %},{% endif %}\n    {% endfor -%}\n    from\n      filtered_rules\n    pivot (max(credit_rule_decision) for credit_rule in {{ credit_rules }})\n    as pv (loan_account_id,\n           last_modified_ts,\n           {% for rule_name in credit_rules -%}\n           cr_{{ camel_to_snake(rule_name) }}\n           {%- if not loop.last %},{% endif %}\n           {% endfor -%}\n       )\n)\n\nselect\n  src.loan_account_id,\n  src.loan_name,\n  src.loan_amount,\n  src.payment_method,\n  src.account_holder_key,\n  src.account_holder_type,\n  src.account_state,\n  src.account_sub_state,\n  src.created_ts,\n  src.approved_ts,\n  src.closed_ts,\n  src.disbursement_ts,\n  src.first_repayment_ts,\n  src.application_type,\n  src.previous_application_id,\n  src.original_application_id,\n  src.ap_data_processing_consent,\n  src.initial_application_amount,\n  src.ap_ip_address,\n  src.ap_monthly_living_cost,\n  src.ap_monthly_net_income,\n  src.ap_pep_acceptance,\n  src.ap_terms_acceptance,\n  src.ap_wealth,\n  src.arvato_account_id,\n  src.bisnode_rgs_pd,\n  src.bisnode_rgs_score,\n  {% for rule_name in credit_rules -%}\n  pv.cr_{{ camel_to_snake(rule_name) }},\n  {% endfor -%}\n  src.last_modified_ts\nfrom\n  src\njoin pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': None, 'tags': None}, None)
2021-04-19 07:15:39.061628 (Thread-6): handling poll request
2021-04-19 07:15:39.061897 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5c49af0>]}
2021-04-19 07:15:39.062574 (Thread-6): sending response (<Response 27027 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:17:39.783319 (Thread-7): handling ps request
2021-04-19 07:17:39.783576 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5ca6fd0>]}
2021-04-19 07:17:39.784132 (Thread-7): sending response (<Response 626 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:17:39.797919 (Thread-8): handling status request
2021-04-19 07:17:39.798139 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'cbb9341b-b834-44bb-a440-1bdd58d544bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29b5ca66d0>]}
2021-04-19 07:17:39.798888 (Thread-8): sending response (<Response 10258 bytes [200 OK]>) to 10.0.20.12
2021-04-19 07:17:48.466974 (MainThread): Running with dbt=0.19.1
2021-04-19 07:17:48.811432 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:17:48.818701 (MainThread): Tracking: tracking
2021-04-19 07:17:48.819066 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f303426ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302f6404f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302e5d1a90>]}
2021-04-19 07:17:48.824666 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 07:17:48.825001 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:17:48.825233 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:17:48.832438 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:17:48.836659 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:17:48.839878 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:17:48.842723 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:17:48.873075 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:17:48.875887 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:17:48.880994 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:17:48.883349 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:17:48.892318 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:17:48.894480 (Thread-1): Parsing macros/core.sql
2021-04-19 07:17:48.898181 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:17:48.906807 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:17:48.920422 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:17:48.922181 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:17:48.940299 (Thread-2): handling status request
2021-04-19 07:17:48.940501 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:17:48.940750 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302f63aee0>]}
2021-04-19 07:17:48.956994 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:17:48.972649 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:17:48.977574 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:17:48.983517 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:17:49.003126 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:17:49.011672 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:17:49.016061 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:17:49.029902 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:17:49.034086 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:17:49.047808 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:17:49.056467 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:17:49.057556 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:17:49.059166 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:17:49.061137 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:17:49.062604 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:17:49.065219 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:17:49.067081 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:17:49.068792 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:17:49.149785 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:17:49.166981 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:17:49.172968 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:17:49.343611 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cab2a60>]}
2021-04-19 07:17:50.363664 (Thread-3): handling status request
2021-04-19 07:17:50.363985 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cc13b20>]}
2021-04-19 07:17:50.364762 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:17:51.654183 (Thread-4): handling status request
2021-04-19 07:17:51.654444 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbff3d0>]}
2021-04-19 07:17:51.655148 (Thread-4): sending response (<Response 10258 bytes [200 OK]>) to 10.0.27.22
2021-04-19 07:17:52.101316 (Thread-5): handling compile_sql request
2021-04-19 07:17:52.101582 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cc240a0>]}
2021-04-19 07:17:52.104029 (Thread-5): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:17:53.975026 (Thread-5): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:17:53.986973 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:17:54.011518 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf2593f-9215-4ec9-bdd8-47ab498cd845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7af9b2c5b0>]}
2021-04-19 07:17:54.011788 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:17:54.012227 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:17:54.012337 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-19 07:17:54.019353 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:17:54.019434 (Thread-1): On rpc.folkefinans_dw.request: select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:17:54.019490 (Thread-1): Opening a new connection, currently in state init
2021-04-19 07:17:54.430216 (Thread-6): handling poll request
2021-04-19 07:17:54.430602 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbdd0d0>]}
2021-04-19 07:17:54.431812 (Thread-6): sending response (<Response 3098 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:17:55.879603 (Thread-7): handling poll request
2021-04-19 07:17:55.882388 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbdd640>]}
2021-04-19 07:17:55.882954 (Thread-7): sending response (<Response 407 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:17:56.746119 (Thread-1): SQL status: SUCCESS 13 in 2.73 seconds
2021-04-19 07:17:56.754737 (Thread-1): finished collecting timing info
2021-04-19 07:17:56.754935 (Thread-1): finished collecting timing info
2021-04-19 07:17:56.755039 (Thread-1): On rpc.folkefinans_dw.request: Close
2021-04-19 07:17:57.439904 (Thread-8): handling poll request
2021-04-19 07:17:57.440172 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbbf910>]}
2021-04-19 07:17:57.441127 (Thread-8): sending response (<Response 24943 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:18:48.563155 (Thread-9): handling status request
2021-04-19 07:18:48.564724 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ca49b80>]}
2021-04-19 07:18:48.565979 (Thread-9): sending response (<Response 10258 bytes [200 OK]>) to 10.0.17.36
2021-04-19 07:18:48.648655 (Thread-10): handling status request
2021-04-19 07:18:48.648854 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbc6430>]}
2021-04-19 07:18:48.649535 (Thread-10): sending response (<Response 10258 bytes [200 OK]>) to 10.0.9.201
2021-04-19 07:18:49.047111 (Thread-11): handling cli_args request
2021-04-19 07:18:49.047420 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbc67c0>]}
2021-04-19 07:18:50.888568 (Thread-11): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.15
2021-04-19 07:18:50.923171 (MainThread): Partial parsing not enabled
2021-04-19 07:18:50.926909 (MainThread): Parsing macros/get_custom_database.sql
2021-04-19 07:18:50.930979 (MainThread): Parsing macros/generate_schema_name.sql
2021-04-19 07:18:50.933792 (MainThread): Parsing macros/parse_credit_rules.sql
2021-04-19 07:18:50.936727 (MainThread): Parsing macros/adapters.sql
2021-04-19 07:18:50.964464 (MainThread): Parsing macros/catalog.sql
2021-04-19 07:18:50.966483 (MainThread): Parsing macros/materializations/table.sql
2021-04-19 07:18:50.970315 (MainThread): Parsing macros/materializations/merge.sql
2021-04-19 07:18:50.972357 (MainThread): Parsing macros/materializations/incremental.sql
2021-04-19 07:18:50.981213 (MainThread): Parsing macros/materializations/view.sql
2021-04-19 07:18:50.983436 (MainThread): Parsing macros/core.sql
2021-04-19 07:18:50.987193 (MainThread): Parsing macros/materializations/helpers.sql
2021-04-19 07:18:50.995886 (MainThread): Parsing macros/materializations/common/merge.sql
2021-04-19 07:18:51.009686 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:18:51.011545 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:18:51.028630 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:18:51.059387 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:18:51.064272 (MainThread): Parsing macros/materializations/view/view.sql
2021-04-19 07:18:51.070387 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:18:51.090384 (MainThread): Parsing macros/materializations/table/table.sql
2021-04-19 07:18:51.096918 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:18:51.098747 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:18:51.104638 (MainThread): Parsing macros/etc/is_incremental.sql
2021-04-19 07:18:51.106250 (MainThread): Parsing macros/etc/query.sql
2021-04-19 07:18:51.107500 (MainThread): Parsing macros/etc/datetime.sql
2021-04-19 07:18:51.116616 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:18:51.117628 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:18:51.119354 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:18:51.121345 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:18:51.122933 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:18:51.125660 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:18:51.127673 (MainThread): Parsing macros/schema_tests/unique.sql
2021-04-19 07:18:51.129514 (MainThread): Parsing macros/adapters/common.sql
2021-04-19 07:18:51.177445 (MainThread): Partial parsing not enabled
2021-04-19 07:18:51.209082 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:18:51.222776 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:18:51.228176 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:18:51.376243 (Thread-12): handling poll request
2021-04-19 07:18:51.376580 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302cbdd6d0>]}
2021-04-19 07:18:51.377703 (Thread-12): sending response (<Response 10516 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:18:51.400183 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67a9e728-84d5-47dd-90cb-3ba493a2f2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb6e68850>]}
2021-04-19 07:18:51.424429 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67a9e728-84d5-47dd-90cb-3ba493a2f2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb6cc2670>]}
2021-04-19 07:18:51.424652 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:18:51.425277 (MainThread): 
2021-04-19 07:18:51.425529 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:18:51.426374 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:18:51.432638 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:18:51.432708 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dev_dw"} */

    show terse schemas in database dbt_dev_dev_dw
    limit 10000
2021-04-19 07:18:51.432764 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-19 07:18:52.375273 (ThreadPoolExecutor-0_0): Snowflake query id: 019bafb6-3200-85dc-0000-9c95001cd03e
2021-04-19 07:18:52.375472 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-04-19 07:18:52.375642 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-04-19 07:18:52.375685 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-04-19 07:18:52.375827 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: Close
2021-04-19 07:18:52.488085 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:18:52.491332 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:18:52.491485 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dev_dw"} */

    show terse schemas in database dbt_dev_dev_dw
    limit 10000
2021-04-19 07:18:52.491591 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:18:52.940534 (Thread-13): handling poll request
2021-04-19 07:18:52.940798 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ca59910>]}
2021-04-19 07:18:52.941443 (Thread-13): sending response (<Response 6300 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:18:53.182789 (ThreadPoolExecutor-0_0): Snowflake query id: 019bafb6-3200-8714-0000-9c95001ce02a
2021-04-19 07:18:53.182911 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-04-19 07:18:53.183012 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-04-19 07:18:53.183056 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-04-19 07:18:53.183148 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: Close
2021-04-19 07:18:53.300735 (MainThread): Connection 'master' was properly closed.
2021-04-19 07:18:53.300837 (MainThread): Connection 'list_dbt_dev_dev_dw' was properly closed.
2021-04-19 07:18:53.300908 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/task_handler.py", line 94, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/cli.py", line 112, in handle_request
    return self.real_task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/project_commands.py", line 57, in handle_request
    return self.run()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dbt_dev_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-04-19 07:18:54.320541 (Thread-14): handling poll request
2021-04-19 07:18:54.320820 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ca06c70>]}
2021-04-19 07:18:54.321689 (Thread-14): sending response (<Response 25744 bytes [200 OK]>) to 10.0.25.165
2021-04-19 07:18:54.800570 (Thread-15): handling status request
2021-04-19 07:18:54.800846 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ca14640>]}
2021-04-19 07:18:54.801673 (Thread-15): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:21:09.206045 (Thread-16): handling ps request
2021-04-19 07:21:09.206315 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ca145e0>]}
2021-04-19 07:21:09.206919 (Thread-16): sending response (<Response 1028 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:21:09.236004 (Thread-17): handling status request
2021-04-19 07:21:09.236189 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '2795de25-291d-4898-b299-707813ecd20d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302ca14a60>]}
2021-04-19 07:21:09.236834 (Thread-17): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:21:16.727843 (MainThread): Running with dbt=0.19.1
2021-04-19 07:21:17.092214 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:21:17.100993 (MainThread): Tracking: tracking
2021-04-19 07:21:17.101191 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9aa6b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9aa644f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9aa64340>]}
2021-04-19 07:21:17.101490 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=16
2021-04-19 07:21:17.101769 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:21:17.102775 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:21:17.114467 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:21:17.119319 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:21:17.121978 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:21:17.124782 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:21:17.153777 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:21:17.155798 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:21:17.159922 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:21:17.161785 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:21:17.171250 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:21:17.174356 (Thread-1): Parsing macros/core.sql
2021-04-19 07:21:17.178228 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:21:17.186850 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:21:17.200377 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:21:17.202062 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:21:17.219016 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:21:17.248729 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:21:17.253386 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:21:17.259343 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:21:17.279033 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:21:17.285225 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:21:17.286918 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:21:17.293005 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:21:17.294490 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:21:17.295519 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:21:17.304055 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:21:17.305035 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:21:17.306798 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:21:17.308720 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:21:17.310176 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:21:17.312713 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:21:17.314466 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:21:17.316162 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:21:17.389911 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:21:17.402289 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:21:17.408017 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:21:17.595192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9869ed60>]}
2021-04-19 07:21:17.988303 (Thread-2): handling status request
2021-04-19 07:21:17.988629 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98808520>]}
2021-04-19 07:21:17.989674 (Thread-2): sending response (<Response 10258 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:21:21.638886 (Thread-3): handling status request
2021-04-19 07:21:21.640340 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9885bf70>]}
2021-04-19 07:21:21.641108 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:21:21.681019 (Thread-4): handling status request
2021-04-19 07:21:21.681252 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec988739d0>]}
2021-04-19 07:21:21.681912 (Thread-4): sending response (<Response 10258 bytes [200 OK]>) to 10.0.9.201
2021-04-19 07:21:22.142996 (Thread-5): handling cli_args request
2021-04-19 07:21:22.143386 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98869040>]}
2021-04-19 07:21:22.154090 (Thread-5): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:21:23.939839 (Thread-5): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:21:23.972035 (MainThread): Partial parsing not enabled
2021-04-19 07:21:23.975348 (MainThread): Parsing macros/get_custom_database.sql
2021-04-19 07:21:23.979275 (MainThread): Parsing macros/generate_schema_name.sql
2021-04-19 07:21:23.981989 (MainThread): Parsing macros/parse_credit_rules.sql
2021-04-19 07:21:23.984787 (MainThread): Parsing macros/adapters.sql
2021-04-19 07:21:24.011626 (MainThread): Parsing macros/catalog.sql
2021-04-19 07:21:24.013503 (MainThread): Parsing macros/materializations/table.sql
2021-04-19 07:21:24.017115 (MainThread): Parsing macros/materializations/merge.sql
2021-04-19 07:21:24.019037 (MainThread): Parsing macros/materializations/incremental.sql
2021-04-19 07:21:24.027604 (MainThread): Parsing macros/materializations/view.sql
2021-04-19 07:21:24.029821 (MainThread): Parsing macros/core.sql
2021-04-19 07:21:24.033419 (MainThread): Parsing macros/materializations/helpers.sql
2021-04-19 07:21:24.041815 (MainThread): Parsing macros/materializations/common/merge.sql
2021-04-19 07:21:24.054922 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:21:24.056626 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:21:24.073084 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:21:24.102353 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:21:24.106929 (MainThread): Parsing macros/materializations/view/view.sql
2021-04-19 07:21:24.112828 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:21:24.132764 (MainThread): Parsing macros/materializations/table/table.sql
2021-04-19 07:21:24.139015 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:21:24.140772 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:21:24.146357 (MainThread): Parsing macros/etc/is_incremental.sql
2021-04-19 07:21:24.147929 (MainThread): Parsing macros/etc/query.sql
2021-04-19 07:21:24.149015 (MainThread): Parsing macros/etc/datetime.sql
2021-04-19 07:21:24.157593 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:21:24.158574 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:21:24.160204 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:21:24.162054 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:21:24.163534 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:21:24.166044 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:21:24.167847 (MainThread): Parsing macros/schema_tests/unique.sql
2021-04-19 07:21:24.169635 (MainThread): Parsing macros/adapters/common.sql
2021-04-19 07:21:24.216614 (MainThread): Partial parsing not enabled
2021-04-19 07:21:24.244667 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:21:24.256234 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:21:24.261750 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:21:24.384574 (Thread-6): handling poll request
2021-04-19 07:21:24.384863 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec986787f0>]}
2021-04-19 07:21:24.385962 (Thread-6): sending response (<Response 10516 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:21:24.446734 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db747ec-1feb-4da0-ba26-97ba83031884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03adae63a0>]}
2021-04-19 07:21:24.476476 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db747ec-1feb-4da0-ba26-97ba83031884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ad943550>]}
2021-04-19 07:21:24.476712 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:21:24.477345 (MainThread): 
2021-04-19 07:21:24.477589 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:21:24.478541 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:21:24.485159 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:21:24.485231 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dev_dw"} */

    show terse schemas in database dbt_dev_dev_dw
    limit 10000
2021-04-19 07:21:24.485286 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-19 07:21:25.567838 (ThreadPoolExecutor-0_0): Snowflake query id: 019bafb9-3200-85dc-0000-9c95001cd042
2021-04-19 07:21:25.568019 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-04-19 07:21:25.568210 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-04-19 07:21:25.568255 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-04-19 07:21:25.568391 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: Close
2021-04-19 07:21:25.726550 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:21:25.728918 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dev_dw".
2021-04-19 07:21:25.729009 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dev_dw"} */

    show terse schemas in database dbt_dev_dev_dw
    limit 10000
2021-04-19 07:21:25.729075 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:21:25.875297 (Thread-7): handling poll request
2021-04-19 07:21:25.875545 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9860e0a0>]}
2021-04-19 07:21:25.876177 (Thread-7): sending response (<Response 6299 bytes [200 OK]>) to 10.0.9.201
2021-04-19 07:21:26.545571 (ThreadPoolExecutor-0_0): Snowflake query id: 019bafb9-3200-85d0-0000-9c95001cab36
2021-04-19 07:21:26.545692 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-04-19 07:21:26.545793 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-04-19 07:21:26.545835 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-04-19 07:21:26.545925 (ThreadPoolExecutor-0_0): On list_dbt_dev_dev_dw: Close
2021-04-19 07:21:26.660467 (MainThread): Connection 'master' was properly closed.
2021-04-19 07:21:26.660573 (MainThread): Connection 'list_dbt_dev_dev_dw' was properly closed.
2021-04-19 07:21:26.660636 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/task_handler.py", line 94, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/cli.py", line 112, in handle_request
    return self.real_task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/project_commands.py", line 57, in handle_request
    return self.run()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dbt_dev_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-04-19 07:21:27.291471 (Thread-8): handling poll request
2021-04-19 07:21:27.291780 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9860e4f0>]}
2021-04-19 07:21:27.292570 (Thread-8): sending response (<Response 25744 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:21:27.780214 (Thread-9): handling status request
2021-04-19 07:21:27.780483 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98646970>]}
2021-04-19 07:21:27.781296 (Thread-9): sending response (<Response 10258 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:24:20.872490 (Thread-10): handling status request
2021-04-19 07:24:20.872757 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98646ca0>]}
2021-04-19 07:24:20.873460 (Thread-10): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:24:20.884477 (Thread-11): handling ps request
2021-04-19 07:24:20.884680 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '21ad7970-0cf9-4158-af56-4f558a92823b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec98675070>]}
2021-04-19 07:24:20.885162 (Thread-11): sending response (<Response 505 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:24:28.929851 (MainThread): Running with dbt=0.19.1
2021-04-19 07:24:29.289189 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:24:29.296248 (MainThread): Tracking: tracking
2021-04-19 07:24:29.296461 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2725a08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26755bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26755ae50>]}
2021-04-19 07:24:29.296774 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 07:24:29.297001 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:24:29.297870 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:24:29.312653 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:24:29.319297 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:24:29.324461 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:24:29.328766 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:24:29.361418 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:24:29.363445 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:24:29.368370 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:24:29.370344 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:24:29.379267 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:24:29.381551 (Thread-1): Parsing macros/core.sql
2021-04-19 07:24:29.385373 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:24:29.394221 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:24:29.408432 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:24:29.410324 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:24:29.427802 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:24:29.458598 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:24:29.463529 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:24:29.469593 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:24:29.489901 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:24:29.496495 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:24:29.498294 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:24:29.504254 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:24:29.505845 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:24:29.506903 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:24:29.515706 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:24:29.516738 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:24:29.518447 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:24:29.520446 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:24:29.521964 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:24:29.524649 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:24:29.526494 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:24:29.528252 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:24:29.608642 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:24:29.620434 (Thread-2): handling status request
2021-04-19 07:24:29.620685 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26534e820>]}
2021-04-19 07:24:29.621252 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:24:29.625624 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:24:29.634613 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:24:29.814020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2649b38b0>]}
2021-04-19 07:24:31.175045 (Thread-3): handling status request
2021-04-19 07:24:31.175328 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264b12550>]}
2021-04-19 07:24:31.176132 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.15
2021-04-19 07:24:34.468552 (Thread-4): handling status request
2021-04-19 07:24:34.468839 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26535b9d0>]}
2021-04-19 07:24:34.469582 (Thread-4): sending response (<Response 10258 bytes [200 OK]>) to 10.0.27.22
2021-04-19 07:24:34.514339 (Thread-5): handling status request
2021-04-19 07:24:34.514545 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264b24160>]}
2021-04-19 07:24:34.515218 (Thread-5): sending response (<Response 10258 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:24:34.967265 (Thread-6): handling cli_args request
2021-04-19 07:24:34.967528 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264b244f0>]}
2021-04-19 07:24:34.978498 (Thread-6): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:24:36.854178 (Thread-6): sending response (<Response 138 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:24:36.888941 (MainThread): Partial parsing not enabled
2021-04-19 07:24:36.892772 (MainThread): Parsing macros/get_custom_database.sql
2021-04-19 07:24:36.897049 (MainThread): Parsing macros/generate_schema_name.sql
2021-04-19 07:24:36.899855 (MainThread): Parsing macros/parse_credit_rules.sql
2021-04-19 07:24:36.902704 (MainThread): Parsing macros/adapters.sql
2021-04-19 07:24:36.930322 (MainThread): Parsing macros/catalog.sql
2021-04-19 07:24:36.932299 (MainThread): Parsing macros/materializations/table.sql
2021-04-19 07:24:36.936057 (MainThread): Parsing macros/materializations/merge.sql
2021-04-19 07:24:36.938023 (MainThread): Parsing macros/materializations/incremental.sql
2021-04-19 07:24:36.946936 (MainThread): Parsing macros/materializations/view.sql
2021-04-19 07:24:36.949102 (MainThread): Parsing macros/core.sql
2021-04-19 07:24:36.952937 (MainThread): Parsing macros/materializations/helpers.sql
2021-04-19 07:24:36.961569 (MainThread): Parsing macros/materializations/common/merge.sql
2021-04-19 07:24:36.975363 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:24:36.977142 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:24:36.994204 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:24:37.025684 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:24:37.030580 (MainThread): Parsing macros/materializations/view/view.sql
2021-04-19 07:24:37.036686 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:24:37.056770 (MainThread): Parsing macros/materializations/table/table.sql
2021-04-19 07:24:37.063203 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:24:37.065037 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:24:37.070868 (MainThread): Parsing macros/etc/is_incremental.sql
2021-04-19 07:24:37.072608 (MainThread): Parsing macros/etc/query.sql
2021-04-19 07:24:37.073781 (MainThread): Parsing macros/etc/datetime.sql
2021-04-19 07:24:37.082862 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:24:37.083868 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:24:37.085573 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:24:37.087509 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:24:37.089072 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:24:37.091741 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:24:37.093713 (MainThread): Parsing macros/schema_tests/unique.sql
2021-04-19 07:24:37.095474 (MainThread): Parsing macros/adapters/common.sql
2021-04-19 07:24:37.144240 (MainThread): Partial parsing not enabled
2021-04-19 07:24:37.176419 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:24:37.189056 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:24:37.194787 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:24:37.288547 (Thread-7): handling poll request
2021-04-19 07:24:37.288816 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264ac9850>]}
2021-04-19 07:24:37.289955 (Thread-7): sending response (<Response 10516 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:24:37.370685 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17dc8eec-7b6c-49b5-9d86-a9c285ef8f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468eea6b20>]}
2021-04-19 07:24:37.400067 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17dc8eec-7b6c-49b5-9d86-a9c285ef8f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468ecc2640>]}
2021-04-19 07:24:37.400304 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:24:37.400969 (MainThread): 
2021-04-19 07:24:37.401221 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:24:37.402116 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:24:37.408625 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:24:37.408698 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:24:37.408755 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-19 07:24:38.626642 (ThreadPoolExecutor-0_0): Snowflake query id: 019bafbc-3200-85d0-0000-9c95001cab3a
2021-04-19 07:24:38.626838 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-04-19 07:24:38.627020 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-04-19 07:24:38.627064 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-04-19 07:24:38.627216 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:24:38.808859 (Thread-8): handling poll request
2021-04-19 07:24:38.809162 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2649488b0>]}
2021-04-19 07:24:38.809810 (Thread-8): sending response (<Response 4888 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:24:38.920837 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:24:38.923172 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:24:38.923274 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:24:38.923345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:24:39.991103 (ThreadPoolExecutor-0_0): Snowflake query id: 019bafbc-3200-85d0-0000-9c95001cab3e
2021-04-19 07:24:39.991232 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-04-19 07:24:39.991340 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-04-19 07:24:39.991384 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-04-19 07:24:39.991483 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:24:40.217722 (MainThread): Connection 'master' was properly closed.
2021-04-19 07:24:40.217845 (MainThread): Connection 'list_dbt_dev_dw' was properly closed.
2021-04-19 07:24:40.217921 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/task_handler.py", line 94, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/cli.py", line 112, in handle_request
    return self.real_task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/project_commands.py", line 57, in handle_request
    return self.run()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 409, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 515, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 492, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "dbt_dev_dw"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-04-19 07:24:40.235128 (Thread-9): handling poll request
2021-04-19 07:24:40.235426 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26497ae50>]}
2021-04-19 07:24:40.236075 (Thread-9): sending response (<Response 11763 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:24:41.661273 (Thread-10): handling poll request
2021-04-19 07:24:41.661558 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26497aeb0>]}
2021-04-19 07:24:41.662434 (Thread-10): sending response (<Response 25684 bytes [200 OK]>) to 10.0.25.165
2021-04-19 07:24:42.093736 (Thread-11): handling status request
2021-04-19 07:24:42.094016 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26491b3a0>]}
2021-04-19 07:24:42.095023 (Thread-11): sending response (<Response 10258 bytes [200 OK]>) to 10.0.25.165
2021-04-19 07:26:34.425681 (Thread-12): handling status request
2021-04-19 07:26:34.427508 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264ae6d90>]}
2021-04-19 07:26:34.428250 (Thread-12): sending response (<Response 10258 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:26:34.919124 (Thread-13): handling run_sql request
2021-04-19 07:26:34.919398 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2649777c0>]}
2021-04-19 07:26:36.828065 (Thread-13): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:26:36.842203 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:26:36.853332 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43905ad6-60d9-4036-8236-3926c4b9a8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35fb2720a0>]}
2021-04-19 07:26:36.853568 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:26:36.853936 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:26:36.854041 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-19 07:26:36.855020 (Thread-1): finished collecting timing info
2021-04-19 07:26:36.855400 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:26:36.855459 (Thread-1): On rpc.folkefinans_dw.request: limit 500
/* limit added automatically by dbt cloud */
2021-04-19 07:26:36.855514 (Thread-1): Opening a new connection, currently in state init
2021-04-19 07:26:37.222590 (Thread-14): handling poll request
2021-04-19 07:26:37.222887 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264925100>]}
2021-04-19 07:26:37.223784 (Thread-14): sending response (<Response 3345 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:26:38.083022 (Thread-1): Snowflake query id: 019bafbe-3200-85dc-0000-9c95001cd06e
2021-04-19 07:26:38.083222 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.
2021-04-19 07:26:38.083353 (Thread-1): finished collecting timing info
2021-04-19 07:26:38.083516 (Thread-1): On rpc.folkefinans_dw.request: Close
2021-04-19 07:26:38.190232 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'limit'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'limit'.
2021-04-19 07:26:38.191856 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 1 at position 0 unexpected 'limit'.", 'raw_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-04-19 07:26:38.612856 (Thread-15): handling poll request
2021-04-19 07:26:38.613149 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3fc91437-71ae-4343-96f3-53dce4181c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264925460>]}
2021-04-19 07:26:38.613775 (Thread-15): sending response (<Response 9252 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:26:56.963502 (MainThread): Running with dbt=0.19.1
2021-04-19 07:26:57.291558 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:26:57.294642 (MainThread): Tracking: tracking
2021-04-19 07:26:57.298532 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01971f75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a331d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01971f8250>]}
2021-04-19 07:26:57.298859 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 07:26:57.299114 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:26:57.299276 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:26:57.312184 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:26:57.316478 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:26:57.319056 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:26:57.321879 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:26:57.349326 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:26:57.351248 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:26:57.354940 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:26:57.356855 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:26:57.365764 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:26:57.367911 (Thread-1): Parsing macros/core.sql
2021-04-19 07:26:57.371688 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:26:57.380492 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:26:57.394116 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:26:57.395870 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:26:57.412715 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:26:57.443470 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:26:57.448259 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:26:57.454307 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:26:57.474224 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:26:57.480576 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:26:57.482388 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:26:57.488539 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:26:57.490199 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:26:57.491246 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:26:57.499803 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:26:57.500732 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:26:57.502359 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:26:57.504298 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:26:57.505908 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:26:57.508529 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:26:57.510386 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:26:57.512117 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:26:57.589247 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:26:57.602660 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:26:57.609094 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:26:57.662067 (Thread-2): handling status request
2021-04-19 07:26:57.662348 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195fcb6d0>]}
2021-04-19 07:26:57.662990 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:26:57.782716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019566ad90>]}
2021-04-19 07:26:59.127352 (Thread-3): handling status request
2021-04-19 07:26:59.127624 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01960376a0>]}
2021-04-19 07:26:59.128382 (Thread-3): sending response (<Response 10258 bytes [200 OK]>) to 10.0.35.53
2021-04-19 07:27:04.190747 (Thread-4): handling status request
2021-04-19 07:27:04.192389 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0196017d90>]}
2021-04-19 07:27:04.193175 (Thread-4): sending response (<Response 10258 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:27:04.579166 (Thread-5): handling compile_sql request
2021-04-19 07:27:04.579463 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195fd8ac0>]}
2021-04-19 07:27:04.581660 (Thread-5): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:27:06.410870 (Thread-5): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:27:06.424609 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:27:06.434175 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db29a146-0987-4c4c-bd78-c5b2f1ed01bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79cb9b11f0>]}
2021-04-19 07:27:06.434399 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:27:06.434740 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:27:06.434842 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-19 07:27:06.435920 (Thread-1): finished collecting timing info
2021-04-19 07:27:06.436040 (Thread-1): finished collecting timing info
2021-04-19 07:27:06.982383 (Thread-6): handling poll request
2021-04-19 07:27:06.982668 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01957988e0>]}
2021-04-19 07:27:06.983839 (Thread-6): sending response (<Response 4576 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:27:40.001397 (Thread-7): Got an acceptable cached parse result
2021-04-19 07:27:40.135229 (Thread-7): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195525f40>]}
2021-04-19 07:27:40.420902 (Thread-8): handling status request
2021-04-19 07:27:40.421228 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01971b6eb0>]}
2021-04-19 07:27:40.421777 (Thread-8): sending response (<Response 883 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:28:31.711160 (Thread-9): handling status request
2021-04-19 07:28:31.712929 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01af69b100>]}
2021-04-19 07:28:31.713455 (Thread-9): sending response (<Response 883 bytes [200 OK]>) to 10.0.27.247
2021-04-19 07:28:32.129528 (Thread-10): handling compile_sql request
2021-04-19 07:28:32.129803 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01971ee370>]}
2021-04-19 07:28:34.079607 (Thread-10): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.15
2021-04-19 07:28:34.092590 (MainThread): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:28:34.116677 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f7dec58-2085-4523-8fe9-f6a7c3c546a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7227b2f580>]}
2021-04-19 07:28:34.116967 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:28:34.117308 (Thread-1): Acquiring new snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:28:34.117423 (Thread-1): Compiling rpc.folkefinans_dw.request
2021-04-19 07:28:34.124715 (Thread-1): Using snowflake connection "rpc.folkefinans_dw.request".
2021-04-19 07:28:34.124806 (Thread-1): On rpc.folkefinans_dw.request: select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:28:34.124865 (Thread-1): Opening a new connection, currently in state init
2021-04-19 07:28:34.449378 (Thread-11): handling poll request
2021-04-19 07:28:34.449690 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195525100>]}
2021-04-19 07:28:34.450679 (Thread-11): sending response (<Response 3106 bytes [200 OK]>) to 10.0.17.36
2021-04-19 07:28:35.212871 (Thread-1): SQL status: SUCCESS 13 in 1.09 seconds
2021-04-19 07:28:35.221228 (Thread-1): finished collecting timing info
2021-04-19 07:28:35.221416 (Thread-1): finished collecting timing info
2021-04-19 07:28:35.221515 (Thread-1): On rpc.folkefinans_dw.request: Close
2021-04-19 07:28:35.929746 (Thread-12): handling poll request
2021-04-19 07:28:35.930021 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572b730>]}
2021-04-19 07:28:35.931031 (Thread-12): sending response (<Response 24938 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:28:59.360802 (Thread-13): handling status request
2021-04-19 07:28:59.361075 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572bbe0>]}
2021-04-19 07:28:59.361582 (Thread-13): sending response (<Response 883 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:28:59.383028 (Thread-14): handling status request
2021-04-19 07:28:59.383271 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572bb80>]}
2021-04-19 07:28:59.383677 (Thread-14): sending response (<Response 883 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:28:59.844326 (Thread-15): handling cli_args request
2021-04-19 07:28:59.844597 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572bac0>]}
2021-04-19 07:29:01.734122 (Thread-15): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:29:01.773953 (MainThread): Partial parsing not enabled
2021-04-19 07:29:01.777283 (MainThread): Parsing macros/get_custom_database.sql
2021-04-19 07:29:01.781209 (MainThread): Parsing macros/generate_schema_name.sql
2021-04-19 07:29:01.783796 (MainThread): Parsing macros/parse_credit_rules.sql
2021-04-19 07:29:01.786602 (MainThread): Parsing macros/adapters.sql
2021-04-19 07:29:01.813841 (MainThread): Parsing macros/catalog.sql
2021-04-19 07:29:01.815807 (MainThread): Parsing macros/materializations/table.sql
2021-04-19 07:29:01.819531 (MainThread): Parsing macros/materializations/merge.sql
2021-04-19 07:29:01.821470 (MainThread): Parsing macros/materializations/incremental.sql
2021-04-19 07:29:01.830172 (MainThread): Parsing macros/materializations/view.sql
2021-04-19 07:29:01.832312 (MainThread): Parsing macros/core.sql
2021-04-19 07:29:01.836058 (MainThread): Parsing macros/materializations/helpers.sql
2021-04-19 07:29:01.844570 (MainThread): Parsing macros/materializations/common/merge.sql
2021-04-19 07:29:01.858157 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:29:01.859916 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:29:01.876711 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:29:01.906929 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:29:01.911716 (MainThread): Parsing macros/materializations/view/view.sql
2021-04-19 07:29:01.917708 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:29:01.937431 (MainThread): Parsing macros/materializations/table/table.sql
2021-04-19 07:29:01.943829 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:29:01.945628 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:29:01.951373 (MainThread): Parsing macros/etc/is_incremental.sql
2021-04-19 07:29:01.952947 (MainThread): Parsing macros/etc/query.sql
2021-04-19 07:29:01.954017 (MainThread): Parsing macros/etc/datetime.sql
2021-04-19 07:29:01.962831 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:29:01.963841 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:29:01.965466 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:29:01.967392 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:29:01.968982 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:29:01.971665 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:29:01.973524 (MainThread): Parsing macros/schema_tests/unique.sql
2021-04-19 07:29:01.975272 (MainThread): Parsing macros/adapters/common.sql
2021-04-19 07:29:02.022623 (MainThread): Partial parsing not enabled
2021-04-19 07:29:02.052851 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:29:02.064513 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:29:02.069632 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:02.239465 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4df4bb8-1773-4af1-b80e-34b87e7217b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03b6e8400>]}
2021-04-19 07:29:02.272831 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4df4bb8-1773-4af1-b80e-34b87e7217b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03b544850>]}
2021-04-19 07:29:02.273086 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:29:02.273728 (MainThread): 
2021-04-19 07:29:02.273984 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:29:02.274859 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:29:02.281269 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:29:02.281343 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:29:02.281398 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-19 07:29:02.538700 (Thread-16): handling poll request
2021-04-19 07:29:02.539014 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0196017640>]}
2021-04-19 07:29:02.540526 (Thread-16): sending response (<Response 13683 bytes [200 OK]>) to 10.0.27.247
2021-04-19 07:29:03.299312 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.02 seconds
2021-04-19 07:29:03.302723 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:29:03.500416 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:29:03.502756 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:29:03.502845 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:29:03.502909 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:29:04.032535 (Thread-17): handling poll request
2021-04-19 07:29:04.032810 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572d7f0>]}
2021-04-19 07:29:04.033386 (Thread-17): sending response (<Response 2211 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:29:04.106712 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.60 seconds
2021-04-19 07:29:04.107402 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:29:04.320144 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:29:04.320360 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:29:04.320515 (ThreadPoolExecutor-0_0): Creating schema "dbt_dev_dw.dw_pres"
2021-04-19 07:29:04.324866 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:29:04.324944 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: BEGIN
2021-04-19 07:29:04.325000 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:29:05.209805 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.88 seconds
2021-04-19 07:29:05.209946 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:29:05.209997 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "create_dbt_dev_dw_dw_pres"} */
create schema if not exists dbt_dev_dw.dw_pres
2021-04-19 07:29:05.406096 (Thread-18): handling poll request
2021-04-19 07:29:05.406359 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195733610>]}
2021-04-19 07:29:05.406996 (Thread-18): sending response (<Response 3696 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:29:05.493461 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.28 seconds
2021-04-19 07:29:05.496306 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: COMMIT
2021-04-19 07:29:05.496447 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:29:05.496498 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: COMMIT
2021-04-19 07:29:05.689013 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.19 seconds
2021-04-19 07:29:05.689161 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: Close
2021-04-19 07:29:05.906601 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_dev".
2021-04-19 07:29:05.906811 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_dev".
2021-04-19 07:29:05.906929 (ThreadPoolExecutor-0_0): Creating schema "dbt_dev_dw.dw_dev"
2021-04-19 07:29:05.908294 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_dev".
2021-04-19 07:29:05.908366 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_dev: BEGIN
2021-04-19 07:29:05.908422 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:29:06.552608 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.64 seconds
2021-04-19 07:29:06.552754 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_dev".
2021-04-19 07:29:06.552806 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_dev: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "create_dbt_dev_dw_dw_dev"} */
create schema if not exists dbt_dev_dw.dw_dev
2021-04-19 07:29:06.778768 (Thread-19): handling poll request
2021-04-19 07:29:06.779038 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195603100>]}
2021-04-19 07:29:06.779709 (Thread-19): sending response (<Response 4846 bytes [200 OK]>) to 10.0.17.36
2021-04-19 07:29:08.208565 (Thread-20): handling poll request
2021-04-19 07:29:08.208853 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195798100>]}
2021-04-19 07:29:08.209380 (Thread-20): sending response (<Response 288 bytes [200 OK]>) to 10.0.7.15
2021-04-19 07:29:08.951855 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 2.40 seconds
2021-04-19 07:29:08.954983 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_dev: COMMIT
2021-04-19 07:29:08.955129 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_dev".
2021-04-19 07:29:08.955180 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_dev: COMMIT
2021-04-19 07:29:09.135034 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.18 seconds
2021-04-19 07:29:09.135206 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_dev: Close
2021-04-19 07:29:09.339328 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_dev_dw_dw_pres".
2021-04-19 07:29:09.346193 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_dev_dw_dw_pres".
2021-04-19 07:29:09.346295 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_pres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw_dw_pres"} */

    show terse objects in dbt_dev_dw.dw_pres
2021-04-19 07:29:09.346356 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-19 07:29:09.636393 (Thread-21): handling poll request
2021-04-19 07:29:09.636659 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019566ad90>]}
2021-04-19 07:29:09.637245 (Thread-21): sending response (<Response 3382 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:29:09.965328 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.62 seconds
2021-04-19 07:29:09.965793 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_pres: Close
2021-04-19 07:29:10.164309 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_dev_dw_dw_dev".
2021-04-19 07:29:10.165679 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_dev_dw_dw_dev".
2021-04-19 07:29:10.165753 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_dev: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw_dw_dev"} */

    show terse objects in dbt_dev_dw.dw_dev
2021-04-19 07:29:10.165810 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-19 07:29:10.758511 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.59 seconds
2021-04-19 07:29:10.758893 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_dev: Close
2021-04-19 07:29:10.943932 (MainThread): Using snowflake connection "master".
2021-04-19 07:29:10.944049 (MainThread): On master: BEGIN
2021-04-19 07:29:10.944113 (MainThread): Opening a new connection, currently in state init
2021-04-19 07:29:11.063338 (Thread-22): handling poll request
2021-04-19 07:29:11.063616 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01953bc6a0>]}
2021-04-19 07:29:11.064220 (Thread-22): sending response (<Response 3596 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:29:11.566500 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-04-19 07:29:11.566645 (MainThread): On master: COMMIT
2021-04-19 07:29:11.566749 (MainThread): Using snowflake connection "master".
2021-04-19 07:29:11.566796 (MainThread): On master: COMMIT
2021-04-19 07:29:11.824646 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-04-19 07:29:11.824827 (MainThread): On master: Close
2021-04-19 07:29:12.050456 (MainThread): 07:29:12 | Concurrency: 1 threads (target='dev')
2021-04-19 07:29:12.050596 (MainThread): 07:29:12 | 
2021-04-19 07:29:12.052118 (Thread-1): Began running node model.folkefinans_dw.base_loan_account
2021-04-19 07:29:12.052395 (Thread-1): 07:29:12 | 1 of 3 START view model dbt_dev_dw.dw_dev.base_loan_account.......... [RUN]
2021-04-19 07:29:12.052647 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:12.052742 (Thread-1): Compiling model.folkefinans_dw.base_loan_account
2021-04-19 07:29:12.060382 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:12.060483 (Thread-1): On model.folkefinans_dw.base_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.base_loan_account"} */

    
select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:29:12.060542 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:29:12.534354 (Thread-23): handling poll request
2021-04-19 07:29:12.534616 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0197162280>]}
2021-04-19 07:29:12.535296 (Thread-23): sending response (<Response 5639 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:29:12.785687 (Thread-1): SQL status: SUCCESS 13 in 0.73 seconds
2021-04-19 07:29:12.792469 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.base_loan_account"
2021-04-19 07:29:12.839536 (Thread-1): finished collecting timing info
2021-04-19 07:29:12.862256 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.base_loan_account"
2021-04-19 07:29:12.919545 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:12.919640 (Thread-1): On model.folkefinans_dw.base_loan_account: BEGIN
2021-04-19 07:29:13.064469 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-04-19 07:29:13.064603 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:13.064653 (Thread-1): On model.folkefinans_dw.base_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.base_loan_account"} */

  create or replace  view dbt_dev_dw.dw_dev.base_loan_account  as (
    

with
src as (
  select
    json:id::string as loan_account_id,
    json:loanName::string as loan_name,
    json:loanAmount::string as loan_amount,
    json:paymentMethod::string as payment_method,
    json:accountHolderKey::string as account_holder_key,
    json:accountHolderType::string as account_holder_type,
    json:accountState::string as account_state,
    json:accountSubState::string as account_sub_state,
    json:creationDate::timestamp as created_ts,
    json:approvedDate::timestamp as approved_ts,
    json:closedDate::timestamp as closed_ts,
    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,
    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,
    json:_application_information_l.application_type_l::string as application_type,
    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,
    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,
    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,
    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,
    json:_application_information_l.ip_address_l::string as ap_ip_address,
    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,
    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,
    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,
    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,
    json:_application_information_l.wealth_l::string as ap_wealth,
    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,
    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,
    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,
    json:_credit_rules_l as json_credit_rules,
    last_modified_at::timestamp as last_modified_ts
  from
    dev_raw.mambu.loan_accounts
),

credit_rules as (
  select
    loan_account_id,
    last_modified_ts,
    rule.value:credit_rule_name_l::string as credit_rule,
    rule.value:credit_rule_decision_l::string as credit_rule_decision,
    rule.value:_index::int as index,
    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index
  from
    src,
    lateral flatten(input => json_credit_rules) rule
),filtered_rules as (
  select
    loan_account_id,
    last_modified_ts,
    credit_rule,
    credit_rule_decision
  from
    credit_rules
  where
    index = max_index
),

pivot_credit_rules as (
  select
    loan_account_id,
    last_modified_ts,
    nvl(cr_affordability, 'N/A') as cr_affordability,
    nvl(cr_arvato_credit, 'N/A') as cr_arvato_credit,
    nvl(cr_arvato_limit_increase, 'N/A') as cr_arvato_limit_increase,
    nvl(cr_bisnode_aml_pep, 'N/A') as cr_bisnode_aml_pep,
    nvl(cr_bisnode_rgs_decision, 'N/A') as cr_bisnode_rgs_decision,
    nvl(cr_blocked_customer, 'N/A') as cr_blocked_customer,
    nvl(cr_credit_assessment, 'N/A') as cr_credit_assessment,
    nvl(cr_credit_check, 'N/A') as cr_credit_check,
    nvl(cr_customer_age, 'N/A') as cr_customer_age,
    nvl(cr_customer_debt, 'N/A') as cr_customer_debt,
    nvl(cr_customer_info_change, 'N/A') as cr_customer_info_change,
    nvl(cr_loan_multi_exposure, 'N/A') as cr_loan_multi_exposure,
    nvl(cr_money_laundering, 'N/A') as cr_money_laundering
    from
      filtered_rules
    pivot (max(credit_rule_decision) for credit_rule in ('Affordability', 'ArvatoCredit', 'ArvatoLimitIncrease', 'BisnodeAmlPep', 'BisnodeRGSDecision', 'BlockedCustomer', 'CreditAssessment', 'CreditCheck', 'CustomerAge', 'CustomerDebt', 'CustomerInfoChange', 'LoanMultiExposure', 'MoneyLaundering'))
    as pv (loan_account_id,
           last_modified_ts,
           cr_affordability,
           cr_arvato_credit,
           cr_arvato_limit_increase,
           cr_bisnode_aml_pep,
           cr_bisnode_rgs_decision,
           cr_blocked_customer,
           cr_credit_assessment,
           cr_credit_check,
           cr_customer_age,
           cr_customer_debt,
           cr_customer_info_change,
           cr_loan_multi_exposure,
           cr_money_laundering
           )
)

select
  src.loan_account_id,
  src.loan_name,
  src.loan_amount,
  src.payment_method,
  src.account_holder_key,
  src.account_holder_type,
  src.account_state,
  src.account_sub_state,
  src.created_ts,
  src.approved_ts,
  src.closed_ts,
  src.disbursement_ts,
  src.first_repayment_ts,
  src.application_type,
  src.previous_application_id,
  src.original_application_id,
  src.ap_data_processing_consent,
  src.initial_application_amount,
  src.ap_ip_address,
  src.ap_monthly_living_cost,
  src.ap_monthly_net_income,
  src.ap_pep_acceptance,
  src.ap_terms_acceptance,
  src.ap_wealth,
  src.arvato_account_id,
  src.bisnode_rgs_pd,
  src.bisnode_rgs_score,
  pv.cr_affordability,
  pv.cr_arvato_credit,
  pv.cr_arvato_limit_increase,
  pv.cr_bisnode_aml_pep,
  pv.cr_bisnode_rgs_decision,
  pv.cr_blocked_customer,
  pv.cr_credit_assessment,
  pv.cr_credit_check,
  pv.cr_customer_age,
  pv.cr_customer_debt,
  pv.cr_customer_info_change,
  pv.cr_loan_multi_exposure,
  pv.cr_money_laundering,
  src.last_modified_ts
from
  src
join pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)
  );
2021-04-19 07:29:13.483524 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-04-19 07:29:13.486170 (Thread-1): On model.folkefinans_dw.base_loan_account: COMMIT
2021-04-19 07:29:13.486317 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:13.486366 (Thread-1): On model.folkefinans_dw.base_loan_account: COMMIT
2021-04-19 07:29:13.612265 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-04-19 07:29:13.618544 (Thread-1): finished collecting timing info
2021-04-19 07:29:13.618676 (Thread-1): On model.folkefinans_dw.base_loan_account: Close
2021-04-19 07:29:13.809585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4df4bb8-1773-4af1-b80e-34b87e7217b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03b601cd0>]}
2021-04-19 07:29:13.809976 (Thread-1): 07:29:13 | 1 of 3 OK created view model dbt_dev_dw.dw_dev.base_loan_account..... [SUCCESS 1 in 1.76s]
2021-04-19 07:29:13.810062 (Thread-1): Finished running node model.folkefinans_dw.base_loan_account
2021-04-19 07:29:13.810920 (Thread-1): Began running node model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:29:13.811066 (Thread-1): 07:29:13 | 2 of 3 START view model dbt_dev_dw.dw_dev.stg_current_loan_account... [RUN]
2021-04-19 07:29:13.811295 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:29:13.811367 (Thread-1): Compiling model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:29:13.814395 (Thread-1): finished collecting timing info
2021-04-19 07:29:13.814655 (Thread-1): Compilation Error in model stg_current_loan_account (models/mambu/staging/stg_current_loan_account.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 12, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model stg_current_loan_account (models/mambu/staging/stg_current_loan_account.sql)
  'dbt_utils' is undefined
2021-04-19 07:29:13.815975 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4df4bb8-1773-4af1-b80e-34b87e7217b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff03a27b310>]}
2021-04-19 07:29:13.816198 (Thread-1): 07:29:13 | 2 of 3 ERROR creating view model dbt_dev_dw.dw_dev.stg_current_loan_account [ERROR in 0.00s]
2021-04-19 07:29:13.816265 (Thread-1): Finished running node model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:29:13.816831 (Thread-1): Began running node model.folkefinans_dw.dwd_loan_account
2021-04-19 07:29:13.816918 (Thread-1): 07:29:13 | 3 of 3 SKIP relation dw_pres.dwd_loan_account........................ [SKIP]
2021-04-19 07:29:13.816975 (Thread-1): Finished running node model.folkefinans_dw.dwd_loan_account
2021-04-19 07:29:13.818161 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:29:13.818335 (MainThread): Using snowflake connection "master".
2021-04-19 07:29:13.818386 (MainThread): On master: BEGIN
2021-04-19 07:29:13.818439 (MainThread): Opening a new connection, currently in state closed
2021-04-19 07:29:13.967797 (Thread-24): handling poll request
2021-04-19 07:29:13.968073 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195678370>]}
2021-04-19 07:29:13.968992 (Thread-24): sending response (<Response 22619 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:29:14.883920 (MainThread): SQL status: SUCCESS 1 in 1.07 seconds
2021-04-19 07:29:14.884088 (MainThread): On master: COMMIT
2021-04-19 07:29:14.884200 (MainThread): Using snowflake connection "master".
2021-04-19 07:29:14.884250 (MainThread): On master: COMMIT
2021-04-19 07:29:15.905087 (Thread-25): handling poll request
2021-04-19 07:29:15.905370 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01956783d0>]}
2021-04-19 07:29:15.905939 (Thread-25): sending response (<Response 1332 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:29:16.233922 (MainThread): SQL status: SUCCESS 1 in 1.35 seconds
2021-04-19 07:29:16.234089 (MainThread): On master: Close
2021-04-19 07:29:16.557495 (MainThread): 07:29:16 | 
2021-04-19 07:29:16.557625 (MainThread): 07:29:16 | Finished running 3 view models in 14.28s.
2021-04-19 07:29:16.557684 (MainThread): Connection 'master' was properly closed.
2021-04-19 07:29:16.557727 (MainThread): Connection 'model.folkefinans_dw.stg_current_loan_account' was properly closed.
2021-04-19 07:29:16.600799 (MainThread): 
2021-04-19 07:29:16.600909 (MainThread): Completed with 1 error and 0 warnings:
2021-04-19 07:29:16.600963 (MainThread): 
2021-04-19 07:29:16.601014 (MainThread): Compilation Error in model stg_current_loan_account (models/mambu/staging/stg_current_loan_account.sql)
2021-04-19 07:29:16.601056 (MainThread):   'dbt_utils' is undefined
2021-04-19 07:29:16.601106 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-04-19 07:29:17.347985 (Thread-26): handling poll request
2021-04-19 07:29:17.348265 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195603160>]}
2021-04-19 07:29:17.349618 (Thread-26): sending response (<Response 28973 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:29:17.771398 (Thread-27): handling status request
2021-04-19 07:29:17.771673 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01956035b0>]}
2021-04-19 07:29:17.772210 (Thread-27): sending response (<Response 883 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:29:34.187151 (Thread-28): handling status request
2021-04-19 07:29:34.187479 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572d7c0>]}
2021-04-19 07:29:34.188024 (Thread-28): sending response (<Response 883 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:29:34.189014 (Thread-29): handling status request
2021-04-19 07:29:34.189294 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0195678640>]}
2021-04-19 07:29:34.348365 (Thread-29): sending response (<Response 883 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:29:34.803905 (Thread-30): handling deps request
2021-04-19 07:29:34.804195 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019572b9a0>]}
2021-04-19 07:29:34.842764 (Thread-30): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.56
2021-04-19 07:29:35.280459 (Thread-31): handling poll request
2021-04-19 07:29:35.280775 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194f062b0>]}
2021-04-19 07:29:35.281617 (Thread-31): sending response (<Response 288 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:29:36.689886 (MainThread): Set downloads directory='/tmp/dbt-downloads-kxlwobp1'
2021-04-19 07:29:36.690354 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-04-19 07:29:36.699255 (Thread-32): handling poll request
2021-04-19 07:29:36.699532 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194f69400>]}
2021-04-19 07:29:36.700102 (Thread-32): sending response (<Response 926 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:29:37.018327 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.018573 (MainThread): STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
2021-04-19 07:29:37.018907 (MainThread): Pulling new dependency 859fd0fa21176efee375a447937f7a46.
2021-04-19 07:29:37.018969 (MainThread): Executing "git rev-parse HEAD"
2021-04-19 07:29:37.024505 (MainThread): STDOUT: "b'489a44bb7ebad1a6d9ba762fdcd7dc6a9fea7e0d\n'"
2021-04-19 07:29:37.024703 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.024776 (MainThread):   Checking out branch 0.6.4.
2021-04-19 07:29:37.024819 (MainThread): Executing "git remote set-branches origin 0.6.4"
2021-04-19 07:29:37.029746 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.029931 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.029990 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.4"
2021-04-19 07:29:37.335185 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.335426 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.4      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n'"
2021-04-19 07:29:37.335495 (MainThread): Executing "git tag --list"
2021-04-19 07:29:37.341454 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n'"
2021-04-19 07:29:37.341661 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.341745 (MainThread): Executing "git reset --hard tags/0.6.4"
2021-04-19 07:29:37.352715 (MainThread): STDOUT: "b'HEAD is now at bbba960 Update CHANGELOG.md\n'"
2021-04-19 07:29:37.352917 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.352998 (MainThread): Executing "git rev-parse HEAD"
2021-04-19 07:29:37.356971 (MainThread): STDOUT: "b'bbba960726667abc66b42624f0d36bbb62c37593\n'"
2021-04-19 07:29:37.357247 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.357359 (MainThread):   Checked out at bbba960.
2021-04-19 07:29:37.379604 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-04-19 07:29:37.383907 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.384105 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-04-19 07:29:37.384150 (MainThread): command return code=128
2021-04-19 07:29:37.384513 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-04-19 07:29:37.384579 (MainThread): Executing "git rev-parse HEAD"
2021-04-19 07:29:37.429680 (MainThread): STDOUT: "b'bbba960726667abc66b42624f0d36bbb62c37593\n'"
2021-04-19 07:29:37.429870 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.429944 (MainThread):   Checking out branch 0.6.4.
2021-04-19 07:29:37.429985 (MainThread): Executing "git remote set-branches origin 0.6.4"
2021-04-19 07:29:37.434682 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.434846 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.434907 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.4"
2021-04-19 07:29:37.688621 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.688864 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.4      -> FETCH_HEAD\n'"
2021-04-19 07:29:37.688941 (MainThread): Executing "git tag --list"
2021-04-19 07:29:37.694742 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n'"
2021-04-19 07:29:37.694919 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.694996 (MainThread): Executing "git reset --hard tags/0.6.4"
2021-04-19 07:29:37.704839 (MainThread): STDOUT: "b'HEAD is now at bbba960 Update CHANGELOG.md\n'"
2021-04-19 07:29:37.705001 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.705074 (MainThread): Executing "git rev-parse HEAD"
2021-04-19 07:29:37.708665 (MainThread): STDOUT: "b'bbba960726667abc66b42624f0d36bbb62c37593\n'"
2021-04-19 07:29:37.708857 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.708927 (MainThread):   Already at bbba960, nothing to do.
2021-04-19 07:29:37.716468 (MainThread): Installing https://github.com/fishtown-analytics/dbt-utils.git@0.6.4
2021-04-19 07:29:37.720182 (MainThread): Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
2021-04-19 07:29:37.723429 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.723613 (MainThread): STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
2021-04-19 07:29:37.723655 (MainThread): command return code=128
2021-04-19 07:29:37.723770 (MainThread): Updating existing dependency 859fd0fa21176efee375a447937f7a46.
2021-04-19 07:29:37.723824 (MainThread): Executing "git rev-parse HEAD"
2021-04-19 07:29:37.727515 (MainThread): STDOUT: "b'bbba960726667abc66b42624f0d36bbb62c37593\n'"
2021-04-19 07:29:37.727700 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.727771 (MainThread):   Checking out branch 0.6.4.
2021-04-19 07:29:37.727812 (MainThread): Executing "git remote set-branches origin 0.6.4"
2021-04-19 07:29:37.731968 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.732120 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.732176 (MainThread): Executing "git fetch --tags --depth 1 origin 0.6.4"
2021-04-19 07:29:37.980295 (MainThread): STDOUT: "b''"
2021-04-19 07:29:37.980493 (MainThread): STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.6.4      -> FETCH_HEAD\n'"
2021-04-19 07:29:37.980561 (MainThread): Executing "git tag --list"
2021-04-19 07:29:37.986076 (MainThread): STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n'"
2021-04-19 07:29:37.986284 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.986367 (MainThread): Executing "git reset --hard tags/0.6.4"
2021-04-19 07:29:37.996489 (MainThread): STDOUT: "b'HEAD is now at bbba960 Update CHANGELOG.md\n'"
2021-04-19 07:29:37.996686 (MainThread): STDERR: "b''"
2021-04-19 07:29:37.996767 (MainThread): Executing "git rev-parse HEAD"
2021-04-19 07:29:38.000573 (MainThread): STDOUT: "b'bbba960726667abc66b42624f0d36bbb62c37593\n'"
2021-04-19 07:29:38.000757 (MainThread): STDERR: "b''"
2021-04-19 07:29:38.000825 (MainThread):   Already at bbba960, nothing to do.
2021-04-19 07:29:38.246381 (Thread-33): handling poll request
2021-04-19 07:29:38.246631 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194f71940>]}
2021-04-19 07:29:38.247884 (Thread-33): sending response (<Response 23571 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:29:39.893153 (Thread-34): handling poll request
2021-04-19 07:29:39.893458 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194f71670>]}
2021-04-19 07:29:39.893973 (Thread-34): sending response (<Response 289 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:29:41.376641 (Thread-35): handling poll request
2021-04-19 07:29:41.376941 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194f69c10>]}
2021-04-19 07:29:41.377475 (Thread-35): sending response (<Response 289 bytes [200 OK]>) to 10.0.7.15
2021-04-19 07:29:42.806587 (Thread-36): handling poll request
2021-04-19 07:29:42.806902 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194f65fa0>]}
2021-04-19 07:29:42.807503 (Thread-36): sending response (<Response 289 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:29:43.923048 (MainThread):   Installed from revision 0.6.4

2021-04-19 07:29:43.923421 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e5940a4-7db9-4df5-ae4c-bec5e6f6f70b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e39228c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e39228af0>]}
2021-04-19 07:29:44.174399 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): project hash mismatch: values missing, cache invalidated: {'dbt_utils'}
2021-04-19 07:29:44.178285 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/get_custom_database.sql
2021-04-19 07:29:44.182435 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/generate_schema_name.sql
2021-04-19 07:29:44.185286 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/parse_credit_rules.sql
2021-04-19 07:29:44.188467 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/adapters.sql
2021-04-19 07:29:44.222636 (Thread-37): handling poll request
2021-04-19 07:29:44.222991 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194ecbbb0>]}
2021-04-19 07:29:44.223655 (Thread-37): sending response (<Response 1098 bytes [200 OK]>) to 10.0.9.201
2021-04-19 07:29:44.224201 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/catalog.sql
2021-04-19 07:29:44.226351 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/table.sql
2021-04-19 07:29:44.230646 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/merge.sql
2021-04-19 07:29:44.233583 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/incremental.sql
2021-04-19 07:29:44.246977 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/view.sql
2021-04-19 07:29:44.249122 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/core.sql
2021-04-19 07:29:44.253163 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/helpers.sql
2021-04-19 07:29:44.262101 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/common/merge.sql
2021-04-19 07:29:44.276376 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:29:44.278154 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:29:44.295022 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:29:44.326243 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:29:44.331126 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/view/view.sql
2021-04-19 07:29:44.337446 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:29:44.359283 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/table/table.sql
2021-04-19 07:29:44.366666 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:29:44.368775 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:29:44.374583 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/etc/is_incremental.sql
2021-04-19 07:29:44.376164 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/etc/query.sql
2021-04-19 07:29:44.377199 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/etc/datetime.sql
2021-04-19 07:29:44.385596 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:29:44.386514 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:29:44.388132 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:29:44.390034 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:29:44.391526 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:29:44.394273 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:29:44.396125 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/unique.sql
2021-04-19 07:29:44.397809 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/adapters/common.sql
2021-04-19 07:29:44.482102 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/logger/pretty_time.sql
2021-04-19 07:29:44.486584 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/logger/log_info.sql
2021-04-19 07:29:44.490702 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/logger/pretty_log_format.sql
2021-04-19 07:29:44.494879 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/pivot.sql
2021-04-19 07:29:44.501852 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/star.sql
2021-04-19 07:29:44.508347 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/surrogate_key.sql
2021-04-19 07:29:44.516715 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/get_query_results_as_dict.sql
2021-04-19 07:29:44.523048 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/get_column_values.sql
2021-04-19 07:29:44.532191 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/groupby.sql
2021-04-19 07:29:44.536570 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-04-19 07:29:44.546142 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/nullcheck_table.sql
2021-04-19 07:29:44.550911 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-04-19 07:29:44.555973 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/get_relations_by_pattern.sql
2021-04-19 07:29:44.562461 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/get_relations_by_prefix.sql
2021-04-19 07:29:44.568936 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/safe_add.sql
2021-04-19 07:29:44.573877 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/unpivot.sql
2021-04-19 07:29:44.584213 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/generate_series.sql
2021-04-19 07:29:44.592283 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/nullcheck.sql
2021-04-19 07:29:44.597389 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/sql/union.sql
2021-04-19 07:29:44.609645 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/materializations/insert_by_period_materialization.sql
2021-04-19 07:29:44.639180 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/web/get_url_parameter.sql
2021-04-19 07:29:44.643613 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/web/get_url_path.sql
2021-04-19 07:29:44.649224 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/web/get_url_host.sql
2021-04-19 07:29:44.654536 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/datetime/date_spine.sql
2021-04-19 07:29:44.662371 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/expression_is_true.sql
2021-04-19 07:29:44.666964 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/not_constant.sql
2021-04-19 07:29:44.671830 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/at_least_one.sql
2021-04-19 07:29:44.676282 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/equality.sql
2021-04-19 07:29:44.683788 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/test_not_null_where.sql
2021-04-19 07:29:44.688385 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/equal_rowcount.sql
2021-04-19 07:29:44.693133 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/test_unique_where.sql
2021-04-19 07:29:44.698858 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-04-19 07:29:44.708300 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/relationships_where.sql
2021-04-19 07:29:44.714529 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-04-19 07:29:44.721216 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/recency.sql
2021-04-19 07:29:44.726512 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/schema_tests/cardinality_equality.sql
2021-04-19 07:29:44.731653 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/geo/haversine_distance.sql
2021-04-19 07:29:44.736428 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/split_part.sql
2021-04-19 07:29:44.861499 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/length.sql
2021-04-19 07:29:44.866368 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/current_timestamp.sql
2021-04-19 07:29:44.872403 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-04-19 07:29:44.876512 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/right.sql
2021-04-19 07:29:44.881887 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/hash.sql
2021-04-19 07:29:44.886624 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/replace.sql
2021-04-19 07:29:44.891068 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/concat.sql
2021-04-19 07:29:44.896138 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/_is_relation.sql
2021-04-19 07:29:44.899968 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/identifier.sql
2021-04-19 07:29:44.904543 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/datediff.sql
2021-04-19 07:29:44.916882 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/dateadd.sql
2021-04-19 07:29:44.922175 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/datatypes.sql
2021-04-19 07:29:44.931904 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/position.sql
2021-04-19 07:29:44.936361 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/literal.sql
2021-04-19 07:29:44.940762 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-04-19 07:29:44.946429 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/width_bucket.sql
2021-04-19 07:29:44.955331 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/date_trunc.sql
2021-04-19 07:29:44.959668 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/except.sql
2021-04-19 07:29:44.963570 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/safe_cast.sql
2021-04-19 07:29:44.969285 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/last_day.sql
2021-04-19 07:29:44.975591 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Parsing macros/cross_db_utils/intersect.sql
2021-04-19 07:29:44.988571 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): project hash mismatch: values missing, cache invalidated: {'dbt_utils'}
2021-04-19 07:29:45.017562 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:29:45.039025 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:29:45.063255 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:45.284854 (af942c3f-ec50-4c33-a99c-739f6646f3a9-handler-deps): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194cabaf0>]}
2021-04-19 07:29:45.626647 (Thread-38): handling poll request
2021-04-19 07:29:45.626936 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01954272e0>]}
2021-04-19 07:29:45.627512 (Thread-38): sending response (<Response 362 bytes [200 OK]>) to 10.0.7.15
2021-04-19 07:29:46.160516 (Thread-39): handling status request
2021-04-19 07:29:46.160807 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01957b0850>]}
2021-04-19 07:29:46.161929 (Thread-39): sending response (<Response 24913 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:29:56.240528 (Thread-40): handling status request
2021-04-19 07:29:56.241037 (Thread-41): handling status request
2021-04-19 07:29:56.241339 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01960506a0>]}
2021-04-19 07:29:56.241572 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0196065130>]}
2021-04-19 07:29:56.242659 (Thread-40): sending response (<Response 24913 bytes [200 OK]>) to 10.0.7.14
2021-04-19 07:29:56.243763 (Thread-41): sending response (<Response 24913 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:29:56.655285 (Thread-42): handling cli_args request
2021-04-19 07:29:56.655561 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01960503a0>]}
2021-04-19 07:29:56.665506 (Thread-42): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:29:58.507539 (Thread-42): sending response (<Response 138 bytes [200 OK]>) to 10.0.27.22
2021-04-19 07:29:58.552946 (MainThread): Partial parsing not enabled
2021-04-19 07:29:58.556598 (MainThread): Parsing macros/get_custom_database.sql
2021-04-19 07:29:58.560885 (MainThread): Parsing macros/generate_schema_name.sql
2021-04-19 07:29:58.563853 (MainThread): Parsing macros/parse_credit_rules.sql
2021-04-19 07:29:58.566658 (MainThread): Parsing macros/adapters.sql
2021-04-19 07:29:58.594058 (MainThread): Parsing macros/catalog.sql
2021-04-19 07:29:58.596023 (MainThread): Parsing macros/materializations/table.sql
2021-04-19 07:29:58.599791 (MainThread): Parsing macros/materializations/merge.sql
2021-04-19 07:29:58.601720 (MainThread): Parsing macros/materializations/incremental.sql
2021-04-19 07:29:58.610929 (MainThread): Parsing macros/materializations/view.sql
2021-04-19 07:29:58.613050 (MainThread): Parsing macros/core.sql
2021-04-19 07:29:58.616797 (MainThread): Parsing macros/materializations/helpers.sql
2021-04-19 07:29:58.625361 (MainThread): Parsing macros/materializations/common/merge.sql
2021-04-19 07:29:58.638889 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:29:58.640677 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:29:58.657561 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:29:58.687980 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:29:58.692742 (MainThread): Parsing macros/materializations/view/view.sql
2021-04-19 07:29:58.698669 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:29:58.718314 (MainThread): Parsing macros/materializations/table/table.sql
2021-04-19 07:29:58.724687 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:29:58.726467 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:29:58.732197 (MainThread): Parsing macros/etc/is_incremental.sql
2021-04-19 07:29:58.733776 (MainThread): Parsing macros/etc/query.sql
2021-04-19 07:29:58.734835 (MainThread): Parsing macros/etc/datetime.sql
2021-04-19 07:29:58.743325 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:29:58.744321 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:29:58.745952 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:29:58.747879 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:29:58.749376 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:29:58.752013 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:29:58.753863 (MainThread): Parsing macros/schema_tests/unique.sql
2021-04-19 07:29:58.755605 (MainThread): Parsing macros/adapters/common.sql
2021-04-19 07:29:58.811649 (MainThread): Parsing macros/logger/pretty_time.sql
2021-04-19 07:29:58.815676 (MainThread): Parsing macros/logger/log_info.sql
2021-04-19 07:29:58.819016 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-04-19 07:29:58.821927 (MainThread): Parsing macros/sql/pivot.sql
2021-04-19 07:29:58.827667 (MainThread): Parsing macros/sql/star.sql
2021-04-19 07:29:58.833729 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-04-19 07:29:58.839256 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-04-19 07:29:58.843274 (MainThread): Parsing macros/sql/get_column_values.sql
2021-04-19 07:29:58.849665 (MainThread): Parsing macros/sql/groupby.sql
2021-04-19 07:29:58.852823 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-04-19 07:29:58.860966 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-04-19 07:29:58.864697 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-04-19 07:29:58.868712 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-04-19 07:29:58.873702 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-04-19 07:29:58.878863 (MainThread): Parsing macros/sql/safe_add.sql
2021-04-19 07:29:58.882305 (MainThread): Parsing macros/sql/unpivot.sql
2021-04-19 07:29:58.891444 (MainThread): Parsing macros/sql/generate_series.sql
2021-04-19 07:29:58.897783 (MainThread): Parsing macros/sql/nullcheck.sql
2021-04-19 07:29:58.901564 (MainThread): Parsing macros/sql/union.sql
2021-04-19 07:29:58.911899 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-04-19 07:29:58.918575 (Thread-43): handling poll request
2021-04-19 07:29:58.918826 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01957ba040>]}
2021-04-19 07:29:58.920192 (Thread-43): sending response (<Response 14790 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:29:58.938135 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-04-19 07:29:58.941472 (MainThread): Parsing macros/web/get_url_path.sql
2021-04-19 07:29:58.946478 (MainThread): Parsing macros/web/get_url_host.sql
2021-04-19 07:29:58.950456 (MainThread): Parsing macros/datetime/date_spine.sql
2021-04-19 07:29:58.957013 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-04-19 07:29:58.960907 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-04-19 07:29:58.964855 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-04-19 07:29:58.968167 (MainThread): Parsing macros/schema_tests/equality.sql
2021-04-19 07:29:58.974215 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-04-19 07:29:58.977882 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-04-19 07:29:58.981497 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-04-19 07:29:58.985938 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-04-19 07:29:58.994868 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-04-19 07:29:58.999836 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-04-19 07:29:59.004913 (MainThread): Parsing macros/schema_tests/recency.sql
2021-04-19 07:29:59.008465 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-04-19 07:29:59.012658 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-04-19 07:29:59.016006 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-04-19 07:29:59.020157 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-04-19 07:29:59.023211 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-04-19 07:29:59.028674 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-04-19 07:29:59.031326 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-04-19 07:29:59.035568 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-04-19 07:29:59.038935 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-04-19 07:29:59.042549 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-04-19 07:29:59.047048 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-04-19 07:29:59.050117 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-04-19 07:29:59.054497 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-04-19 07:29:59.065889 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-04-19 07:29:59.070054 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-04-19 07:29:59.078817 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-04-19 07:29:59.082387 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-04-19 07:29:59.085382 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-04-19 07:29:59.089201 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-04-19 07:29:59.097045 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-04-19 07:29:59.100560 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-04-19 07:29:59.104285 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-04-19 07:29:59.108569 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-04-19 07:29:59.113281 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-04-19 07:29:59.124161 (MainThread): Partial parsing not enabled
2021-04-19 07:29:59.160963 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:29:59.187339 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:29:59.209178 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:29:59.485887 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e68e75a7-ba4d-4583-bbe6-e6d8323a7026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4b02ad30>]}
2021-04-19 07:29:59.518529 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e68e75a7-ba4d-4583-bbe6-e6d8323a7026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4b2acdc0>]}
2021-04-19 07:29:59.518795 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:29:59.519447 (MainThread): 
2021-04-19 07:29:59.519711 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:29:59.520599 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:29:59.527385 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:29:59.527458 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:29:59.527513 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-19 07:30:00.432081 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.90 seconds
2021-04-19 07:30:00.435513 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:30:00.635591 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:30:00.639010 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:30:00.639108 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:30:00.639172 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:30:01.042773 (Thread-44): handling poll request
2021-04-19 07:30:01.043120 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194d328e0>]}
2021-04-19 07:30:01.044460 (Thread-44): sending response (<Response 17353 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:30:01.267057 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.63 seconds
2021-04-19 07:30:01.267754 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:30:01.462523 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_dev_dw_dw_pres".
2021-04-19 07:30:01.469622 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_dev_dw_dw_pres".
2021-04-19 07:30:01.469720 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_pres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw_dw_pres"} */

    show terse objects in dbt_dev_dw.dw_pres
2021-04-19 07:30:01.469779 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-19 07:30:02.086197 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.62 seconds
2021-04-19 07:30:02.086658 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_pres: Close
2021-04-19 07:30:02.292214 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_dev_dw_dw_dev".
2021-04-19 07:30:02.294401 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_dev_dw_dw_dev".
2021-04-19 07:30:02.294497 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_dev: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw_dw_dev"} */

    show terse objects in dbt_dev_dw.dw_dev
2021-04-19 07:30:02.294555 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-19 07:30:02.478828 (Thread-45): handling poll request
2021-04-19 07:30:02.479111 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c79f40>]}
2021-04-19 07:30:02.479797 (Thread-45): sending response (<Response 4169 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:30:03.214768 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.92 seconds
2021-04-19 07:30:03.215516 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_dev: Close
2021-04-19 07:30:03.407078 (MainThread): Using snowflake connection "master".
2021-04-19 07:30:03.407188 (MainThread): On master: BEGIN
2021-04-19 07:30:03.407268 (MainThread): Opening a new connection, currently in state init
2021-04-19 07:30:03.905415 (Thread-46): handling poll request
2021-04-19 07:30:03.905697 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c79a60>]}
2021-04-19 07:30:03.906271 (Thread-46): sending response (<Response 1652 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:30:04.694786 (MainThread): SQL status: SUCCESS 1 in 1.29 seconds
2021-04-19 07:30:04.694951 (MainThread): On master: COMMIT
2021-04-19 07:30:04.695061 (MainThread): Using snowflake connection "master".
2021-04-19 07:30:04.695108 (MainThread): On master: COMMIT
2021-04-19 07:30:04.903698 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-04-19 07:30:04.903863 (MainThread): On master: Close
2021-04-19 07:30:05.086589 (MainThread): 07:30:05 | Concurrency: 1 threads (target='dev')
2021-04-19 07:30:05.086735 (MainThread): 07:30:05 | 
2021-04-19 07:30:05.088300 (Thread-1): Began running node model.folkefinans_dw.base_loan_account
2021-04-19 07:30:05.088566 (Thread-1): 07:30:05 | 1 of 3 START view model dbt_dev_dw.dw_dev.base_loan_account.......... [RUN]
2021-04-19 07:30:05.088820 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:30:05.088914 (Thread-1): Compiling model.folkefinans_dw.base_loan_account
2021-04-19 07:30:05.096910 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:30:05.097013 (Thread-1): On model.folkefinans_dw.base_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.base_loan_account"} */

    
select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:30:05.097074 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:30:05.294804 (Thread-47): handling poll request
2021-04-19 07:30:05.295021 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c79280>]}
2021-04-19 07:30:05.295715 (Thread-47): sending response (<Response 5638 bytes [200 OK]>) to 10.0.17.36
2021-04-19 07:30:05.729475 (Thread-1): SQL status: SUCCESS 13 in 0.63 seconds
2021-04-19 07:30:05.736351 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.base_loan_account"
2021-04-19 07:30:05.769530 (Thread-1): finished collecting timing info
2021-04-19 07:30:05.792554 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.base_loan_account"
2021-04-19 07:30:05.823843 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:30:05.823922 (Thread-1): On model.folkefinans_dw.base_loan_account: BEGIN
2021-04-19 07:30:05.995902 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-04-19 07:30:05.996014 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:30:05.996062 (Thread-1): On model.folkefinans_dw.base_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.base_loan_account"} */

  create or replace  view dbt_dev_dw.dw_dev.base_loan_account  as (
    

with
src as (
  select
    json:id::string as loan_account_id,
    json:loanName::string as loan_name,
    json:loanAmount::string as loan_amount,
    json:paymentMethod::string as payment_method,
    json:accountHolderKey::string as account_holder_key,
    json:accountHolderType::string as account_holder_type,
    json:accountState::string as account_state,
    json:accountSubState::string as account_sub_state,
    json:creationDate::timestamp as created_ts,
    json:approvedDate::timestamp as approved_ts,
    json:closedDate::timestamp as closed_ts,
    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,
    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,
    json:_application_information_l.application_type_l::string as application_type,
    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,
    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,
    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,
    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,
    json:_application_information_l.ip_address_l::string as ap_ip_address,
    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,
    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,
    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,
    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,
    json:_application_information_l.wealth_l::string as ap_wealth,
    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,
    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,
    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,
    json:_credit_rules_l as json_credit_rules,
    last_modified_at::timestamp as last_modified_ts
  from
    dev_raw.mambu.loan_accounts
),

credit_rules as (
  select
    loan_account_id,
    last_modified_ts,
    rule.value:credit_rule_name_l::string as credit_rule,
    rule.value:credit_rule_decision_l::string as credit_rule_decision,
    rule.value:_index::int as index,
    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index
  from
    src,
    lateral flatten(input => json_credit_rules) rule
),filtered_rules as (
  select
    loan_account_id,
    last_modified_ts,
    credit_rule,
    credit_rule_decision
  from
    credit_rules
  where
    index = max_index
),

pivot_credit_rules as (
  select
    loan_account_id,
    last_modified_ts,
    nvl(cr_affordability, 'N/A') as cr_affordability,
    nvl(cr_arvato_credit, 'N/A') as cr_arvato_credit,
    nvl(cr_arvato_limit_increase, 'N/A') as cr_arvato_limit_increase,
    nvl(cr_bisnode_aml_pep, 'N/A') as cr_bisnode_aml_pep,
    nvl(cr_bisnode_rgs_decision, 'N/A') as cr_bisnode_rgs_decision,
    nvl(cr_blocked_customer, 'N/A') as cr_blocked_customer,
    nvl(cr_credit_assessment, 'N/A') as cr_credit_assessment,
    nvl(cr_credit_check, 'N/A') as cr_credit_check,
    nvl(cr_customer_age, 'N/A') as cr_customer_age,
    nvl(cr_customer_debt, 'N/A') as cr_customer_debt,
    nvl(cr_customer_info_change, 'N/A') as cr_customer_info_change,
    nvl(cr_loan_multi_exposure, 'N/A') as cr_loan_multi_exposure,
    nvl(cr_money_laundering, 'N/A') as cr_money_laundering
    from
      filtered_rules
    pivot (max(credit_rule_decision) for credit_rule in ('Affordability', 'ArvatoCredit', 'ArvatoLimitIncrease', 'BisnodeAmlPep', 'BisnodeRGSDecision', 'BlockedCustomer', 'CreditAssessment', 'CreditCheck', 'CustomerAge', 'CustomerDebt', 'CustomerInfoChange', 'LoanMultiExposure', 'MoneyLaundering'))
    as pv (loan_account_id,
           last_modified_ts,
           cr_affordability,
           cr_arvato_credit,
           cr_arvato_limit_increase,
           cr_bisnode_aml_pep,
           cr_bisnode_rgs_decision,
           cr_blocked_customer,
           cr_credit_assessment,
           cr_credit_check,
           cr_customer_age,
           cr_customer_debt,
           cr_customer_info_change,
           cr_loan_multi_exposure,
           cr_money_laundering
           )
)

select
  src.loan_account_id,
  src.loan_name,
  src.loan_amount,
  src.payment_method,
  src.account_holder_key,
  src.account_holder_type,
  src.account_state,
  src.account_sub_state,
  src.created_ts,
  src.approved_ts,
  src.closed_ts,
  src.disbursement_ts,
  src.first_repayment_ts,
  src.application_type,
  src.previous_application_id,
  src.original_application_id,
  src.ap_data_processing_consent,
  src.initial_application_amount,
  src.ap_ip_address,
  src.ap_monthly_living_cost,
  src.ap_monthly_net_income,
  src.ap_pep_acceptance,
  src.ap_terms_acceptance,
  src.ap_wealth,
  src.arvato_account_id,
  src.bisnode_rgs_pd,
  src.bisnode_rgs_score,
  pv.cr_affordability,
  pv.cr_arvato_credit,
  pv.cr_arvato_limit_increase,
  pv.cr_bisnode_aml_pep,
  pv.cr_bisnode_rgs_decision,
  pv.cr_blocked_customer,
  pv.cr_credit_assessment,
  pv.cr_credit_check,
  pv.cr_customer_age,
  pv.cr_customer_debt,
  pv.cr_customer_info_change,
  pv.cr_loan_multi_exposure,
  pv.cr_money_laundering,
  src.last_modified_ts
from
  src
join pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)
  );
2021-04-19 07:30:06.410135 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-04-19 07:30:06.413255 (Thread-1): On model.folkefinans_dw.base_loan_account: COMMIT
2021-04-19 07:30:06.413410 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:30:06.413459 (Thread-1): On model.folkefinans_dw.base_loan_account: COMMIT
2021-04-19 07:30:06.526220 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-04-19 07:30:06.532130 (Thread-1): finished collecting timing info
2021-04-19 07:30:06.532258 (Thread-1): On model.folkefinans_dw.base_loan_account: Close
2021-04-19 07:30:06.721599 (Thread-48): handling poll request
2021-04-19 07:30:06.721874 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194ce8430>]}
2021-04-19 07:30:06.722583 (Thread-48): sending response (<Response 11890 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:30:06.744837 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68e75a7-ba4d-4583-bbe6-e6d8323a7026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb498d5640>]}
2021-04-19 07:30:06.745196 (Thread-1): 07:30:06 | 1 of 3 OK created view model dbt_dev_dw.dw_dev.base_loan_account..... [SUCCESS 1 in 1.66s]
2021-04-19 07:30:06.745277 (Thread-1): Finished running node model.folkefinans_dw.base_loan_account
2021-04-19 07:30:06.746161 (Thread-1): Began running node model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:30:06.746316 (Thread-1): 07:30:06 | 2 of 3 START view model dbt_dev_dw.dw_dev.stg_current_loan_account... [RUN]
2021-04-19 07:30:06.746523 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:30:06.746592 (Thread-1): Compiling model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:30:06.750887 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.stg_current_loan_account"
2021-04-19 07:30:06.766751 (Thread-1): finished collecting timing info
2021-04-19 07:30:06.768848 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.stg_current_loan_account"
2021-04-19 07:30:06.785279 (Thread-1): Using snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:30:06.785359 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: BEGIN
2021-04-19 07:30:06.785419 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:30:07.476167 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-04-19 07:30:07.476316 (Thread-1): Using snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:30:07.476366 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.stg_current_loan_account"} */

  create or replace  view dbt_dev_dw.dw_dev.stg_current_loan_account  as (
    with
ranked_loan_account as (
  select
    *,
    row_number() over (partition by loan_account_id order by last_modified_ts desc) as rownum
  from
    dbt_dev_dw.dw_dev.base_loan_account
),

current_loan_account as (
  select
    md5(cast(
    
    coalesce(cast(loan_account_id as 
    varchar
), '')

 as 
    varchar
)) as dw_loan_account_key,
    *
  from
    ranked_loan_account
  where
    rownum=1
)
select * from current_loan_account
  );
2021-04-19 07:30:08.197885 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2021-04-19 07:30:08.200696 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: COMMIT
2021-04-19 07:30:08.200845 (Thread-1): Using snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:30:08.200894 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: COMMIT
2021-04-19 07:30:08.414312 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-04-19 07:30:08.414993 (Thread-1): finished collecting timing info
2021-04-19 07:30:08.415100 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: Close
2021-04-19 07:30:08.610994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68e75a7-ba4d-4583-bbe6-e6d8323a7026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4843b040>]}
2021-04-19 07:30:08.611310 (Thread-1): 07:30:08 | 2 of 3 OK created view model dbt_dev_dw.dw_dev.stg_current_loan_account [SUCCESS 1 in 1.86s]
2021-04-19 07:30:08.611392 (Thread-1): Finished running node model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:30:08.612120 (Thread-1): Began running node model.folkefinans_dw.dwd_loan_account
2021-04-19 07:30:08.612257 (Thread-1): 07:30:08 | 3 of 3 START view model dbt_dev_dw.dw_pres.dwd_loan_account.......... [RUN]
2021-04-19 07:30:08.612459 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:30:08.612528 (Thread-1): Compiling model.folkefinans_dw.dwd_loan_account
2021-04-19 07:30:08.624006 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:30:08.624093 (Thread-1): On model.folkefinans_dw.dwd_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.dwd_loan_account"} */

    describe table dbt_dev_dw.dw_dev.stg_current_loan_account
2021-04-19 07:30:08.624150 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:30:08.643139 (Thread-49): handling poll request
2021-04-19 07:30:08.643389 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194cab0d0>]}
2021-04-19 07:30:08.644206 (Thread-49): sending response (<Response 14460 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:30:09.249850 (Thread-1): SQL status: SUCCESS 43 in 0.63 seconds
2021-04-19 07:30:09.253409 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.dwd_loan_account"
2021-04-19 07:30:09.273777 (Thread-1): finished collecting timing info
2021-04-19 07:30:09.276324 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.dwd_loan_account"
2021-04-19 07:30:09.294663 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:30:09.294746 (Thread-1): On model.folkefinans_dw.dwd_loan_account: BEGIN
2021-04-19 07:30:09.444454 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-04-19 07:30:09.444547 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:30:09.444593 (Thread-1): On model.folkefinans_dw.dwd_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.dwd_loan_account"} */

  create or replace  view dbt_dev_dw.dw_pres.dwd_loan_account  as (
    

select
  "DW_LOAN_ACCOUNT_KEY",
  "LOAN_ACCOUNT_ID",
  "LOAN_NAME",
  "LOAN_AMOUNT",
  "PAYMENT_METHOD",
  "ACCOUNT_HOLDER_KEY",
  "ACCOUNT_HOLDER_TYPE",
  "ACCOUNT_STATE",
  "ACCOUNT_SUB_STATE",
  "CREATED_TS",
  "APPROVED_TS",
  "CLOSED_TS",
  "DISBURSEMENT_TS",
  "FIRST_REPAYMENT_TS",
  "APPLICATION_TYPE",
  "PREVIOUS_APPLICATION_ID",
  "ORIGINAL_APPLICATION_ID",
  "AP_DATA_PROCESSING_CONSENT",
  "INITIAL_APPLICATION_AMOUNT",
  "AP_IP_ADDRESS",
  "AP_MONTHLY_LIVING_COST",
  "AP_MONTHLY_NET_INCOME",
  "AP_PEP_ACCEPTANCE",
  "AP_TERMS_ACCEPTANCE",
  "AP_WEALTH",
  "ARVATO_ACCOUNT_ID",
  "BISNODE_RGS_PD",
  "BISNODE_RGS_SCORE",
  "CR_AFFORDABILITY",
  "CR_ARVATO_CREDIT",
  "CR_ARVATO_LIMIT_INCREASE",
  "CR_BISNODE_AML_PEP",
  "CR_BISNODE_RGS_DECISION",
  "CR_BLOCKED_CUSTOMER",
  "CR_CREDIT_ASSESSMENT",
  "CR_CREDIT_CHECK",
  "CR_CUSTOMER_AGE",
  "CR_CUSTOMER_DEBT",
  "CR_CUSTOMER_INFO_CHANGE",
  "CR_LOAN_MULTI_EXPOSURE",
  "CR_MONEY_LAUNDERING",
  "LAST_MODIFIED_TS"
from
  dbt_dev_dw.dw_dev.stg_current_loan_account
  );
2021-04-19 07:30:09.871497 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-04-19 07:30:09.874244 (Thread-1): On model.folkefinans_dw.dwd_loan_account: COMMIT
2021-04-19 07:30:09.874387 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:30:09.874436 (Thread-1): On model.folkefinans_dw.dwd_loan_account: COMMIT
2021-04-19 07:30:09.991794 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-04-19 07:30:09.992905 (Thread-1): finished collecting timing info
2021-04-19 07:30:09.993025 (Thread-1): On model.folkefinans_dw.dwd_loan_account: Close
2021-04-19 07:30:10.080148 (Thread-50): handling poll request
2021-04-19 07:30:10.080483 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194ce8160>]}
2021-04-19 07:30:10.081244 (Thread-50): sending response (<Response 7340 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:30:10.185993 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68e75a7-ba4d-4583-bbe6-e6d8323a7026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb48439310>]}
2021-04-19 07:30:10.186341 (Thread-1): 07:30:10 | 3 of 3 OK created view model dbt_dev_dw.dw_pres.dwd_loan_account..... [SUCCESS 1 in 1.57s]
2021-04-19 07:30:10.186436 (Thread-1): Finished running node model.folkefinans_dw.dwd_loan_account
2021-04-19 07:30:10.187775 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:30:10.187965 (MainThread): Using snowflake connection "master".
2021-04-19 07:30:10.188020 (MainThread): On master: BEGIN
2021-04-19 07:30:10.188076 (MainThread): Opening a new connection, currently in state closed
2021-04-19 07:30:11.141954 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-04-19 07:30:11.142111 (MainThread): On master: COMMIT
2021-04-19 07:30:11.142222 (MainThread): Using snowflake connection "master".
2021-04-19 07:30:11.142270 (MainThread): On master: COMMIT
2021-04-19 07:30:11.331160 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-04-19 07:30:11.331345 (MainThread): On master: Close
2021-04-19 07:30:11.500951 (Thread-51): handling poll request
2021-04-19 07:30:11.501205 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0196066fa0>]}
2021-04-19 07:30:11.501859 (Thread-51): sending response (<Response 4252 bytes [200 OK]>) to 10.0.25.165
2021-04-19 07:30:11.748118 (MainThread): 07:30:11 | 
2021-04-19 07:30:11.748247 (MainThread): 07:30:11 | Finished running 3 view models in 12.23s.
2021-04-19 07:30:11.748306 (MainThread): Connection 'master' was properly closed.
2021-04-19 07:30:11.748349 (MainThread): Connection 'model.folkefinans_dw.dwd_loan_account' was properly closed.
2021-04-19 07:30:11.810981 (MainThread): 
2021-04-19 07:30:11.811106 (MainThread): Completed successfully
2021-04-19 07:30:11.811171 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-04-19 07:30:13.043621 (Thread-52): handling poll request
2021-04-19 07:30:13.043901 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c7faf0>]}
2021-04-19 07:30:13.045248 (Thread-52): sending response (<Response 29931 bytes [200 OK]>) to 10.0.35.53
2021-04-19 07:30:13.622329 (Thread-53): handling status request
2021-04-19 07:30:13.622609 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c7fa90>]}
2021-04-19 07:30:13.623830 (Thread-53): sending response (<Response 24913 bytes [200 OK]>) to 10.0.34.70
2021-04-19 07:32:23.414826 (Thread-54): handling status request
2021-04-19 07:32:23.415090 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c7f6d0>]}
2021-04-19 07:32:23.416271 (Thread-54): sending response (<Response 24913 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:32:23.454799 (Thread-55): handling ps request
2021-04-19 07:32:23.455027 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194cab2b0>]}
2021-04-19 07:32:23.455804 (Thread-55): sending response (<Response 2347 bytes [200 OK]>) to 10.0.42.196
2021-04-19 07:32:23.921161 (Thread-56): handling poll request
2021-04-19 07:32:23.921432 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194d42a30>]}
2021-04-19 07:32:23.924412 (Thread-56): sending response (<Response 108897 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:32:24.462750 (Thread-57): handling status request
2021-04-19 07:32:24.463047 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '51c6de33-aadc-4455-a63e-c2daa6856e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0194c7fa90>]}
2021-04-19 07:32:24.464135 (Thread-57): sending response (<Response 24913 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:32:32.647086 (MainThread): Running with dbt=0.19.1
2021-04-19 07:32:32.998355 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-04-19 07:32:33.005765 (MainThread): Tracking: tracking
2021-04-19 07:32:33.006027 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7f052d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b79348820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b793f9f10>]}
2021-04-19 07:32:33.007119 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-04-19 07:32:33.011794 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-04-19 07:32:33.011965 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-04-19 07:32:33.044403 (Thread-1): Parsing macros/get_custom_database.sql
2021-04-19 07:32:33.051777 (Thread-1): Parsing macros/generate_schema_name.sql
2021-04-19 07:32:33.057272 (Thread-1): Parsing macros/parse_credit_rules.sql
2021-04-19 07:32:33.060249 (Thread-1): Parsing macros/adapters.sql
2021-04-19 07:32:33.088671 (Thread-1): Parsing macros/catalog.sql
2021-04-19 07:32:33.090658 (Thread-1): Parsing macros/materializations/table.sql
2021-04-19 07:32:33.094460 (Thread-1): Parsing macros/materializations/merge.sql
2021-04-19 07:32:33.096407 (Thread-1): Parsing macros/materializations/incremental.sql
2021-04-19 07:32:33.105367 (Thread-1): Parsing macros/materializations/view.sql
2021-04-19 07:32:33.107545 (Thread-1): Parsing macros/core.sql
2021-04-19 07:32:33.111395 (Thread-1): Parsing macros/materializations/helpers.sql
2021-04-19 07:32:33.120231 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-04-19 07:32:33.134523 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:32:33.136348 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:32:33.153923 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:32:33.185231 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:32:33.190287 (Thread-1): Parsing macros/materializations/view/view.sql
2021-04-19 07:32:33.196531 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:32:33.217083 (Thread-1): Parsing macros/materializations/table/table.sql
2021-04-19 07:32:33.223723 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:32:33.225639 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:32:33.231601 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-04-19 07:32:33.233201 (Thread-1): Parsing macros/etc/query.sql
2021-04-19 07:32:33.234298 (Thread-1): Parsing macros/etc/datetime.sql
2021-04-19 07:32:33.243031 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:32:33.244027 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:32:33.245738 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:32:33.247719 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:32:33.249311 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:32:33.252011 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:32:33.253900 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-04-19 07:32:33.255676 (Thread-1): Parsing macros/adapters/common.sql
2021-04-19 07:32:33.316349 (Thread-1): Parsing macros/logger/pretty_time.sql
2021-04-19 07:32:33.323540 (Thread-1): Parsing macros/logger/log_info.sql
2021-04-19 07:32:33.330376 (Thread-1): Parsing macros/logger/pretty_log_format.sql
2021-04-19 07:32:33.336525 (Thread-1): Parsing macros/sql/pivot.sql
2021-04-19 07:32:33.345179 (Thread-1): Parsing macros/sql/star.sql
2021-04-19 07:32:33.354124 (Thread-1): Parsing macros/sql/surrogate_key.sql
2021-04-19 07:32:33.362399 (Thread-1): Parsing macros/sql/get_query_results_as_dict.sql
2021-04-19 07:32:33.369216 (Thread-1): Parsing macros/sql/get_column_values.sql
2021-04-19 07:32:33.378545 (Thread-1): Parsing macros/sql/groupby.sql
2021-04-19 07:32:33.384875 (Thread-1): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-04-19 07:32:33.395847 (Thread-1): Parsing macros/sql/nullcheck_table.sql
2021-04-19 07:32:33.402087 (Thread-1): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-04-19 07:32:33.407972 (Thread-1): Parsing macros/sql/get_relations_by_pattern.sql
2021-04-19 07:32:33.415834 (Thread-1): Parsing macros/sql/get_relations_by_prefix.sql
2021-04-19 07:32:33.423552 (Thread-1): Parsing macros/sql/safe_add.sql
2021-04-19 07:32:33.432625 (Thread-1): Parsing macros/sql/unpivot.sql
2021-04-19 07:32:33.444870 (Thread-1): Parsing macros/sql/generate_series.sql
2021-04-19 07:32:33.454431 (Thread-1): Parsing macros/sql/nullcheck.sql
2021-04-19 07:32:33.461691 (Thread-1): Parsing macros/sql/union.sql
2021-04-19 07:32:33.475975 (Thread-1): Parsing macros/materializations/insert_by_period_materialization.sql
2021-04-19 07:32:33.505727 (Thread-1): Parsing macros/web/get_url_parameter.sql
2021-04-19 07:32:33.512620 (Thread-1): Parsing macros/web/get_url_path.sql
2021-04-19 07:32:33.519855 (Thread-1): Parsing macros/web/get_url_host.sql
2021-04-19 07:32:33.526499 (Thread-1): Parsing macros/datetime/date_spine.sql
2021-04-19 07:32:33.535837 (Thread-1): Parsing macros/schema_tests/expression_is_true.sql
2021-04-19 07:32:33.542685 (Thread-1): Parsing macros/schema_tests/not_constant.sql
2021-04-19 07:32:33.548859 (Thread-1): Parsing macros/schema_tests/at_least_one.sql
2021-04-19 07:32:33.555038 (Thread-1): Parsing macros/schema_tests/equality.sql
2021-04-19 07:32:33.563827 (Thread-1): Parsing macros/schema_tests/test_not_null_where.sql
2021-04-19 07:32:33.571082 (Thread-1): Parsing macros/schema_tests/equal_rowcount.sql
2021-04-19 07:32:33.577112 (Thread-1): Parsing macros/schema_tests/test_unique_where.sql
2021-04-19 07:32:33.584267 (Thread-1): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-04-19 07:32:33.595640 (Thread-1): Parsing macros/schema_tests/relationships_where.sql
2021-04-19 07:32:33.602802 (Thread-1): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-04-19 07:32:33.610665 (Thread-1): Parsing macros/schema_tests/recency.sql
2021-04-19 07:32:33.617740 (Thread-1): Parsing macros/schema_tests/cardinality_equality.sql
2021-04-19 07:32:33.624595 (Thread-1): Parsing macros/geo/haversine_distance.sql
2021-04-19 07:32:33.627417 (Thread-2): handling status request
2021-04-19 07:32:33.627653 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b782ce370>]}
2021-04-19 07:32:33.628276 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:32:33.632719 (Thread-1): Parsing macros/cross_db_utils/split_part.sql
2021-04-19 07:32:33.640204 (Thread-1): Parsing macros/cross_db_utils/length.sql
2021-04-19 07:32:33.647085 (Thread-1): Parsing macros/cross_db_utils/current_timestamp.sql
2021-04-19 07:32:33.656044 (Thread-1): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-04-19 07:32:33.661402 (Thread-1): Parsing macros/cross_db_utils/right.sql
2021-04-19 07:32:33.668923 (Thread-1): Parsing macros/cross_db_utils/hash.sql
2021-04-19 07:32:33.675615 (Thread-1): Parsing macros/cross_db_utils/replace.sql
2021-04-19 07:32:33.682929 (Thread-1): Parsing macros/cross_db_utils/concat.sql
2021-04-19 07:32:33.690408 (Thread-1): Parsing macros/cross_db_utils/_is_relation.sql
2021-04-19 07:32:33.696098 (Thread-1): Parsing macros/cross_db_utils/identifier.sql
2021-04-19 07:32:33.702364 (Thread-1): Parsing macros/cross_db_utils/datediff.sql
2021-04-19 07:32:33.716811 (Thread-1): Parsing macros/cross_db_utils/dateadd.sql
2021-04-19 07:32:33.724069 (Thread-1): Parsing macros/cross_db_utils/datatypes.sql
2021-04-19 07:32:33.735291 (Thread-1): Parsing macros/cross_db_utils/position.sql
2021-04-19 07:32:33.742639 (Thread-1): Parsing macros/cross_db_utils/literal.sql
2021-04-19 07:32:33.748345 (Thread-1): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-04-19 07:32:33.754920 (Thread-1): Parsing macros/cross_db_utils/width_bucket.sql
2021-04-19 07:32:33.765062 (Thread-1): Parsing macros/cross_db_utils/date_trunc.sql
2021-04-19 07:32:33.770833 (Thread-1): Parsing macros/cross_db_utils/except.sql
2021-04-19 07:32:33.777331 (Thread-1): Parsing macros/cross_db_utils/safe_cast.sql
2021-04-19 07:32:33.784198 (Thread-1): Parsing macros/cross_db_utils/last_day.sql
2021-04-19 07:32:33.791742 (Thread-1): Parsing macros/cross_db_utils/intersect.sql
2021-04-19 07:32:33.840921 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:32:33.872120 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:32:33.900905 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:32:34.164737 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b5b0730>]}
2021-04-19 07:32:35.067764 (Thread-3): handling status request
2021-04-19 07:32:35.068065 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b5ecdf0>]}
2021-04-19 07:32:35.069279 (Thread-3): sending response (<Response 26329 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:32:52.557285 (Thread-4): handling status request
2021-04-19 07:32:52.559288 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7808cf70>]}
2021-04-19 07:32:52.560447 (Thread-4): sending response (<Response 26329 bytes [200 OK]>) to 10.0.20.12
2021-04-19 07:32:52.604567 (Thread-5): handling status request
2021-04-19 07:32:52.604766 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7808cac0>]}
2021-04-19 07:32:52.605873 (Thread-5): sending response (<Response 26329 bytes [200 OK]>) to 10.0.10.188
2021-04-19 07:32:53.015303 (Thread-6): handling cli_args request
2021-04-19 07:32:53.015569 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7828e370>]}
2021-04-19 07:32:53.026451 (Thread-6): Connection 'model.folkefinans_dw.base_loan_account' was properly closed.
2021-04-19 07:32:54.908280 (Thread-6): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-04-19 07:32:54.957353 (MainThread): Partial parsing not enabled
2021-04-19 07:32:54.962009 (MainThread): Parsing macros/get_custom_database.sql
2021-04-19 07:32:54.966185 (MainThread): Parsing macros/generate_schema_name.sql
2021-04-19 07:32:54.969169 (MainThread): Parsing macros/parse_credit_rules.sql
2021-04-19 07:32:54.972036 (MainThread): Parsing macros/adapters.sql
2021-04-19 07:32:54.999961 (MainThread): Parsing macros/catalog.sql
2021-04-19 07:32:55.001962 (MainThread): Parsing macros/materializations/table.sql
2021-04-19 07:32:55.005808 (MainThread): Parsing macros/materializations/merge.sql
2021-04-19 07:32:55.007780 (MainThread): Parsing macros/materializations/incremental.sql
2021-04-19 07:32:55.018004 (MainThread): Parsing macros/materializations/view.sql
2021-04-19 07:32:55.020289 (MainThread): Parsing macros/core.sql
2021-04-19 07:32:55.024131 (MainThread): Parsing macros/materializations/helpers.sql
2021-04-19 07:32:55.032810 (MainThread): Parsing macros/materializations/common/merge.sql
2021-04-19 07:32:55.046625 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-04-19 07:32:55.048393 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-04-19 07:32:55.065827 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-04-19 07:32:55.096439 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-04-19 07:32:55.101332 (MainThread): Parsing macros/materializations/view/view.sql
2021-04-19 07:32:55.107396 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-04-19 07:32:55.127573 (MainThread): Parsing macros/materializations/table/table.sql
2021-04-19 07:32:55.134081 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-04-19 07:32:55.135912 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-04-19 07:32:55.141827 (MainThread): Parsing macros/etc/is_incremental.sql
2021-04-19 07:32:55.143541 (MainThread): Parsing macros/etc/query.sql
2021-04-19 07:32:55.144629 (MainThread): Parsing macros/etc/datetime.sql
2021-04-19 07:32:55.153248 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-04-19 07:32:55.154222 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-04-19 07:32:55.155878 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-04-19 07:32:55.157859 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-04-19 07:32:55.159413 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-04-19 07:32:55.162084 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-04-19 07:32:55.163957 (MainThread): Parsing macros/schema_tests/unique.sql
2021-04-19 07:32:55.165737 (MainThread): Parsing macros/adapters/common.sql
2021-04-19 07:32:55.223850 (MainThread): Parsing macros/logger/pretty_time.sql
2021-04-19 07:32:55.227820 (MainThread): Parsing macros/logger/log_info.sql
2021-04-19 07:32:55.231208 (MainThread): Parsing macros/logger/pretty_log_format.sql
2021-04-19 07:32:55.234369 (MainThread): Parsing macros/sql/pivot.sql
2021-04-19 07:32:55.240613 (MainThread): Parsing macros/sql/star.sql
2021-04-19 07:32:55.246410 (MainThread): Parsing macros/sql/surrogate_key.sql
2021-04-19 07:32:55.252670 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2021-04-19 07:32:55.257196 (MainThread): Parsing macros/sql/get_column_values.sql
2021-04-19 07:32:55.264244 (MainThread): Parsing macros/sql/groupby.sql
2021-04-19 07:32:55.267758 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-04-19 07:32:55.276270 (MainThread): Parsing macros/sql/nullcheck_table.sql
2021-04-19 07:32:55.280225 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-04-19 07:32:55.284172 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2021-04-19 07:32:55.290004 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2021-04-19 07:32:55.295820 (MainThread): Parsing macros/sql/safe_add.sql
2021-04-19 07:32:55.299808 (MainThread): Parsing macros/sql/unpivot.sql
2021-04-19 07:32:55.310035 (MainThread): Parsing macros/sql/generate_series.sql
2021-04-19 07:32:55.317035 (MainThread): Parsing macros/sql/nullcheck.sql
2021-04-19 07:32:55.321190 (MainThread): Parsing macros/sql/union.sql
2021-04-19 07:32:55.332104 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2021-04-19 07:32:55.359549 (MainThread): Parsing macros/web/get_url_parameter.sql
2021-04-19 07:32:55.363461 (MainThread): Parsing macros/web/get_url_path.sql
2021-04-19 07:32:55.368520 (MainThread): Parsing macros/web/get_url_host.sql
2021-04-19 07:32:55.373103 (MainThread): Parsing macros/datetime/date_spine.sql
2021-04-19 07:32:55.380328 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2021-04-19 07:32:55.384077 (MainThread): Parsing macros/schema_tests/not_constant.sql
2021-04-19 07:32:55.388346 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2021-04-19 07:32:55.392229 (MainThread): Parsing macros/schema_tests/equality.sql
2021-04-19 07:32:55.398511 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2021-04-19 07:32:55.402458 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2021-04-19 07:32:55.406448 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2021-04-19 07:32:55.411860 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-04-19 07:32:55.420751 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2021-04-19 07:32:55.424638 (Thread-7): handling poll request
2021-04-19 07:32:55.424903 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b5bbe20>]}
2021-04-19 07:32:55.426280 (Thread-7): sending response (<Response 18333 bytes [200 OK]>) to 10.0.27.247
2021-04-19 07:32:55.425764 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-04-19 07:32:55.431695 (MainThread): Parsing macros/schema_tests/recency.sql
2021-04-19 07:32:55.436482 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2021-04-19 07:32:55.441220 (MainThread): Parsing macros/geo/haversine_distance.sql
2021-04-19 07:32:55.445291 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2021-04-19 07:32:55.449489 (MainThread): Parsing macros/cross_db_utils/length.sql
2021-04-19 07:32:55.452852 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2021-04-19 07:32:55.459734 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-04-19 07:32:55.462556 (MainThread): Parsing macros/cross_db_utils/right.sql
2021-04-19 07:32:55.467211 (MainThread): Parsing macros/cross_db_utils/hash.sql
2021-04-19 07:32:55.471271 (MainThread): Parsing macros/cross_db_utils/replace.sql
2021-04-19 07:32:55.476227 (MainThread): Parsing macros/cross_db_utils/concat.sql
2021-04-19 07:32:55.481142 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2021-04-19 07:32:55.484515 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2021-04-19 07:32:55.489124 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2021-04-19 07:32:55.501146 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2021-04-19 07:32:55.506245 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2021-04-19 07:32:55.515417 (MainThread): Parsing macros/cross_db_utils/position.sql
2021-04-19 07:32:55.519428 (MainThread): Parsing macros/cross_db_utils/literal.sql
2021-04-19 07:32:55.522548 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-04-19 07:32:55.527184 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2021-04-19 07:32:55.534780 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2021-04-19 07:32:55.539523 (MainThread): Parsing macros/cross_db_utils/except.sql
2021-04-19 07:32:55.543018 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2021-04-19 07:32:55.547148 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2021-04-19 07:32:55.552185 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2021-04-19 07:32:55.562771 (MainThread): Partial parsing not enabled
2021-04-19 07:32:55.600741 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:32:55.627763 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:32:55.650151 (MainThread): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:32:55.969783 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b82770dc-6eb7-4b75-91c3-ca41cb104b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5f3cacd30>]}
2021-04-19 07:32:56.002551 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b82770dc-6eb7-4b75-91c3-ca41cb104b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5f3f309d0>]}
2021-04-19 07:32:56.002789 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 318 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-04-19 07:32:56.003398 (MainThread): 
2021-04-19 07:32:56.003649 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:32:56.004516 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:32:56.011764 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:32:56.011837 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:32:56.011895 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-19 07:32:56.857383 (Thread-8): handling poll request
2021-04-19 07:32:56.857660 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b594eb0>]}
2021-04-19 07:32:56.858663 (Thread-8): sending response (<Response 11779 bytes [200 OK]>) to 10.0.27.22
2021-04-19 07:32:56.980182 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.97 seconds
2021-04-19 07:32:56.983564 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:32:57.173523 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_dbt_dev_dw".
2021-04-19 07:32:57.176232 (ThreadPoolExecutor-0_0): Using snowflake connection "list_dbt_dev_dw".
2021-04-19 07:32:57.176324 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw"} */

    show terse schemas in database dbt_dev_dw
    limit 10000
2021-04-19 07:32:57.176395 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:32:58.013468 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.84 seconds
2021-04-19 07:32:58.014094 (ThreadPoolExecutor-0_0): On list_dbt_dev_dw: Close
2021-04-19 07:32:58.221400 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_stg".
2021-04-19 07:32:58.221624 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_stg".
2021-04-19 07:32:58.221784 (ThreadPoolExecutor-0_0): Creating schema "dbt_dev_dw.dw_stg"
2021-04-19 07:32:58.226847 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_stg".
2021-04-19 07:32:58.226923 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_stg: BEGIN
2021-04-19 07:32:58.226981 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:32:58.287007 (Thread-9): handling poll request
2021-04-19 07:32:58.287263 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b593040>]}
2021-04-19 07:32:58.287896 (Thread-9): sending response (<Response 4534 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:32:58.972449 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.75 seconds
2021-04-19 07:32:58.972595 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_stg".
2021-04-19 07:32:58.972649 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "create_dbt_dev_dw_dw_stg"} */
create schema if not exists dbt_dev_dw.dw_stg
2021-04-19 07:32:59.222425 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.25 seconds
2021-04-19 07:32:59.225342 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_stg: COMMIT
2021-04-19 07:32:59.225487 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_stg".
2021-04-19 07:32:59.225539 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_stg: COMMIT
2021-04-19 07:32:59.361972 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.14 seconds
2021-04-19 07:32:59.362138 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_stg: Close
2021-04-19 07:32:59.587194 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:32:59.587417 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:32:59.587532 (ThreadPoolExecutor-0_0): Creating schema "dbt_dev_dw.dw_pres"
2021-04-19 07:32:59.590171 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:32:59.590250 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: BEGIN
2021-04-19 07:32:59.590310 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-19 07:32:59.752824 (Thread-10): handling poll request
2021-04-19 07:32:59.753137 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b57d130>]}
2021-04-19 07:32:59.753767 (Thread-10): sending response (<Response 4833 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:33:00.191181 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.60 seconds
2021-04-19 07:33:00.191324 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:33:00.191375 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "create_dbt_dev_dw_dw_pres"} */
create schema if not exists dbt_dev_dw.dw_pres
2021-04-19 07:33:00.447218 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.26 seconds
2021-04-19 07:33:00.449842 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: COMMIT
2021-04-19 07:33:00.449987 (ThreadPoolExecutor-0_0): Using snowflake connection "create_dbt_dev_dw_dw_pres".
2021-04-19 07:33:00.450041 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: COMMIT
2021-04-19 07:33:00.601112 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.15 seconds
2021-04-19 07:33:00.601278 (ThreadPoolExecutor-0_0): On create_dbt_dev_dw_dw_pres: Close
2021-04-19 07:33:00.802583 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_dev_dw_dw_stg".
2021-04-19 07:33:00.809658 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_dev_dw_dw_stg".
2021-04-19 07:33:00.809763 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_stg: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw_dw_stg"} */

    show terse objects in dbt_dev_dw.dw_stg
2021-04-19 07:33:00.809824 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-19 07:33:01.227302 (Thread-11): handling poll request
2021-04-19 07:33:01.227583 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b57d700>]}
2021-04-19 07:33:01.228214 (Thread-11): sending response (<Response 4437 bytes [200 OK]>) to 10.0.32.65
2021-04-19 07:33:01.617859 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.81 seconds
2021-04-19 07:33:01.618311 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_stg: Close
2021-04-19 07:33:01.836971 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_dbt_dev_dw_dw_pres".
2021-04-19 07:33:01.839130 (ThreadPoolExecutor-1_0): Using snowflake connection "list_dbt_dev_dw_dw_pres".
2021-04-19 07:33:01.839232 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_pres: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "connection_name": "list_dbt_dev_dw_dw_pres"} */

    show terse objects in dbt_dev_dw.dw_pres
2021-04-19 07:33:01.839294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-19 07:33:02.529748 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.69 seconds
2021-04-19 07:33:02.530146 (ThreadPoolExecutor-1_0): On list_dbt_dev_dw_dw_pres: Close
2021-04-19 07:33:02.643943 (Thread-12): handling poll request
2021-04-19 07:33:02.644217 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b57dbb0>]}
2021-04-19 07:33:02.644813 (Thread-12): sending response (<Response 2787 bytes [200 OK]>) to 10.0.20.12
2021-04-19 07:33:02.720768 (MainThread): Using snowflake connection "master".
2021-04-19 07:33:02.720904 (MainThread): On master: BEGIN
2021-04-19 07:33:02.720995 (MainThread): Opening a new connection, currently in state init
2021-04-19 07:33:03.354789 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-04-19 07:33:03.354998 (MainThread): On master: COMMIT
2021-04-19 07:33:03.355157 (MainThread): Using snowflake connection "master".
2021-04-19 07:33:03.355232 (MainThread): On master: COMMIT
2021-04-19 07:33:03.546559 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-04-19 07:33:03.546732 (MainThread): On master: Close
2021-04-19 07:33:03.740691 (MainThread): 07:33:03 | Concurrency: 1 threads (target='dev')
2021-04-19 07:33:03.740838 (MainThread): 07:33:03 | 
2021-04-19 07:33:03.742413 (Thread-1): Began running node model.folkefinans_dw.base_loan_account
2021-04-19 07:33:03.742682 (Thread-1): 07:33:03 | 1 of 3 START view model dbt_dev_dw.dw_stg.base_loan_account.......... [RUN]
2021-04-19 07:33:03.742943 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:33:03.743044 (Thread-1): Compiling model.folkefinans_dw.base_loan_account
2021-04-19 07:33:03.750692 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:33:03.750795 (Thread-1): On model.folkefinans_dw.base_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.base_loan_account"} */

    
select distinct
rule.value:credit_rule_name_l::string
from
dev_raw.mambu.loan_accounts,
lateral flatten(input => json:_credit_rules_l) rule
where
rule.value:credit_rule_name_l::string is not null
order by 1
2021-04-19 07:33:03.750860 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:33:04.164231 (Thread-13): handling poll request
2021-04-19 07:33:04.164504 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b56c490>]}
2021-04-19 07:33:04.165193 (Thread-13): sending response (<Response 6426 bytes [200 OK]>) to 10.0.38.206
2021-04-19 07:33:04.506625 (Thread-1): SQL status: SUCCESS 13 in 0.76 seconds
2021-04-19 07:33:04.513757 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.base_loan_account"
2021-04-19 07:33:04.549018 (Thread-1): finished collecting timing info
2021-04-19 07:33:04.573371 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.base_loan_account"
2021-04-19 07:33:04.617188 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:33:04.617332 (Thread-1): On model.folkefinans_dw.base_loan_account: BEGIN
2021-04-19 07:33:04.856738 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-04-19 07:33:04.856964 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:33:04.857074 (Thread-1): On model.folkefinans_dw.base_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.base_loan_account"} */

  create or replace  view dbt_dev_dw.dw_stg.base_loan_account  as (
    

with
src as (
  select
    json:id::string as loan_account_id,
    json:loanName::string as loan_name,
    json:loanAmount::string as loan_amount,
    json:paymentMethod::string as payment_method,
    json:accountHolderKey::string as account_holder_key,
    json:accountHolderType::string as account_holder_type,
    json:accountState::string as account_state,
    json:accountSubState::string as account_sub_state,
    json:creationDate::timestamp as created_ts,
    json:approvedDate::timestamp as approved_ts,
    json:closedDate::timestamp as closed_ts,
    json:disbursementDetails.disbursementDate::timestamp as disbursement_ts,
    json:disbursementDetails.firstRepaymentDate::timestamp as first_repayment_ts,
    json:_application_information_l.application_type_l::string as application_type,
    nvl(json:_application_information_l.previous_application_id_l::string, 'N/A') as previous_application_id,
    nvl(json:_application_information_l.original_application_id_l::string, 'N/A') as original_application_id,
    json:_application_information_l.data_processing_consent_l::boolean as ap_data_processing_consent,
    try_to_number(json:_application_information_l.initial_application_amount_l::string) as initial_application_amount,
    json:_application_information_l.ip_address_l::string as ap_ip_address,
    try_to_number(json:_application_information_l.monthly_living_cost_l::string) as ap_monthly_living_cost,
    try_to_number(json:_application_information_l.monthly_net_income_l::string) as ap_monthly_net_income,
    json:_application_information_l.pep_acceptance_l::boolean as ap_pep_acceptance,
    json:_application_information_l.terms_acceptance_l::boolean as ap_terms_acceptance,
    json:_application_information_l.wealth_l::string as ap_wealth,
    json:_arvato_l.arvato_account_id_l::string as arvato_account_id,
    json:_credit_decision.bisnode_rgs_pd_l::numeric as bisnode_rgs_pd,
    json:_credit_decision.bisnode_rgs_score_l::string as bisnode_rgs_score,
    json:_credit_rules_l as json_credit_rules,
    last_modified_at::timestamp as last_modified_ts
  from
    dev_raw.mambu.loan_accounts
),

credit_rules as (
  select
    loan_account_id,
    last_modified_ts,
    rule.value:credit_rule_name_l::string as credit_rule,
    rule.value:credit_rule_decision_l::string as credit_rule_decision,
    rule.value:_index::int as index,
    max(rule.value:_index::int) over (partition by loan_account_id, last_modified_ts, credit_rule) as max_index
  from
    src,
    lateral flatten(input => json_credit_rules) rule
),filtered_rules as (
  select
    loan_account_id,
    last_modified_ts,
    credit_rule,
    credit_rule_decision
  from
    credit_rules
  where
    index = max_index
),

pivot_credit_rules as (
  select
    loan_account_id,
    last_modified_ts,
    nvl(cr_affordability, 'N/A') as cr_affordability,
    nvl(cr_arvato_credit, 'N/A') as cr_arvato_credit,
    nvl(cr_arvato_limit_increase, 'N/A') as cr_arvato_limit_increase,
    nvl(cr_bisnode_aml_pep, 'N/A') as cr_bisnode_aml_pep,
    nvl(cr_bisnode_rgs_decision, 'N/A') as cr_bisnode_rgs_decision,
    nvl(cr_blocked_customer, 'N/A') as cr_blocked_customer,
    nvl(cr_credit_assessment, 'N/A') as cr_credit_assessment,
    nvl(cr_credit_check, 'N/A') as cr_credit_check,
    nvl(cr_customer_age, 'N/A') as cr_customer_age,
    nvl(cr_customer_debt, 'N/A') as cr_customer_debt,
    nvl(cr_customer_info_change, 'N/A') as cr_customer_info_change,
    nvl(cr_loan_multi_exposure, 'N/A') as cr_loan_multi_exposure,
    nvl(cr_money_laundering, 'N/A') as cr_money_laundering
    from
      filtered_rules
    pivot (max(credit_rule_decision) for credit_rule in ('Affordability', 'ArvatoCredit', 'ArvatoLimitIncrease', 'BisnodeAmlPep', 'BisnodeRGSDecision', 'BlockedCustomer', 'CreditAssessment', 'CreditCheck', 'CustomerAge', 'CustomerDebt', 'CustomerInfoChange', 'LoanMultiExposure', 'MoneyLaundering'))
    as pv (loan_account_id,
           last_modified_ts,
           cr_affordability,
           cr_arvato_credit,
           cr_arvato_limit_increase,
           cr_bisnode_aml_pep,
           cr_bisnode_rgs_decision,
           cr_blocked_customer,
           cr_credit_assessment,
           cr_credit_check,
           cr_customer_age,
           cr_customer_debt,
           cr_customer_info_change,
           cr_loan_multi_exposure,
           cr_money_laundering
           )
)

select
  src.loan_account_id,
  src.loan_name,
  src.loan_amount,
  src.payment_method,
  src.account_holder_key,
  src.account_holder_type,
  src.account_state,
  src.account_sub_state,
  src.created_ts,
  src.approved_ts,
  src.closed_ts,
  src.disbursement_ts,
  src.first_repayment_ts,
  src.application_type,
  src.previous_application_id,
  src.original_application_id,
  src.ap_data_processing_consent,
  src.initial_application_amount,
  src.ap_ip_address,
  src.ap_monthly_living_cost,
  src.ap_monthly_net_income,
  src.ap_pep_acceptance,
  src.ap_terms_acceptance,
  src.ap_wealth,
  src.arvato_account_id,
  src.bisnode_rgs_pd,
  src.bisnode_rgs_score,
  pv.cr_affordability,
  pv.cr_arvato_credit,
  pv.cr_arvato_limit_increase,
  pv.cr_bisnode_aml_pep,
  pv.cr_bisnode_rgs_decision,
  pv.cr_blocked_customer,
  pv.cr_credit_assessment,
  pv.cr_credit_check,
  pv.cr_customer_age,
  pv.cr_customer_debt,
  pv.cr_customer_info_change,
  pv.cr_loan_multi_exposure,
  pv.cr_money_laundering,
  src.last_modified_ts
from
  src
join pivot_credit_rules pv on (pv.loan_account_id=src.loan_account_id and pv.last_modified_ts=src.last_modified_ts)
  );
2021-04-19 07:33:05.364119 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-04-19 07:33:05.368416 (Thread-1): On model.folkefinans_dw.base_loan_account: COMMIT
2021-04-19 07:33:05.368628 (Thread-1): Using snowflake connection "model.folkefinans_dw.base_loan_account".
2021-04-19 07:33:05.368721 (Thread-1): On model.folkefinans_dw.base_loan_account: COMMIT
2021-04-19 07:33:05.528689 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-04-19 07:33:05.538996 (Thread-1): finished collecting timing info
2021-04-19 07:33:05.539327 (Thread-1): On model.folkefinans_dw.base_loan_account: Close
2021-04-19 07:33:05.568053 (Thread-14): handling poll request
2021-04-19 07:33:05.568288 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b56cc40>]}
2021-04-19 07:33:05.568976 (Thread-14): sending response (<Response 11874 bytes [200 OK]>) to 10.0.20.12
2021-04-19 07:33:05.879757 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82770dc-6eb7-4b75-91c3-ca41cb104b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5f2133c40>]}
2021-04-19 07:33:05.880430 (Thread-1): 07:33:05 | 1 of 3 OK created view model dbt_dev_dw.dw_stg.base_loan_account..... [SUCCESS 1 in 2.14s]
2021-04-19 07:33:05.880589 (Thread-1): Finished running node model.folkefinans_dw.base_loan_account
2021-04-19 07:33:05.881410 (Thread-1): Began running node model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:33:05.881622 (Thread-1): 07:33:05 | 2 of 3 START view model dbt_dev_dw.dw_stg.stg_current_loan_account... [RUN]
2021-04-19 07:33:05.881842 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:33:05.881917 (Thread-1): Compiling model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:33:05.886286 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.stg_current_loan_account"
2021-04-19 07:33:05.913628 (Thread-1): finished collecting timing info
2021-04-19 07:33:05.915775 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.stg_current_loan_account"
2021-04-19 07:33:05.939267 (Thread-1): Using snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:33:05.939359 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: BEGIN
2021-04-19 07:33:05.939422 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:33:06.617027 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-04-19 07:33:06.617181 (Thread-1): Using snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:33:06.617235 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.stg_current_loan_account"} */

  create or replace  view dbt_dev_dw.dw_stg.stg_current_loan_account  as (
    with
ranked_loan_account as (
  select
    *,
    row_number() over (partition by loan_account_id order by last_modified_ts desc) as rownum
  from
    dbt_dev_dw.dw_stg.base_loan_account
),

current_loan_account as (
  select
    md5(cast(
    
    coalesce(cast(loan_account_id as 
    varchar
), '')

 as 
    varchar
)) as dw_loan_account_key,
    *
  from
    ranked_loan_account
  where
    rownum=1
)
select * from current_loan_account
  );
2021-04-19 07:33:07.105825 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-04-19 07:33:07.109628 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: COMMIT
2021-04-19 07:33:07.109835 (Thread-1): Using snowflake connection "model.folkefinans_dw.stg_current_loan_account".
2021-04-19 07:33:07.109907 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: COMMIT
2021-04-19 07:33:07.225696 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-04-19 07:33:07.226720 (Thread-1): finished collecting timing info
2021-04-19 07:33:07.226873 (Thread-1): On model.folkefinans_dw.stg_current_loan_account: Close
2021-04-19 07:33:07.475986 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82770dc-6eb7-4b75-91c3-ca41cb104b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5f8119df0>]}
2021-04-19 07:33:07.476431 (Thread-1): 07:33:07 | 2 of 3 OK created view model dbt_dev_dw.dw_stg.stg_current_loan_account [SUCCESS 1 in 1.59s]
2021-04-19 07:33:07.476538 (Thread-1): Finished running node model.folkefinans_dw.stg_current_loan_account
2021-04-19 07:33:07.477432 (Thread-1): Began running node model.folkefinans_dw.dwd_loan_account
2021-04-19 07:33:07.477641 (Thread-1): 07:33:07 | 3 of 3 START view model dbt_dev_dw.dw_pres.dwd_loan_account.......... [RUN]
2021-04-19 07:33:07.477917 (Thread-1): Acquiring new snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:33:07.478014 (Thread-1): Compiling model.folkefinans_dw.dwd_loan_account
2021-04-19 07:33:07.494783 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:33:07.494910 (Thread-1): On model.folkefinans_dw.dwd_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.dwd_loan_account"} */

    describe table dbt_dev_dw.dw_stg.stg_current_loan_account
2021-04-19 07:33:07.494994 (Thread-1): Opening a new connection, currently in state closed
2021-04-19 07:33:07.570906 (Thread-15): handling poll request
2021-04-19 07:33:07.571157 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b555ac0>]}
2021-04-19 07:33:07.571987 (Thread-15): sending response (<Response 14426 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:33:08.600399 (Thread-1): SQL status: SUCCESS 43 in 1.11 seconds
2021-04-19 07:33:08.604217 (Thread-1): Writing injected SQL for node "model.folkefinans_dw.dwd_loan_account"
2021-04-19 07:33:08.622724 (Thread-1): finished collecting timing info
2021-04-19 07:33:08.690840 (Thread-1): Writing runtime SQL for node "model.folkefinans_dw.dwd_loan_account"
2021-04-19 07:33:08.712579 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:33:08.712683 (Thread-1): On model.folkefinans_dw.dwd_loan_account: BEGIN
2021-04-19 07:33:08.851154 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-04-19 07:33:08.851298 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:33:08.851348 (Thread-1): On model.folkefinans_dw.dwd_loan_account: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "dev", "node_id": "model.folkefinans_dw.dwd_loan_account"} */

  create or replace  view dbt_dev_dw.dw_pres.dwd_loan_account  as (
    

select
  "DW_LOAN_ACCOUNT_KEY",
  "LOAN_ACCOUNT_ID",
  "LOAN_NAME",
  "LOAN_AMOUNT",
  "PAYMENT_METHOD",
  "ACCOUNT_HOLDER_KEY",
  "ACCOUNT_HOLDER_TYPE",
  "ACCOUNT_STATE",
  "ACCOUNT_SUB_STATE",
  "CREATED_TS",
  "APPROVED_TS",
  "CLOSED_TS",
  "DISBURSEMENT_TS",
  "FIRST_REPAYMENT_TS",
  "APPLICATION_TYPE",
  "PREVIOUS_APPLICATION_ID",
  "ORIGINAL_APPLICATION_ID",
  "AP_DATA_PROCESSING_CONSENT",
  "INITIAL_APPLICATION_AMOUNT",
  "AP_IP_ADDRESS",
  "AP_MONTHLY_LIVING_COST",
  "AP_MONTHLY_NET_INCOME",
  "AP_PEP_ACCEPTANCE",
  "AP_TERMS_ACCEPTANCE",
  "AP_WEALTH",
  "ARVATO_ACCOUNT_ID",
  "BISNODE_RGS_PD",
  "BISNODE_RGS_SCORE",
  "CR_AFFORDABILITY",
  "CR_ARVATO_CREDIT",
  "CR_ARVATO_LIMIT_INCREASE",
  "CR_BISNODE_AML_PEP",
  "CR_BISNODE_RGS_DECISION",
  "CR_BLOCKED_CUSTOMER",
  "CR_CREDIT_ASSESSMENT",
  "CR_CREDIT_CHECK",
  "CR_CUSTOMER_AGE",
  "CR_CUSTOMER_DEBT",
  "CR_CUSTOMER_INFO_CHANGE",
  "CR_LOAN_MULTI_EXPOSURE",
  "CR_MONEY_LAUNDERING",
  "LAST_MODIFIED_TS"
from
  dbt_dev_dw.dw_stg.stg_current_loan_account
  );
2021-04-19 07:33:09.059672 (Thread-16): handling poll request
2021-04-19 07:33:09.059986 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b555b80>]}
2021-04-19 07:33:09.060588 (Thread-16): sending response (<Response 4872 bytes [200 OK]>) to 10.0.27.22
2021-04-19 07:33:09.288696 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-04-19 07:33:09.291492 (Thread-1): On model.folkefinans_dw.dwd_loan_account: COMMIT
2021-04-19 07:33:09.291639 (Thread-1): Using snowflake connection "model.folkefinans_dw.dwd_loan_account".
2021-04-19 07:33:09.291689 (Thread-1): On model.folkefinans_dw.dwd_loan_account: COMMIT
2021-04-19 07:33:09.403383 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-04-19 07:33:09.404167 (Thread-1): finished collecting timing info
2021-04-19 07:33:09.404287 (Thread-1): On model.folkefinans_dw.dwd_loan_account: Close
2021-04-19 07:33:09.604762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82770dc-6eb7-4b75-91c3-ca41cb104b52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5f08bd4f0>]}
2021-04-19 07:33:09.605159 (Thread-1): 07:33:09 | 3 of 3 OK created view model dbt_dev_dw.dw_pres.dwd_loan_account..... [SUCCESS 1 in 2.13s]
2021-04-19 07:33:09.605256 (Thread-1): Finished running node model.folkefinans_dw.dwd_loan_account
2021-04-19 07:33:09.606666 (MainThread): Acquiring new snowflake connection "master".
2021-04-19 07:33:09.606845 (MainThread): Using snowflake connection "master".
2021-04-19 07:33:09.606898 (MainThread): On master: BEGIN
2021-04-19 07:33:09.606954 (MainThread): Opening a new connection, currently in state closed
2021-04-19 07:33:10.251141 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2021-04-19 07:33:10.251298 (MainThread): On master: COMMIT
2021-04-19 07:33:10.251407 (MainThread): Using snowflake connection "master".
2021-04-19 07:33:10.251456 (MainThread): On master: COMMIT
2021-04-19 07:33:10.444992 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-04-19 07:33:10.445156 (MainThread): On master: Close
2021-04-19 07:33:10.558487 (Thread-17): handling poll request
2021-04-19 07:33:10.558752 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b54b940>]}
2021-04-19 07:33:10.559435 (Thread-17): sending response (<Response 6691 bytes [200 OK]>) to 10.0.13.86
2021-04-19 07:33:10.625553 (MainThread): 07:33:10 | 
2021-04-19 07:33:10.625684 (MainThread): 07:33:10 | Finished running 3 view models in 14.62s.
2021-04-19 07:33:10.625742 (MainThread): Connection 'master' was properly closed.
2021-04-19 07:33:10.625786 (MainThread): Connection 'model.folkefinans_dw.dwd_loan_account' was properly closed.
2021-04-19 07:33:10.689420 (MainThread): 
2021-04-19 07:33:10.689569 (MainThread): Completed successfully
2021-04-19 07:33:10.689638 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-04-19 07:33:12.223513 (Thread-18): handling poll request
2021-04-19 07:33:12.223774 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b4cc370>]}
2021-04-19 07:33:12.225212 (Thread-18): sending response (<Response 29925 bytes [200 OK]>) to 10.0.17.36
2021-04-19 07:33:12.662305 (Thread-19): handling status request
2021-04-19 07:33:12.662570 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b4cc3a0>]}
2021-04-19 07:33:12.663911 (Thread-19): sending response (<Response 26329 bytes [200 OK]>) to 10.0.21.125
2021-04-19 07:34:27.019504 (Thread-20): handling status request
2021-04-19 07:34:27.021167 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '76970cd4-46cc-442a-ab30-97479f0ad8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b6b54bd00>]}
2021-04-19 07:34:27.022320 (Thread-20): sending response (<Response 26329 bytes [200 OK]>) to 10.0.27.22
